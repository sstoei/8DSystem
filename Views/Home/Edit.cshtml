@model ReportHeader
@{
    ViewData["Title"] = "Home Page";
    Layout = "~/Views/Shared/_Layout3.cshtml";

    var verifyRef = ViewBag.VerifyRef as VerifyReference;
    var creator = ViewBag.creator as EmpInfo;
    var userId = User.Identity.Name.Split('\\').Last();

}

<div class="row m-2">
    <div class="col-sm-6">
        <h1>8D Report - Edit</h1>
    </div>
    <div class="col-sm-2">
        <div class="form-group">
            <span class="text-bold">Date Opened</span>
            <input type="date" class="form-control form-control-sm" id="HeaderDateOpened" name="HeaderDateOpened" value="@(Model.DateOpened == null ? null : Convert.ToDateTime(Model.DateOpened).ToString("yyyy-MM-dd"))" required />
        </div>

    </div>
    <div class="col-sm-2">
        <div class="form-group">
            <span class="text-bold">Targeted Closure</span>
            <input type="date" class="form-control form-control-sm" id="HeaderDateTargetedClosure" name="HeaderDateTargetedClosure" value="@(Model.DateTargetedClosure == null ? null : Convert.ToDateTime(Model.DateTargetedClosure).ToString("yyyy-MM-dd"))" required />
        </div>
    </div>
    <div class="col-sm-2">
        <div class="form-group">
            <span class="text-bold">Date Closed</span>
            <input type="date" class="form-control form-control-sm" id="HeaderDateClosed" name="HeaderDateClosed" value="@(Model.DateClosed == null ? null : Convert.ToDateTime(Model.DateClosed).ToString("yyyy-MM-dd"))" required />
        </div>
    </div>

</div>
<div class="row mb-1">
    <div class="col-sm-3">
        <div class="position-relative p-2 bg-gray" style="height: 180px">
            <div class="ribbon-wrapper ribbon-xl">
                <div class="ribbon bg-primary">
                    Progress Tracker
                </div>
            </div>
            <div>
                <strong>Report No:</strong> @Model.Code<br />
                <strong>Created Date:</strong> @Convert.ToDateTime(Model.DateCreate).ToString("dd/MM/yyyy")<br />
                <strong>Created By:</strong> @Model.CreateByName.Split(' ')[0] @Model.CreateByName.Split(' ')[1].Substring(0, 1).<br />
            </div>

            <div class="form-group">
                <strong>NCR No:</strong>

                <input class="form-control form-control-sm col-sm-6" id="NcrNo" name="NcrNo" value="@Model.NcrNo" required />
            </div>

        </div>
    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px;text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    0
                </div>
            </div>

            <img src="~/dist/img/D1.jpg" class="img-fluid" style="height:55px;width:55px;" />
            <small>Implement Immediate containment and prep.</small>
        </div>
    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px; text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    1
                </div>
            </div>
            <img src="~/dist/img/D2.jpg" class="img-fluid" style="height:55px;width:55px;" /><br />
            <small>Form the team</small>
        </div>

    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px; text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    2
                </div>
            </div>
            <img src="~/dist/img/D3.jpg" class="img-fluid" style="height:55px;width:55px;" />
            <small>Define the Problem</small>
        </div>
    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px; text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    3
                </div>
            </div>
            <img src="~/dist/img/D4.jpg" class="img-fluid" style="height:55px;width:55px;" />
            <small>Develop Containment Actions</small>
        </div>
    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px; text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    4
                </div>
            </div>
            <img src="~/dist/img/D5.jpg" class="img-fluid" style="height:55px;width:55px;" />

            <small>Identify and verify Root Cause</small>
        </div>
    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px; text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    5
                </div>
            </div>
            <img src="~/dist/img/D6.jpg" class="img-fluid" style="height:55px;width:55px;" />

            <small>Identify Corrective Action</small>
        </div>
    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px; text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    6
                </div>
            </div>
            <img src="~/dist/img/D7.jpg" class="img-fluid" style="height:55px;width:55px;" />

            <small>Implement Corrective Action</small>
        </div>
    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px; text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    7
                </div>
            </div>
            <img src="~/dist/img/D8.jpg" class="img-fluid" style="height:55px;width:55px;" />
            <small>Define and plan Preventive action</small>

        </div>
    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px; text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    8
                </div>
            </div>
            <img src="~/dist/img/D9.jpg" class="img-fluid" style="height:55px;width:55px;" />
            <small>Recognise the team</small>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-sm-3">
        <p class="text-right text-bold">Closure Date</p>
    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD0" name="DateClosureD0" required value="@(Model.DateClosureD0 == null ? null : Convert.ToDateTime(Model.DateClosureD0).ToString("yyyy-MM-dd"))" />

    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD1" name="DateClosureD1" required value="@(Model.DateClosureD1 == null ? null : Convert.ToDateTime(Model.DateClosureD1).ToString("yyyy-MM-dd"))" />

    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD2" name="DateClosureD2" required value="@(Model.DateClosureD2 == null ? null : Convert.ToDateTime(Model.DateClosureD2).ToString("yyyy-MM-dd"))" />

    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD3" name="DateClosureD3" required value="@(Model.DateClosureD3 == null ? null : Convert.ToDateTime(Model.DateClosureD3).ToString("yyyy-MM-dd"))" />

    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD4" name="DateClosureD4" required value="@(Model.DateClosureD4 == null ? null : Convert.ToDateTime(Model.DateClosureD4).ToString("yyyy-MM-dd"))" />

    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD5" name="DateClosureD5" required value="@(Model.DateClosureD5 == null ? null : Convert.ToDateTime(Model.DateClosureD5).ToString("yyyy-MM-dd"))" />

    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD6" name="DateClosureD6" required value="@(Model.DateClosureD6 == null ? null : Convert.ToDateTime(Model.DateClosureD6).ToString("yyyy-MM-dd"))" />

    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD7" name="DateClosureD7" required value="@(Model.DateClosureD7 == null ? null : Convert.ToDateTime(Model.DateClosureD7).ToString("yyyy-MM-dd"))" />

    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD8" name="DateClosureD8" required value="@(Model.DateClosureD8 == null ? null : Convert.ToDateTime(Model.DateClosureD8).ToString("yyyy-MM-dd"))" />
    </div>
</div>
<div class="row">
    <div class="col-sm-3">
        <p class="text-right text-bold">Effectiveness check Date</p>
    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateEffectivenessCheck" name="DateEffectivenessCheck" required value="@(Model.DateEffectivenessCheck == null ? null : Convert.ToDateTime(Model.DateEffectivenessCheck).ToString("yyyy-MM-dd"))" />

    </div>

</div>
@* D0 *@
<div class="row">
    <div class="col-12">
        <!-- Default box -->
        <div class="card">
            <div class="card-header">

                <h3 class="card-title mr-1 text-bold" style="align-self:center;">D0: </h3><h3 class="card-title">Implement Immediate Containment and Prepare for 8D</h3>
                <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            </div>
            @{if (Model.D0s != null)
                {
                    foreach (var item in Model.D0s)
                    {
                        <div class="card-body">
                            <div class="row">
                                <div class="form-group col-md-12">
                                    <span>Implement Immediate Containment and Prepare for 8D</span>
                                    <textarea class="form-control form-control-sm col-md-6" id="D0_Comment" name="D0_Comment" required placeholder="Enter Comment">@item.D0_Comment</textarea>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4 form-group">
                                    <span>Part number</span>
                                    <input class="form-control form-control-sm" id="D0_PartNumber" name="D0_PartNumber" required placeholder="Part number" value="@item.D0_PartNumber" />
                                </div>
                                <div class="col-md-4 form-group">
                                    <span>PO number</span>
                                    <input class="form-control form-control-sm" id="D0_PONum" name="D0_PONum" required placeholder="PO number" value="@item.D0_PONum" />
                                </div>
                                <div class="col-md-4 form-group">
                                    <span>Customer contact</span>
                                    <input class="form-control form-control-sm" id="D0_CustomerContact" name="D0_CustomerContact" required placeholder="Name" value="@item.D0_CustomerContact" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4 form-group">
                                    <span>Part Description</span>
                                    <textarea class="form-control form-control-sm" id="D0_PartDescription" name="D0_PartDescription" required placeholder="Description">@item.D0_PartDescription</textarea>

                                </div>
                                <div class="col-md-4 form-group">
                                    <span>PO item</span>
                                    <input class="form-control form-control-sm" id="D0_POItem" name="D0_POItem" required placeholder="PO item" value="@item.D0_POItem" />
                                </div>
                                <div class="col-md-4 form-group">
                                    <span>Witnessed by</span>
                                    <input class="form-control form-control-sm" id="D0_WitnessedBy" name="D0_WitnessedBy" required placeholder="Name" value="@item.D0_WitnessedBy" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <span>Affected customer product</span>
                                    <input class="form-control form-control-sm" id="D0_AffectedCustomerProduct" name="D0_AffectedCustomerProduct" required placeholder="Product" value="@item.D0_AffectedCustomerProduct" />
                                </div>
                                <div class="col-md-6 form-group">
                                    <span>Customer reference</span>
                                    <input class="form-control form-control-sm" id="D0_CustomerReference" name="D0_CustomerReference" required placeholder="Customer reference" value="@item.D0_CustomerReference" />
                                </div>
                            </div>
                            <hr />
                            <strong>Containment Checklist</strong>
                            <div class="row">
                                <div class="col-sm-2">
                                    <span>Delivery affected?</span>
                                </div>
                                <div class="col-sm-6">
                                    <!-- radio -->
                                    <div class="form-group clearfix DeliveryAffectedVerifyTaskGroup">
                                        <div class="icheck-danger d-inline">
                                            <input type="radio" id="D0_DeliveryAffected_1" class="D0_DeliveryAffectedCheck" required value="false" name="D0_DeliveryAffected_1" @(item.D0_DeliveryAffected == false ? "checked" : "" )>
                                            <label for="D0_DeliveryAffected_1">
                                                No
                                            </label>
                                        </div>
                                        <div class="icheck-success d-inline">
                                            <input type="radio" id="D0_DeliveryAffected_2" class="D0_DeliveryAffectedCheck" required value="true" name="D0_DeliveryAffected_1" @(item.D0_DeliveryAffected == true ? "checked" : "" )>
                                            <label for="D0_DeliveryAffected_2">
                                                Yes
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-2">
                                    <span>Suspect root cause identified?</span>
                                </div>
                                <div class="col-sm-6">
                                    <!-- radio -->
                                    <div class="form-group clearfix SuspectRootCauseIdentifiedVerifyTaskGroup">
                                        <div class="icheck-danger d-inline">
                                            <input type="radio" id="D0_SuspectRootCauseIdentified_No" class="D0_SuspectRootCauseIdentifiedCheck" value="false" name="D0_SuspectRootCauseIdentified_1" @(item.D0_SuspectRootCauseIdentified == false ? "checked" : "" ) required>
                                            <label for="D0_SuspectRootCauseIdentified_No">
                                                No
                                            </label>
                                        </div>
                                        <div class="icheck-success d-inline">
                                            <input type="radio" id="D0_SuspectRootCauseIdentified_Yes" class="D0_SuspectRootCauseIdentifiedCheck" value="true" name="D0_SuspectRootCauseIdentified_1" @(item.D0_SuspectRootCauseIdentified == true ? "checked" : "" ) required>
                                            <label for="D0_SuspectRootCauseIdentified_Yes">
                                                Yes
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-2">
                                    <span>Root cause verified?</span>

                                </div>
                                <div class="col-sm-6">
                                    <!-- radio -->
                                    <div class="form-group clearfix RootCauseVerifiedVerifyTaskGroup">
                                        <div class="icheck-danger d-inline">
                                            <input type="radio" id="D0_RootCauseVerified_No" class="D0_RootCauseVerifiedCheck" value="false" name="D0_RootCauseVerified_1" required @(item.D0_RootCauseVerified == false ? "checked" : "" )>
                                            <label for="D0_RootCauseVerified_No">
                                                No
                                            </label>
                                        </div>
                                        <div class="icheck-success d-inline">
                                            <input type="radio" id="D0_RootCauseVerified_Yes" class="D0_RootCauseVerifiedCheck" value="true" name="D0_RootCauseVerified_1" required @(item.D0_RootCauseVerified == true ? "checked" : "" )>
                                            <label for="D0_RootCauseVerified_Yes">
                                                Yes
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-2">
                                    <span>Emergency respond action?</span>

                                </div>
                                <div class="col-sm-6">
                                    <!-- radio -->
                                    <div class="form-group clearfix EmergencyRespondActionVerifyTaskGroup">
                                        <div class="icheck-danger d-inline">
                                            <input type="radio" id="D0_EmergencyRespondAction_No" class="D0_EmergencyRespondActionCheck" value="false" name="D0_EmergencyRespondAction_1" required @(item.D0_EmergencyRespondAction == false ? "checked" : "" )>
                                            <label for="D0_EmergencyRespondAction_No">
                                                No
                                            </label>
                                        </div>
                                        <div class="icheck-success d-inline">
                                            <input type="radio" id="D0_EmergencyRespondAction_Yes" class="D0_EmergencyRespondActionCheck" value="true" name="D0_EmergencyRespondAction_1" required @(item.D0_EmergencyRespondAction == true ? "checked" : "" )>
                                            <label for="D0_EmergencyRespondAction_Yes">
                                                Yes
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-2">
                                    <span>Recurring problem?</span>

                                </div>
                                <div class="col-sm-6">
                                    <!-- radio -->
                                    <div class="form-group clearfix RecurringProblemVerifyTaskGroup">
                                        <div class="icheck-danger d-inline">
                                            <input type="radio" id="D0_RecurringProblem_No" class="D0_RecurringProblemCheck" value="false" name="D0_RecurringProblem_1" required @(item.D0_RecurringProblem == false ? "checked" : "" )>
                                            <label for="D0_RecurringProblem_No">
                                                No
                                            </label>
                                        </div>
                                        <div class="icheck-success d-inline">
                                            <input type="radio" id="D0_RecurringProblem_Yes" class="D0_RecurringProblemCheck" value="true" name="D0_RecurringProblem_1" required @(item.D0_RecurringProblem == true ? "checked" : "" )>
                                            <label for="D0_RecurringProblem_Yes">
                                                Yes
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @{
                                <strong>Emergency Respond Action </strong>
                                <table class="table table-sm table-striped table-valign-middle table-bordered">
                                    <thead>
                                        <tr>
                                            <th>Action</th>
                                            <th>Team member</th>
                                            <th>Date Start</th>
                                            <th>Metric</th>
                                            <th>% Eff.</th>
                                            <th>Part ID</th>
                                            <th>Date Finish</th>
                                            <th>Add/Edit</th>
                                        </tr>
                                    </thead>
                                    <tbody id="actionTaskBody">
                                        @if (item.D0_EmergencyRespondActions.Count != 0)
                                        {
                                            var rowD0 = 1;
                                            @foreach (var item2 in item.D0_EmergencyRespondActions)
                                            {
                                                <tr class="actionTask" id="actionTask_@rowD0" data-id="@rowD0">
                                                    <td class="form-group" style="width:300px;">
                                                        <textarea class="form-control form-control-sm" id="D0_Action_@rowD0" name="D0_Action_@rowD0" rows="1" required>@item2.Action</textarea>
                                                    </td>
                                                    <td class="form-group" style="width:300px;">

                                                        <select class="form-control form-control-sm select2" id="D0_TeamMember_@rowD0" name="D0_TeamMember_@rowD0" required style="width: 100%;" data-id="@rowD0">
                                                            <option value="" selected disabled>-- select --</option>
                                                            @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                            {
                                                                if (item2.TeamMemberId == e.EmpId)
                                                                {
                                                                    <option value="@e.EmpId"
                                                                            data-domainid="@e.EmpDomainId"
                                                                            data-name="@e.EmpFullnameEN"
                                                                            data-email="@e.EmpEmail"
                                                                            data-position="@e.EmpPositionName"
                                                                            data-section="@e.EmpSectionName"
                                                                            data-department="@e.EmpDepartmentName" selected>
                                                                        @e.EmpFullnameEN
                                                                    </option>
                                                                }
                                                                else
                                                                {
                                                                    <option value="@e.EmpId"
                                                                            data-domainid="@e.EmpDomainId"
                                                                            data-name="@e.EmpFullnameEN"
                                                                            data-email="@e.EmpEmail"
                                                                            data-position="@e.EmpPositionName"
                                                                            data-section="@e.EmpSectionName"
                                                                            data-department="@e.EmpDepartmentName">
                                                                        @e.EmpFullnameEN
                                                                    </option>

                                                                }

                                                            }

                                                        </select>
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D0_DateStart_@rowD0" name="D0_DateStart_@rowD0" required value="@(item2.DateStart == null ? null : Convert.ToDateTime(item2.DateStart).ToString("yyyy-MM-dd"))" />


                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D0_Metric_@rowD0" name="D0_Metric_@rowD0" required value="@item2.Metric" />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D0_Eff_@rowD0" name="D0_Eff_@rowD0" required value="@item2.Eff" />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="text" class="form-control form-control-sm" id="D0_PartId_@rowD0" name="D0_PartId_@rowD0" required value="@item2.PartId" />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D0_DateFinish_@rowD0" name="D0_DateFinish_@rowD0" required value="@(item2.DateFinish == null ? null : Convert.ToDateTime(item2.DateFinish).ToString("yyyy-MM-dd"))" />
                                                    </td>
                                                    <td class="text-center">
                                                        @if (rowD0 == 1)
                                                        {
                                                            <a href="javascript:void(0)" id="addAction">
                                                                <i class="fas fa-plus text-success"></i>
                                                            </a>
                                                        }
                                                        else
                                                        {
                                                            <a href="javascript:void(0)" class="removeAction" data-id="@rowD0">
                                                                <i class="fas fa-minus text-danger"></i>
                                                            </a>

                                                        }
                                                    </td>
                                                </tr>
                                                rowD0++;
                                            }
                                        }
                                        else
                                        {
                                            <tr class="actionTask" id="actionTask_1" data-id="1">
                                                <td class="form-group" style="width:300px;">
                                                    <textarea class="form-control form-control-sm" id="D0_Action_1" name="D0_Action_1" rows="1" required></textarea>
                                                </td>
                                                <td class="form-group" style="width:300px;">

                                                    <select class="form-control form-control-sm select2" id="D0_TeamMember_1" name="D0_TeamMember_1" required style="width: 100%;" data-id="1">
                                                        <option value="" selected disabled>-- select --</option>
                                                        @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                        {
                                                            <option value="@e.EmpId"
                                                                    data-domainid="@e.EmpDomainId"
                                                                    data-name="@e.EmpFullnameEN"
                                                                    data-email="@e.EmpEmail"
                                                                    data-position="@e.EmpPositionName"
                                                                    data-section="@e.EmpSectionName"
                                                                    data-department="@e.EmpDepartmentName">
                                                                @e.EmpFullnameEN
                                                            </option>
                                                        }

                                                    </select>
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm inputdate" id="D0_DateStart_1" name="D0_DateStart_1" required />

                                                </td>
                                                <td class="form-group">
                                                    <input type="number" class="form-control form-control-sm" id="D0_Metric_1" name="D0_Metric_1" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="number" class="form-control form-control-sm" id="D0_Eff_1" name="D0_Eff_1" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="text" class="form-control form-control-sm" id="D0_PartId_1" name="D0_PartId_1" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm inputdate" id="D0_DateFinish_1" name="D0_DateFinish_1" required />

                                                </td>
                                                <td class="text-center">
                                                    <a href="javascript:void(0)" id="addAction">
                                                        <i class="fas fa-plus text-success"></i>
                                                    </a>
                                                </td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            }

                            <div class="row">
                                <div class="form-group">
                                    <p>Attatchments</p>
                                    <input type="file" id="D0_Attachments" name="d0_attachments" multiple />



                                </div>

                            </div>
                            @{var ff = 1;
                                foreach (var file in item.D0_Attachments)
                                {
                                    <div class="row">
                                        <a asp-controller="Home" asp-action="ViewfileD0" asp-route-reportId='@item.ReportHeaderId' asp-route-fileid='@file.Id'>@(ff++). @file.ContentName</a>
                                        <a asp-controller="Home" asp-action="DeleteFileD0" asp-route-reportId='@item.ReportHeaderId' asp-route-fileid='@file.Id' style="padding-left:10px;color:red;" class="@(User.IsInRole("Admin")?"":"d-none")"><i class="fa fa-trash-alt"></i>Delete</a>
                                    </div>}
                            }
                        </div>
                    }
                }

            }
        </div>
        <!-- /.card -->
    </div>
</div>
@* D1 *@
<div class="row">
    <div class="col-12">
        <!-- Default box -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title mr-1 text-bold" style="align-self:center;">D1: </h3><h3 class="card-title">Emergency Respond Action</h3>


                <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            </div>
            <div class="card-body">

                <div class="row">
                    @{
                        <table class="table table-sm table-striped table-valign-middle table-bordered">
                            <thead>
                                <tr>
                                    <th>Function</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Date Start</th>
                                    <th>Phone No</th>
                                    <th>Add/Edit</th>
                                </tr>
                            </thead>
                            <tbody id="actionTaskBody_D1">
                                @if (Model.D1s.Count != 0)
                                {
                                    var rowD1 = 1;
                                    foreach (var itemD1 in Model.D1s)
                                    {
                                        <tr class="actionTask_D1" id="actionTask_D1_@rowD1" data-id="@rowD1">
                                            <td class="form-group" style="width:150px;">
                                                <select class="form-control form-control-sm" id="D1_Function_@rowD1" name="D1_Function_@rowD1" required>
                                                    <option value="" selected disabled>-- select --</option>

                                                    @foreach (var v in verifyRef.RefFunctions)
                                                    {
                                                        if (v.Id == itemD1.RefFunctionId)
                                                        {

                                                            <option value="@v.Id" selected>@v.Description</option>
                                                        }
                                                        else
                                                        {
                                                            <option value="@v.Id">@v.Description</option>
                                                        }
                                                    }

                                                </select>
                                            </td>
                                            <td class="form-group" style="width:400px;">
                                                <select class="form-control form-control-sm select2" id="D1_TeamMember_@rowD1" name="D1_TeamMember_@rowD1" required style="width: 100%;" data-id="@rowD1">
                                                    <option value="" selected disabled>-- select --</option>
                                                    @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                    {
                                                        if (e.EmpId == itemD1.D1_EmployeeId)
                                                        {

                                                            <option value="@e.EmpId"
                                                                    data-domainid="@e.EmpDomainId"
                                                                    data-name="@e.EmpFullnameEN"
                                                                    data-email="@e.EmpEmail"
                                                                    data-position="@e.EmpPositionName"
                                                                    data-section="@e.EmpSectionName"
                                                                    data-department="@e.EmpDepartmentName" selected>
                                                                @e.EmpFullnameEN
                                                            </option>
                                                        }
                                                        else
                                                        {
                                                            <option value="@e.EmpId"
                                                                    data-domainid="@e.EmpDomainId"
                                                                    data-name="@e.EmpFullnameEN"
                                                                    data-email="@e.EmpEmail"
                                                                    data-position="@e.EmpPositionName"
                                                                    data-section="@e.EmpSectionName"
                                                                    data-department="@e.EmpDepartmentName">
                                                                @e.EmpFullnameEN
                                                            </option>

                                                        }


                                                    }

                                                </select>
                                            </td>
                                            <td class="form-group" style="width:400px;">
                                                <select class="form-control form-control-sm select2" id="D1_EmailTeamMember_@rowD1" name="D1_EmailTeamMember_@rowD1" style="width: 100%;" data-id="@rowD1" required>
                                                    <option value="" selected disabled>-- select --</option>
                                                    @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                    {
                                                        if (e.EmpEmail == itemD1.D1_Email)
                                                        {
                                                            <option value="@e.EmpEmail"
                                                                    data-domainid="@e.EmpDomainId"
                                                                    data-name="@e.EmpFullnameEN"
                                                                    data-email="@e.EmpEmail"
                                                                    data-position="@e.EmpPositionName"
                                                                    data-section="@e.EmpSectionName"
                                                                    data-department="@e.EmpDepartmentName" selected>
                                                                @e.EmpEmail
                                                            </option>

                                                        }
                                                        else
                                                        {
                                                            <option value="@e.EmpEmail"
                                                                    data-domainid="@e.EmpDomainId"
                                                                    data-name="@e.EmpFullnameEN"
                                                                    data-email="@e.EmpEmail"
                                                                    data-position="@e.EmpPositionName"
                                                                    data-section="@e.EmpSectionName"
                                                                    data-department="@e.EmpDepartmentName">
                                                                @e.EmpEmail
                                                            </option>

                                                        }

                                                    }

                                                </select>

                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm inputdate" id="D1_DateStartValue_@rowD1" name="D1_DateStartValue_@rowD1" required value="@(itemD1.D1_DateStart == null ? null : Convert.ToDateTime(itemD1.D1_DateStart).ToString("yyyy-MM-dd"))" />


                                            </td>
                                            <td class="form-group">
                                                <input type="text" class="form-control form-control-sm" id="D1_PhoneNo_@rowD1" name="D1_PhoneNo_@rowD1" required data-inputmask="'mask': ['999-999-9999 [x99999]', '+099 99 99 9999[9]-9999']" data-mask value="@itemD1.D1_PhoneNo">
                                            </td>
                                            <td class="text-center">
                                                @if (rowD1 == 1)
                                                {
                                                    <a href="javascript:void(0)" id="addAction_D1">
                                                        <i class="fas fa-plus text-success"></i>
                                                    </a>
                                                }
                                                else
                                                {
                                                    <a href="javascript:void(0)" class="removeAction_D1" data-id="@rowD1">
                                                        <i class="fas fa-minus text-danger"></i>
                                                    </a>

                                                }

                                            </td>
                                        </tr>
                                        rowD1++;
                                    }

                                }
                                else
                                {
                                    <tr class="actionTask_D1" id="actionTask_D1_1" data-id="1">
                                        <td class="form-group">
                                            <select class="form-control form-control-sm" id="D1_Function_1" name="D1_Function_1" required>
                                                <option value="" selected disabled>-- select --</option>
                                                @foreach (var v in verifyRef.RefFunctions.Where(w => w.Active).OrderBy(o => o.Description))
                                                {
                                                    <option value="@v.Id">@v.Description</option>

                                                }
                                            </select>
                                        </td>
                                        <td class="form-group" style="width:400px;">
                                            <select class="form-control form-control-sm select2" id="D1_TeamMember_1" name="D1_TeamMember_1" required style="width: 100%;" data-id="1">
                                                <option value="" selected disabled>-- select --</option>
                                                @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                {
                                                    <option value="@e.EmpId"
                                                            data-domainid="@e.EmpDomainId"
                                                            data-name="@e.EmpFullnameEN"
                                                            data-email="@e.EmpEmail"
                                                            data-position="@e.EmpPositionName"
                                                            data-section="@e.EmpSectionName"
                                                            data-department="@e.EmpDepartmentName">
                                                        @e.EmpFullnameEN
                                                    </option>
                                                }

                                            </select>
                                        </td>
                                        <td class="form-group" style="width:400px;">
                                            <select class="form-control form-control-sm select2" id="D1_EmailTeamMember_1" name="D1_EmailTeamMember_1" required style="width: 100%;" data-id="1">
                                                <option value="" selected disabled>-- select --</option>
                                                @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                {
                                                    <option value="@e.EmpEmail"
                                                            data-domainid="@e.EmpDomainId"
                                                            data-name="@e.EmpFullnameEN"
                                                            data-email="@e.EmpEmail"
                                                            data-position="@e.EmpPositionName"
                                                            data-section="@e.EmpSectionName"
                                                            data-department="@e.EmpDepartmentName">
                                                        @e.EmpEmail
                                                    </option>
                                                }

                                            </select>

                                        </td>
                                        <td class="form-group">
                                            <input type="date" class="form-control form-control-sm " id="D1_DateStartValue_1" name="D1_DateStartValue_1" required />

                                        </td>
                                        <td class="form-group">
                                            <input type="text" class="form-control form-control-sm" id="D1_PhoneNo_1" name="D1_PhoneNo_1" required data-inputmask="'mask': ['999-999-9999 [x99999]', '+099 99 99 9999[9]-9999']" data-mask>
                                        </td>
                                        <td class="text-center">
                                            <a href="javascript:void(0)" id="addAction_D1">
                                                <i class="fas fa-plus text-success"></i>
                                            </a>
                                        </td>
                                    </tr>
                                }

                            </tbody>
                        </table>
                    }

                </div>

            </div>
            <!-- /.card-body -->

        </div>
        <!-- /.card -->
    </div>
</div>
@* D2 *@
<div class="row">

    @{
        var itemD2 = Model.D2s;
        <div class="col-12">
            <!-- Default box -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title mr-1 text-bold" style="align-self:center;">D2: </h3><h3 class="card-title">Define the Problem</h3>

                    <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                            <i class="fas fa-minus"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">

                    <div class="row">
                        <div class="form-group col-sm-6">
                            <span>Define customer experience</span>
                            <textarea class="form-control form-control-sm" placeholder="Enter customer experience" id="D2_DefineCustomerExperience" name="D2_DefineCustomerExperience" required>@(itemD2.Count != 0 ? itemD2.FirstOrDefault().D2_DefineCustomerExperience : "")</textarea>

                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-6">
                            <span>Failure mode: (what’s wrong with what?) and effect (at org. level and at customer)</span>
                            <textarea class="form-control form-control-sm" placeholder="Enter Failure mode" id="D2_FailureMode" name="D2_FailureMode" required>@(itemD2.Count != 0 ? itemD2.FirstOrDefault().D2_FailureMode : "")</textarea>

                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-6">
                            <span>What is required by the specification?</span>
                            <textarea class="form-control form-control-sm" placeholder="Enter requirement" id="D2_RequiredByTheSpecification" name="D2_RequiredByTheSpecification" required>@(itemD2.Count != 0 ? itemD2.FirstOrDefault().D2_RequiredByTheSpecification : "")</textarea>

                        </div>
                        <div class="form-group col-sm-6">
                            <span>What’s the specification? Whose document is it?</span>
                            <textarea class="form-control form-control-sm" placeholder="Enter specification" id="D2_TheSpecificationDocument" name="D2_TheSpecificationDocument" required>@(itemD2.Count != 0 ? itemD2.FirstOrDefault().D2_TheSpecificationDocument : "")</textarea>

                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-6">
                            <span>Problem source: where in manufacturing process (if known)</span>
                            <textarea class="form-control form-control-sm" placeholder="Enter where" id="D2_ProblemSource" name="D2_ProblemSource" required>@(itemD2.Count != 0 ? itemD2.FirstOrDefault().D2_ProblemSource : "")</textarea>

                        </div>
                        <div class="form-group col-sm-6">
                            <span>Customer problem type definition </span>
                            <textarea class="form-control form-control-sm" placeholder="Enter definition" id="D2_CustomerProblemTypeDefinition" name="D2_CustomerProblemTypeDefinition" required>@(itemD2.Count != 0 ? itemD2.FirstOrDefault().D2_CustomerProblemTypeDefinition : "")</textarea>

                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <strong>Affected Part Quantification</strong>
                            <div class="row">
                                <div class="form-group col-md-6">
                                    <span>Number of parts produced within Problem Boundary</span>
                                    <input class="form-control col-md-4 form-control-sm" type="number" placeholder="0" id="D2_NumberOfPartsProducedWithinProblemBoundary" name="D2_NumberOfPartsProducedWithinProblemBoundary" required value="@(itemD2.Count != 0 ? itemD2.FirstOrDefault().D2_NumberOfPartsProducedWithinProblemBoundary : 0)" />

                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-md-6">
                                    <span>Number of parts affected</span>
                                    <input class="form-control col-md-4 form-control-sm" type="number" placeholder="0" id="D2_NumberOfPartsAffected" name="D2_NumberOfPartsAffected" required value="@(itemD2.Count != 0 ? itemD2.FirstOrDefault().D2_NumberOfPartsAffected : 0)" />

                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-md-6">
                                    <span>% of parts affected</span>
                                    @{
                                        decimal? num1 =0;
                                        decimal? num2 =0;
                                        decimal? result = 0;
                                        if (itemD2.Count != 0)
                                        {
                                            num1 = itemD2.FirstOrDefault().D2_NumberOfPartsProducedWithinProblemBoundary;
                                            num2 = itemD2.FirstOrDefault().D2_NumberOfPartsAffected;
                                            if(num2 != 0)
                                            {
                                                result = (num2/num1) * 100;
                                            }
                                            else
                                            {
                                                result = 0;
                                            }
                                        }


                                    <input class="form-control col-md-4 form-control-sm" type="number" placeholder="0" value="@result" />
                                    }
                                </div>
                            </div>

                        </div>
                        <div class=" col-md-6  ">
                            <div class="row">
                                <div class="form-group clearfix D2_RecurringProblemGroup">
                                    <span>Recurring problem?</span><br />
                                    <div class="icheck-danger d-inline">
                                        <input type="radio" id="D2_RecurringProblem_1" class="D2_RecurringProblemCheck" value="false" name="D2_RecurringProblem_1" required @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_RecurringProblem == false ? "checked" : "") : "" )>
                                        <label for="D2_RecurringProblem_1">
                                            No
                                        </label>
                                    </div>
                                    <div class="icheck-success d-inline">
                                        <input type="radio" id="D2_RecurringProblem_2" class="D2_RecurringProblemCheck" value="true" name="D2_RecurringProblem_1" required @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_RecurringProblem == true ? "checked" : "") : "")>
                                        <label for="D2_RecurringProblem_2">
                                            Yes
                                        </label>
                                    </div>
                                    <br />
                                    <input class="mb-2" type="file" multiple id="D2_AttachmentRecurrings" name="d2_attachmentRecurrings" />
                                    <br />
                                    @{var f = 1;
                                        var fileRecurring = itemD2.Where(w => w.ReportHeaderId == Model.Id).FirstOrDefault();
                                        foreach (var file in fileRecurring.D2_AttachmentRecurrings)
                                        {
                                            <div>
                                                <a asp-controller="Home" asp-action="Viewfile_D2AttachmentRecurrings" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id'>@(f++). @file.ContentName</a>
                                                <a asp-controller="Home" asp-action="DeleteFile_D2AttachmentRecurrings" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id' style="padding-left:10px;color:red;" class="@(User.IsInRole("Admin")?"":"d-none")"><i class="fa fa-trash-alt"></i>Delete</a>
                                            </div>}
                                    }
                                </div>

                            </div>
                            <div class="row">
                                <div class="form-group clearfix D2_FailureModeInDPFMEAGroup">
                                    <span>Failure mode in (D) (P) FMEA?</span>
                                    <br />
                                    <div class="icheck-danger d-inline">
                                        <input type="radio" id="D2_FailureModeInDPFMEA_1" class="D2_FailureModeInDPFMEACheck" value="false" name="D2_FailureModeInDPFMEA_1" required @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_FailureModeInDPFMEA == false ? "checked" : "") : "")>
                                        <label for="D2_FailureModeInDPFMEA_1">
                                            No
                                        </label>
                                    </div>
                                    <div class="icheck-success d-inline">
                                        <input type="radio" id="D2_FailureModeInDPFMEA_2" class="D2_FailureModeInDPFMEACheck" value="true" name="D2_FailureModeInDPFMEA_1" required @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_FailureModeInDPFMEA == true ? "checked" : "") : "" )>
                                        <label for="D2_FailureModeInDPFMEA_2">
                                            Yes
                                        </label>
                                    </div>
                                    <br />

                                    <input class="mb-1" type="file" multiple id="D2_AttachmentFailures" name="d2_attachmentFailures" />

                                    <br />
                                    @{
                                        var i = 1;
                                        var fileFailures = itemD2.Where(w => w.ReportHeaderId == Model.Id).FirstOrDefault();
                                        foreach (var file in fileFailures.D2_AttachmentFailures)
                                        {
                                            <div>
                                                <a asp-controller="Home" asp-action="Viewfile_D2AttachmentFailures" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id'>@(i++). @file.ContentName</a>
                                                <a asp-controller="Home" asp-action="DeleteFile_D2AttachmentFailures" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id' style="padding-left:10px;color:red;" class="@(User.IsInRole("Admin")?"":"d-none")"><i class="fa fa-trash-alt"></i>Delete</a>
                                            </div>}
                                    }
                                </div>


                            </div>

                        </div>

                    </div>
                    <p style="margin-bottom:5px;"><strong>Problem Boundaries</strong></p>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group clearfix">
                                <div class="icheck-primary d-inline">
                                    <input type="checkbox" id="D2_SupSupplier" name="D2_SupSupplier" @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_SupSupplier == true ? "checked" : "") : "" )>
                                    <label for="D2_SupSupplier" class="font-weight-normal">
                                        Sup Supplier
                                    </label>
                                    <input type="text" class="form-control form-control-sm" id="D2_SupSupplierDetail" name="D2_SupSupplierDetail" required placeholder="Enter text" value="@(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_SupSupplierDetail) : "")" @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_SupSupplier == true ? "" : "disabled") : "disabled") />
                                </div>
                                <br />
                                <div class="icheck-primary d-inline">
                                    <input type="checkbox" id="D2_Organization" name="D2_Organization" @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_Organization == true ? "checked" : "") : "" )>
                                    <label for="D2_Organization" class="font-weight-normal">
                                        Organization
                                    </label>
                                    <input type="text" class="form-control form-control-sm" id="D2_OrganizationDetail" name="D2_OrganizationDetail" required placeholder="Enter text" value="@(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_OrganizationDetail) : "")" @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_Organization == true ? "" : "disabled") : "disabled") />
                                </div>
                                <br />
                                <div class="icheck-primary d-inline">
                                    <input type="checkbox" id="D2_Customer" name="D2_Customer" @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_Customer == true ? "checked" : "") : "" )>
                                    <label for="D2_Customer" class="font-weight-normal">
                                        Customer
                                    </label>
                                    <input type="text" class="form-control form-control-sm" id="D2_CustomerDetail" name="D2_CustomerDetail" required placeholder="Enter text" value="@(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_CustomerDetail) : "")" @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_Customer == true ? "" : "disabled") : "disabled" ) />
                                </div>
                                <br />
                                <div class="icheck-primary d-inline">
                                    <input type="checkbox" id="D2_Other1" name="D2_Other1" @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_Other1 == true ? "checked" : "") : "")>
                                    <label for="D2_Other1" class="font-weight-normal">
                                        Other 1
                                    </label>
                                    <input type="text" class="form-control form-control-sm" id="D2_Other1Detail" name="D2_Other1Detail" required placeholder="Enter text" value="@(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_Other1Detail) : "")" @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_Other1 == true ? "" : "disabled") : "disabled" ) />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group clearfix">
                                <div class="icheck-primary d-inline">
                                    <input type="checkbox" id="D2_CustomerOfCustomer" @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_CustomerOfCustomer == true ? "checked" : "") : "" )>
                                    <label for="D2_CustomerOfCustomer" class="font-weight-normal">
                                        Customer of Customer
                                    </label>
                                    <input type="text" class="form-control form-control-sm" id="D2_CustomerOfCustomerDetail" placeholder="Enter text" value="@(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_CustomerOfCustomerDetail) : "")" @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_CustomerOfCustomer == true ? "" : "disabled") : "disabled" ) />
                                </div>
                                <br />
                                <div class="icheck-primary d-inline">
                                    <input type="checkbox" id="D2_AircraftOperators" @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_AircraftOperators == true ? "checked" : "") : "" )>
                                    <label for="D2_AircraftOperators" class="font-weight-normal">
                                        Aircraft Operators
                                    </label>
                                    <input type="text" class="form-control form-control-sm" id="D2_AircraftOperatorsDetail" placeholder="Enter text" value="@(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_AircraftOperatorsDetail) : "")" @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_AircraftOperators == true ? "" : "disabled") : "disabled" ) />
                                </div>
                                <br />
                                <div class="icheck-primary d-inline">
                                    <input type="checkbox" id="D2_SpareParts" @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_SpareParts == true ? "checked" : "") : "" )>
                                    <label for="D2_SpareParts" class="font-weight-normal">
                                        Spare Parts
                                    </label>
                                    <input type="text" class="form-control form-control-sm" id="D2_SparePartsDetail" placeholder="Enter text" value="@(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_SparePartsDetail) : "")" @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_SpareParts == true ? "" : "disabled") : "disabled") />
                                </div>
                                <br />
                                <div class="icheck-primary d-inline">
                                    <input type="checkbox" id="D2_Other2" @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_Other2 == true ? "checked" : "") : "" )>
                                    <label for="D2_Other2" class="font-weight-normal">
                                        Other 2
                                    </label>
                                    <input type="text" class="form-control form-control-sm" id="D2_Other2Detail" placeholder="Enter text" value="@(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_Other2Detail) : "")" @(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_Other2 == true ? "" : "disabled") : "disabled" ) />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <span>Problem part earliest known occurrence date</span>
                                <input type="date" class="form-control form-control-sm col-sm-3" id="D2_ProblemPartEarliestKnownOccurrenceDateValue" name="D2_ProblemPartEarliestKnownOccurrenceDateValue" required value="@(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_ProblemPartEarliestKnownOccurrenceDate == null ? null : Convert.ToDateTime(itemD2.FirstOrDefault().D2_ProblemPartEarliestKnownOccurrenceDate).ToString("yyyy-MM-dd")) : null)" />

                            </div>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <span>Problem part earliest known awareness date</span>
                                <input type="date" class="form-control form-control-sm col-sm-3" id="D2_ProblemPartEarliestKnownAwarenessDateValue" name="D2_ProblemPartEarliestKnownAwarenessDateValue" required value="@(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_ProblemPartEarliestKnownAwarenessDate == null ? null : Convert.ToDateTime(itemD2.FirstOrDefault().D2_ProblemPartEarliestKnownAwarenessDate).ToString("yyyy-MM-dd")) : null)" />

                            </div>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <span>Problem part earliest known shipment date</span>
                                <input type="date" class="form-control form-control-sm col-sm-3" id="D2_ProblemPartEarliestKnownShipmentDateValue" name="D2_ProblemPartEarliestKnownShipmentDateValue" required value="@(itemD2.Count != 0 ? (itemD2.FirstOrDefault().D2_ProblemPartEarliestKnownShipmentDate == null ? null : Convert.ToDateTime(itemD2.FirstOrDefault().D2_ProblemPartEarliestKnownShipmentDate).ToString("yyyy-MM-dd")) : null)" />

                            </div>
                        </div>

                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <p style="margin-bottom:5px;"><strong>Conform Attachments</strong> </p>
                            <div class="row">
                                <input type="file" id="D2_ConformAttachments" name="d2_ConformAttachments" />
                            </div>
                            @{

                                var D2_ConformAttachments = itemD2.Where(w => w.ReportHeaderId == Model.Id).FirstOrDefault();
                                foreach (var file in D2_ConformAttachments.D2_ImageConforms)
                                {
                                    <div class="text-center">
                                        <img src="data:image/jpeg;base64,@Convert.ToBase64String(file.Content)" class="img-fluid mb-2 p-3" style="width:300px;height:300px;" />
                                      
                                    </div>

                                }
                            }
                        </div>
                        <div class="col-md-6">
                            <p style="margin-bottom:5px;"><strong>Non-Conform Attachments</strong> </p>
                            <div class="row">
                                <input type="file" id="D2_NonConformAttachments" name="d2_NonConformAttachments" />
                            </div>
                            @{

                                var D2_NonConformAttachments = itemD2.Where(w => w.ReportHeaderId == Model.Id).FirstOrDefault();
                                foreach (var file in D2_NonConformAttachments.D2_ImageNoneConforms)
                                {
                                    <div class="text-center">
                                        <img src="data:image/jpeg;base64,@Convert.ToBase64String(file.Content)" class="img-fluid mb-2 p-3" style="width:300px;height:300px;" />
                                    </div>

                                }
                            }
                        </div>
                    </div>
                    <p style="margin-bottom:5px;">Attachments</p>
                    <div class="row">
                        <input type="file" id="D2_Attachments" name="d2_attachments" multiple />


                    </div>
                    @{
                        var y = 1;
                        var D2_Attachments = itemD2.Where(w => w.ReportHeaderId == Model.Id).FirstOrDefault();
                        foreach (var file in D2_Attachments.D2_Attachments)
                        {
                            <div class="row">
                                <a asp-controller="Home" asp-action="Viewfile_D2Attachments" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id'>@(y++). @file.ContentName</a>
                                <a asp-controller="Home" asp-action="DeleteFile_D2Attachments" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id' style="padding-left:10px;color:red;" class="@(User.IsInRole("Admin")?"":"d-none")"><i class="fa fa-trash-alt"></i>Delete</a>
                            </div>}
                    }
                    <!-- /.card-body -->

                </div>
                <!-- /.card -->
            </div>
        </div>
    }
</div>
@* D3 *@
<div class="row">

    @{
        var itemD3 = Model.D3s;
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title mr-1 text-bold" style="align-self:center;">D3: </h3><h3 class="card-title">Develop Containment Actions </h3> <small> | Eliminate or significantly reduce the effects of the failure mode on the cust</small>
                    <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                            <i class="fas fa-minus"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="form-group">
                            <div class="icheck-primary d-inline">
                                <input type="checkbox" id="D3_CopyFromD0" @(itemD3.Count != 0 ? (itemD3.FirstOrDefault().CopyFromD0 == true ? "checked" : "") : "")>
                                <label for="D3_CopyFromD0" class="font-weight-normal">
                                    Containment in place and effective (From D0)
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        @{
                            <table class="table table-sm table-striped table-valign-middle table-bordered">
                                <thead>
                                    <tr>
                                        <th>Action</th>
                                        <th>Team member</th>
                                        <th>Date Start</th>
                                        <th>Metric</th>
                                        <th>% Eff.</th>
                                        <th>Part ID</th>
                                        <th>Date Finish</th>
                                        <th>Add/Edit</th>
                                    </tr>
                                </thead>
                                <tbody id="actionTaskBody_D3">
                                    @if (itemD3.Count != 0)
                                    {
                                        var _itemActionD3 = itemD3.FirstOrDefault().D3_Actions;
                                        @if (_itemActionD3.Count != 0)
                                        {
                                            int rowD3 = 1;
                                            foreach (var itemActionD3 in itemD3.FirstOrDefault().D3_Actions)
                                            {
                                                <tr class="actionTask_D3" id="actionTask_D3_@rowD3" data-id="@rowD3">
                                                    <td class="form-group" style="width:300px;">
                                                        <textarea class="form-control form-control-sm" id="D3_Action_@rowD3" name="D3_Action_@rowD3" rows="1" required>@itemActionD3.D3_Detail</textarea>
                                                    </td>
                                                    <td class="form-group" style="width:300px;">
                                                        <select class="form-control form-control-sm select2" id="D3_TeamMember_@rowD3" required name="D3_TeamMember_@rowD3" style="width: 100%;" data-id="@rowD3">
                                                            <option value="" selected disabled>-- select --</option>
                                                            @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                            {
                                                                if (e.EmpId == itemActionD3.D3_TeamMember)
                                                                {
                                                                    <option value="@e.EmpId"
                                                                            data-domainid="@e.EmpDomainId"
                                                                            data-name="@e.EmpFullnameEN"
                                                                            data-email="@e.EmpEmail"
                                                                            data-position="@e.EmpPositionName"
                                                                            data-section="@e.EmpSectionName"
                                                                            data-department="@e.EmpDepartmentName" selected>
                                                                        @e.EmpFullnameEN
                                                                    </option>
                                                                }
                                                                else
                                                                {
                                                                    <option value="@e.EmpId"
                                                                            data-domainid="@e.EmpDomainId"
                                                                            data-name="@e.EmpFullnameEN"
                                                                            data-email="@e.EmpEmail"
                                                                            data-position="@e.EmpPositionName"
                                                                            data-section="@e.EmpSectionName"
                                                                            data-department="@e.EmpDepartmentName">
                                                                        @e.EmpFullnameEN
                                                                    </option>
                                                                }

                                                            }

                                                        </select>
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D3_DateStartValue_@rowD3" name="D3_DateStartValue_@rowD3" required value="@(itemActionD3.D3_DateStart == null ? null : Convert.ToDateTime(itemActionD3.D3_DateStart).ToString("yyyy-MM-dd") )" />


                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D3_Metric_@rowD3" name="D3_Metric_@rowD3" value="@itemActionD3.D3_Metric" required />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D3_Eff_@rowD3" name="D3_Eff_@rowD3" value="@itemActionD3.D3_Eff" required />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="text" class="form-control form-control-sm" id="D3_PartId_@rowD3" name="D3_PartId_@rowD3" value="@itemActionD3.D3_PartId" required />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D3_DateFinishValue_@rowD3" name="D3_DateFinishValue_@rowD3" value="@(itemActionD3.D3_DateFinish == null ? null : Convert.ToDateTime(itemActionD3.D3_DateFinish).ToString("yyyy-MM-dd"))" />

                                                    </td>
                                                    <td class="text-center">
                                                        @if (rowD3 == 1)
                                                        {


                                                            <a href="javascript:void(0)" id="addAction_D3">
                                                                <i class="fas fa-plus text-success"></i>
                                                            </a>
                                                        }
                                                        else
                                                        {
                                                            <a href="javascript:void(0)" class="removeAction_D3" data-id="@rowD3">
                                                                <i class="fas fa-minus text-danger"></i>
                                                            </a>

                                                        }

                                                    </td>
                                                </tr>
                                                rowD3++;
                                            }
                                        }

                                        else
                                        {
                                            <tr class="actionTask_D3" id="actionTask_D3_1" data-id="1">
                                                <td class="form-group" style="width:300px;">
                                                    <textarea class="form-control form-control-sm" id="D3_Action_1" name="D3_Action_1" rows="1" required></textarea>
                                                </td>
                                                <td class="form-group" style="width:300px;">

                                                    <select class="form-control form-control-sm select2" id="D3_TeamMember_1" name="D3_TeamMember_1" required style="width: 100%;" data-id="1">
                                                        <option value="" selected disabled>-- select --</option>
                                                        @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                        {
                                                            <option value="@e.EmpId"
                                                                    data-domainid="@e.EmpDomainId"
                                                                    data-name="@e.EmpFullnameEN"
                                                                    data-email="@e.EmpEmail"
                                                                    data-position="@e.EmpPositionName"
                                                                    data-section="@e.EmpSectionName"
                                                                    data-department="@e.EmpDepartmentName">
                                                                @e.EmpFullnameEN
                                                            </option>
                                                        }

                                                    </select>
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D3_DateStartValue_1" name="D3_DateStartValue_1" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="number" class="form-control form-control-sm" id="D3_Metric_1" name="D3_Metric_1" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="number" class="form-control form-control-sm" id="D3_Eff_1" name="D3_Eff_1" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="text" class="form-control form-control-sm" id="D3_PartId_1" name="D3_PartId_1" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D3_DateFinishValue_1" name="D3_DateFinishValue_1" required />
                                                </td>
                                                <td class="text-center">
                                                    <a href="javascript:void(0)" id="addAction_D3">
                                                        <i class="fas fa-plus text-success"></i>
                                                    </a>
                                                </td>
                                            </tr>
                                        }
                                    }
                                    else
                                    {
                                        <tr class="actionTask_D3" id="actionTask_D3_1" data-id="1">
                                            <td class="form-group" style="width:300px;">
                                                <textarea class="form-control form-control-sm" id="D3_Action_1" name="D3_Action_1" rows="1" required></textarea>
                                            </td>
                                            <td class="form-group" style="width:300px;">

                                                <select class="form-control form-control-sm select2" id="D3_TeamMember_1" name="D3_TeamMember_1" required style="width: 100%;" data-id="1">
                                                    <option value="" selected disabled>-- select --</option>
                                                    @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                    {
                                                        <option value="@e.EmpId"
                                                                data-domainid="@e.EmpDomainId"
                                                                data-name="@e.EmpFullnameEN"
                                                                data-email="@e.EmpEmail"
                                                                data-position="@e.EmpPositionName"
                                                                data-section="@e.EmpSectionName"
                                                                data-department="@e.EmpDepartmentName">
                                                            @e.EmpFullnameEN
                                                        </option>
                                                    }

                                                </select>
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D3_DateStartValue_1" name="D3_DateStartValue_1" required />
                                            </td>
                                            <td class="form-group">
                                                <input type="number" class="form-control form-control-sm" id="D3_Metric_1" name="D3_Metric_1" required />
                                            </td>
                                            <td class="form-group">
                                                <input type="number" class="form-control form-control-sm" id="D3_Eff_1" name="D3_Eff_1" required />
                                            </td>
                                            <td class="form-group">
                                                <input type="text" class="form-control form-control-sm" id="D3_PartId_1" name="D3_PartId_1" required />
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D3_DateFinishValue_1" name="D3_DateFinishValue_1" required />
                                            </td>
                                            <td class="text-center">
                                                <a href="javascript:void(0)" id="addAction_D3">
                                                    <i class="fas fa-plus text-success"></i>
                                                </a>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        }
                    </div>
                    <p style="margin-bottom:5px;">Attachments</p>
                    <div class="row">
                        <input type="file" multiple id="D3_Attachments" name="d3_attachments" />
                    </div>
                    @{
                        var w = 1;
                        var D3_Attachments = itemD3.Where(w => w.ReportHeaderId == Model.Id).FirstOrDefault();
                        foreach (var file in D3_Attachments.D3_Attachments)
                        {
                            <div class="row">
                                <a asp-controller="Home" asp-action="Viewfile_D3Attachments" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id'>@(w++). @file.ContentName</a>
                                <a asp-controller="Home" asp-action="DeleteFile_D3Attachments" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id' style="padding-left:10px;color:red;" class="@(User.IsInRole("Admin")?"":"d-none")"><i class="fa fa-trash-alt"></i>Delete</a>
                            </div>
                        }
                    }
                </div>
            </div>
        </div>
    }
</div>
@* D4 *@
<div class="row">
    @{
        var itemD4 = Model.D4s;
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title mr-1 text-bold" style="align-self:center;">D4: </h3><h3 class="card-title">Identify and Verify Root Causes |</h3> <small>  Identify & verify all causes that explain the occurrence of the failure mode</small>
                    <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                            <i class="fas fa-minus"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row">
                        <table class="table table-sm table-striped table-valign-middle table-bordered">
                            <thead>
                                <tr>
                                    <th>Cause source</th>
                                    <th>Cause description</th>
                                    <th>Verified</th>
                                    <th>Date</th>
                                    <th>Verification method(attached)</th>
                                    <th>Add/Edit</th>
                                </tr>
                            </thead>
                            <tbody id="actionTaskBody_D4">


                                @if (itemD4.Count != 0)
                                {
                                    var _itemActionD4 = itemD4.FirstOrDefault().D4_CauseSources;
                                    if (_itemActionD4.Count != 0)
                                    {
                                        var rowD4 = 1;
                                        @foreach (var itemActionD4 in _itemActionD4)
                                        {
                                            <tr class="actionTask_D4" id="actionTask_D4_@rowD4" data-id="@rowD4">
                                                <td class="form-group" style="width:300px;">
                                                    <select class="form-control form-control-sm" id="D4_CauseSource_@rowD4" name="D4_CauseSource_@rowD4" required>
                                                        <option value="" disabled selected>--select--</option>

                                                        @foreach (var c in verifyRef.RefCauseSources.OrderBy(o => o.Description))
                                                        {
                                                            if (itemActionD4.RefCauseSourceId == c.Id)
                                                            {
                                                                <option value="@c.Id" selected>@c.Description</option>
                                                            }
                                                            else
                                                            {
                                                                <option value="@c.Id">@c.Description</option>

                                                            }

                                                        }

                                                    </select>
                                                </td>
                                                <td class="form-group" style="width:300px;">
                                                    <textarea class="form-control form-control-sm" id="D4_CauseSourceDescription_@rowD4" name="D4_CauseSourceDescription_@rowD4" rows="1" required>@itemActionD4.CauseDescription</textarea>

                                                </td>
                                                <td class="form-group text-center">
                                                    <div class="icheck-success d-inline">
                                                        <input type="checkbox" id="D4_Verified_@rowD4" name="D4_Verified_@rowD4" value="@itemActionD4.Verified" required @(itemActionD4.Verified == true ? "checked" : "" )>
                                                        <label for="D4_Verified_@rowD4" class="font-weight-normal">

                                                        </label>
                                                    </div>

                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D4_DateValue_@rowD4" name="D4_DateValue_@rowD4" required value="@(itemActionD4.Date==null?null:Convert.ToDateTime(itemActionD4.Date).ToString("yyyy-MM-dd"))" />


                                                </td>
                                                <td class="form-group">
                                                    <textarea class="form-control form-control-sm" id="D4_VerificationMethod_@rowD4" name="D4_VerificationMethod_@rowD4" rows="1" required>@itemActionD4.VerificationMethod</textarea>

                                                </td>
                                                <td class="text-center">
                                                    @if (rowD4 == 1)
                                                    {


                                                        <a href="javascript:void(0)" id="addAction_D4">
                                                            <i class="fas fa-plus text-success"></i>
                                                        </a>
                                                    }
                                                    else
                                                    {
                                                        <a href="javascript:void(0)" class="removeAction_D4" data-id="@rowD4">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>

                                                    }

                                                </td>
                                            </tr>
                                            rowD4++;
                                        }

                                    }
                                    else
                                    {
                                        <tr class="actionTask_D4" id="actionTask_D4_1" data-id="1">
                                            <td class="form-group" style="width:300px;">
                                                <select class="form-control form-control-sm" id="D4_CauseSource_1" name="D4_CauseSource_1" required>
                                                    <option value="" disabled selected>--select--</option>
                                                    @foreach (var c in verifyRef.RefCauseSources.OrderBy(o => o.Description))
                                                    {
                                                        <option value="@c.Id">@c.Description</option>

                                                    }

                                                </select>
                                            </td>
                                            <td class="form-group" style="width:300px;">
                                                <textarea class="form-control form-control-sm" id="D4_CauseSourceDescription_1" name="D4_CauseSourceDescription_1" rows="1" required></textarea>

                                            </td>
                                            <td class="form-group text-center">
                                                <div class="icheck-success d-inline">
                                                    <input type="checkbox" id="D4_Verified_1" name="D4_Verified_1" required>
                                                    <label for="D4_Verified_1" class="font-weight-normal">

                                                    </label>
                                                </div>

                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D4_DateValue_1" required />



                                            </td>
                                            <td class="form-group">
                                                <textarea class="form-control form-control-sm" id="D4_VerificationMethod_1" name="D4_VerificationMethod_1" rows="1" required></textarea>

                                            </td>
                                            <td class="text-center">
                                                <a href="javascript:void(0)" id="addAction_D4">
                                                    <i class="fas fa-plus text-success"></i>
                                                </a>
                                            </td>
                                        </tr>
                                    }




                                }
                                else
                                {
                                    <tr class="actionTask_D4" id="actionTask_D4_1" data-id="1">
                                        <td class="form-group" style="width:300px;">
                                            <select class="form-control form-control-sm" id="D4_CauseSource_1" name="D4_CauseSource_1" required>
                                                <option value="" disabled selected>--select--</option>
                                                @foreach (var c in verifyRef.RefCauseSources.OrderBy(o => o.Description))
                                                {
                                                    <option value="@c.Id">@c.Description</option>

                                                }

                                            </select>
                                        </td>
                                        <td class="form-group" style="width:300px;">
                                            <textarea class="form-control form-control-sm" id="D4_CauseSourceDescription_1" name="D4_CauseSourceDescription_1" rows="1" required></textarea>

                                        </td>
                                        <td class="form-group text-center">
                                            <div class="icheck-success d-inline">
                                                <input type="checkbox" id="D4_Verified_1" name="D4_Verified_1" required>
                                                <label for="D4_Verified_1" class="font-weight-normal">

                                                </label>
                                            </div>

                                        </td>
                                        <td class="form-group">
                                            <input type="date" class="form-control form-control-sm" id="D4_DateValue_1" name="D4_DateValue_1" required />



                                        </td>
                                        <td class="form-group">
                                            <textarea class="form-control form-control-sm" id="D4_VerificationMethod_1" name="D4_VerificationMethod_1" rows="1" required></textarea>

                                        </td>
                                        <td class="text-center">
                                            <a href="javascript:void(0)" id="addAction_D4">
                                                <i class="fas fa-plus text-success"></i>
                                            </a>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                    <div class="row">
                        <div class="col-sm-3">
                            <span>Has Escape Point Causes been addressed?</span>
                        </div>
                        <div class="col-sm-6">
                            <!-- radio -->
                            <div class="form-group clearfix D4_HasEscapePointCausesBeenaddressedGroup">
                                <div class="icheck-danger d-inline">
                                    <input type="radio" id="D4_HasEscapePointCausesBeenaddressed_1" class="D4_HasEscapePointCausesBeenaddressedCheck" name="D4_HasEscapePointCausesBeenaddressed_1" value="false" required @(itemD4.Count != 0 ? (itemD4.FirstOrDefault().D4_HasEscapePointCausesBeenAddressed == false ? "checked" : "") : "" )>

                                    <label for="D4_HasEscapePointCausesBeenaddressed_1">
                                        No
                                    </label>
                                </div>
                                <div class="icheck-success d-inline">
                                    <input type="radio" id="D4_HasEscapePointCausesBeenaddressed_2" class="D4_HasEscapePointCausesBeenaddressedCheck" name="D4_HasEscapePointCausesBeenaddressed_1" value="true" required @(itemD4.Count != 0 ? (itemD4.FirstOrDefault().D4_HasEscapePointCausesBeenAddressed == true ? "checked" : "") : "" )>

                                    <label for="D4_HasEscapePointCausesBeenaddressed_2">
                                        Yes
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-3">
                            <span>Can Causes Explain differences in IS/IS NOT chart?</span>
                        </div>
                        <div class="col-sm-6">
                            <!-- radio -->
                            <div class="form-group clearfix D4_CanCausesExplainDifferencesGroup">
                                <div class="icheck-danger d-inline">
                                    <input type="radio" id="D4_CanCausesExplainDifferences_1" value="false" class="D4_CanCausesExplainDifferencesCheck" name="D4_CanCausesExplainDifferences_1" required @(itemD4.Count != 0 ? (itemD4.FirstOrDefault().D4_CanCausesExplainDifferences == false ? "checked" : "") : "" )>
                                    <label for="D4_CanCausesExplainDifferences_1">
                                        No
                                    </label>
                                </div>
                                <div class="icheck-success d-inline">
                                    <input type="radio" id="D4_CanCausesExplainDifferences_2" value="true" class="D4_CanCausesExplainDifferencesCheck" name="D4_CanCausesExplainDifferences_1" required @(itemD4.Count != 0 ? (itemD4.FirstOrDefault().D4_CanCausesExplainDifferences == true ? "checked" : "") : "" )>
                                    <label for="D4_CanCausesExplainDifferences_2">
                                        Yes
                                    </label>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-sm-3">
                            <span>Identify Causes in Process FMEA?</span>
                        </div>
                        <div class="col-sm-6">
                            <!-- radio -->
                            <div class="form-group clearfix D4_IdentifyCausesInProcessFMEAGroup">
                                <div class="icheck-danger d-inline">
                                    <input type="radio" id="D4_IdentifyCausesInProcessFMEA_1" value="false" class="D4_IdentifyCausesInProcessFMEACheck" name="D4_IdentifyCausesInProcessFMEA_1" required @(itemD4.Count != 0 ? (itemD4.FirstOrDefault().D4_IdentifyCausesInProcessFMEA == false ? "checked" : "") : "" )>
                                    <label for="D4_IdentifyCausesInProcessFMEA_1">
                                        No
                                    </label>
                                </div>
                                <div class="icheck-success d-inline">
                                    <input type="radio" id="D4_IdentifyCausesInProcessFMEA_2" value="true" class="D4_IdentifyCausesInProcessFMEACheck" name="D4_IdentifyCausesInProcessFMEA_1" required @(itemD4.Count != 0 ? (itemD4.FirstOrDefault().D4_IdentifyCausesInProcessFMEA == true ? "checked" : "") : "" )>
                                    <label for="D4_IdentifyCausesInProcessFMEA_2">
                                        Yes
                                    </label>
                                </div>
                            </div>
                        </div>

                    </div>
                    <p style="margin-bottom:5px;"><strong>Identify the cause</strong> </p>
                    <div class="row">
                        <div class="col-6">
                            <div class="form-group">
                                <div class="icheck-primary d-inline">
                                    <input type="checkbox" id="D4_FishboneCheck" name="D4_FishboneCheck" @(itemD4.Count != 0 ? (itemD4.FirstOrDefault().D4_FishBone == true ? "checked" : "") : "")>
                                    <label for="D4_FishboneCheck" class="font-weight-normal">
                                        Fish bone
                                    </label>
                                </div>
                            </div>
                            <div class="fishbone @(itemD4.Count != 0 ? (itemD4.FirstOrDefault().D4_FishBone == true ? "" : "d-none") : "d-none")">
                                <div class="row fishbone ">
                                    <div class="form-group col-12">
                                        <span>Main</span>
                                        <textarea class="form-control" placeholder="Enter comment" id="FishBone_Main">@(itemD4.Count!=0?(itemD4.FirstOrDefault().FishBone_Main):"")</textarea>
                                    </div>
                                </div>
                                <div class="row fishbone ">
                                    <div class="form-group col-12">
                                        <span>Machine</span>
                                        <textarea class="form-control" placeholder="Enter comment" id="FishBone_Machine">@(itemD4.Count != 0 ?(itemD4.FirstOrDefault().FishBone_Machine):"")</textarea>
                                    </div>
                                </div>
                                <div class="row fishbone">
                                    <div class="form-group col-12">
                                        <span>Manufacturing</span>
                                        <textarea class="form-control" placeholder="Enter comment" id="FishBone_Manufacturing">@(itemD4.Count != 0 ?(itemD4.FirstOrDefault().FishBone_Manufacturing):"")</textarea>
                                    </div>
                                </div>
                                <div class="row fishbone">
                                    <div class="form-group col-12">
                                        <span>Measurement</span>
                                        <textarea class="form-control" placeholder="Enter comment" id="FishBone_Measurement">@(itemD4.Count != 0 ?(itemD4.FirstOrDefault().FishBone_Measurement):"")</textarea>
                                    </div>
                                </div>
                                <div class="row fishbone">
                                    <div class="form-group col-12">
                                        <span>Material</span>
                                        <textarea class="form-control" placeholder="Enter comment" id="FishBone_Material">@(itemD4.Count != 0 ?(itemD4.FirstOrDefault().FishBone_Material):"")</textarea>
                                    </div>
                                </div>
                                <div class="row fishbone">
                                    <div class="form-group col-12">
                                        <span>Environment</span>
                                        <textarea class="form-control" placeholder="Enter comment" id="FishBone_Environment">@(itemD4.Count != 0 ?(itemD4.FirstOrDefault().FishBone_Environment):"")</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="form-group">
                                <div class="icheck-primary d-inline">
                                    <input type="checkbox" id="FiveWhy" name="FiveWhy" @(itemD4.Count != 0 ? (itemD4.FirstOrDefault().D4_FiveWhy == true ? "checked" : "") : "" )>
                                    <label for="FiveWhy" class="font-weight-normal">
                                        The 5 Whys
                                    </label>
                                </div>
                            </div>
                            <div class="fivewhy @(itemD4.Count != 0 ? (itemD4.FirstOrDefault().D4_FiveWhy == true ? "" : "d-none") : "d-none" )">


                                <div class="row fivewhy">
                                    <div class="form-group col-6">
                                        <span>Define the problem</span>
                                        <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_DefineTheProblem">@(itemD4.Count != 0 ?(itemD4.FirstOrDefault().DefineTheProblem):"")</textarea>
                                    </div>
                                    <div class="form-group col-6">
                                    </div>
                                </div>
                                <div class="row fivewhy">
                                    <div class="form-group col-6">
                                        <span>Why is happening?</span>
                                        <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_Why1">@(itemD4.Count != 0 ?(itemD4.FirstOrDefault().Why1):"")</textarea>
                                    </div>
                                    <div class="form-group col-6">
                                        <span>How it happening?</span>
                                        <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_How1">@(itemD4.Count != 0 ?(itemD4.FirstOrDefault().How1):"")</textarea>
                                    </div>
                                </div>
                                <div class="row fivewhy">
                                    <div class="form-group col-6">
                                        <span>Why is that?</span>
                                        <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_Why2">@(itemD4.Count != 0 ?(itemD4.FirstOrDefault().Why2):"")</textarea>
                                    </div>
                                    <div class="form-group col-6">
                                        <span>How it happening?</span>
                                        <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_How2">@(itemD4.Count != 0 ?(itemD4.FirstOrDefault().How2):"")</textarea>
                                    </div>
                                </div>
                                <div class="row fivewhy">
                                    <div class="form-group col-6">
                                        <span>Why is that?</span>
                                        <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_Why3">@(itemD4.Count != 0 ?(itemD4.FirstOrDefault().Why3):"")</textarea>
                                    </div>
                                    <div class="form-group col-6">
                                        <span>How it happening?</span>
                                        <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_How3">@(itemD4.Count != 0 ?(itemD4.FirstOrDefault().How3):"")</textarea>
                                    </div>
                                </div>
                                <div class="row fivewhy">
                                    <div class="form-group col-6">
                                        <span>Why is that?</span>
                                        <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_Why4">@(itemD4.Count != 0 ?(itemD4.FirstOrDefault().Why4):"")</textarea>
                                    </div>
                                    <div class="form-group col-6">
                                        <span>How it happening?</span>
                                        <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_How4">@(itemD4.Count != 0 ?(itemD4.FirstOrDefault().How4):"")</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                    <p style="margin-bottom:5px;">Attachments</p>
                    <div class="row">
                        <input type="file" multiple id="D4_Attachments" name="d4_attachments" />


                    </div>
                    @{
                        var d4 = 1;
                        var D4_Attachments = itemD4.Where(w => w.ReportHeaderId == Model.Id).FirstOrDefault();
                        foreach (var file in D4_Attachments.D4_Attachments)
                        {
                            <div class="row">
                                <a asp-controller="Home" asp-action="Viewfile_D4Attachments" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id'>@(d4++). @file.ContentName</a>
                                <a asp-controller="Home" asp-action="DeleteFile_D4Attachments" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id' style="padding-left:10px;color:red;" class="@(User.IsInRole("Admin")?"":"d-none")"><i class="fa fa-trash-alt"></i>Delete</a>
                            </div>
                        }

                    }
                </div>
            </div>
        </div>
    }
</div>
@* D5 *@
<div class="row">

    @{
        var itemD5 = Model.D5s;
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title mr-1 text-bold" style="align-self:center;">D5: </h3><h3 class="card-title">Identify Corrective Action | </h3> <small>  Identify & verify all causes that explain the occurrence of the failure mode</small>
                    <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                            <i class="fas fa-minus"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row">
                        <table class="table table-sm table-striped table-bordered table-valign-middle">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Cause source</th>
                                    <th>Select permanent correct Action(s)</th>
                                    <th>Verifed</th>
                                    <th>Date</th>
                                    <th>Verification method</th>
                                    <th>Add/Edit</th>

                                </tr>
                            </thead>
                            <tbody id="actionTaskBody_D5">
                                @if (itemD5.Count != 0)
                                {
                                    var _itemActionD5 = itemD5.FirstOrDefault().D5_Actions;


                                    @if (_itemActionD5.Count != 0)
                                    {
                                        int rowD5 = 1;
                                        @foreach (var itemActionD5 in _itemActionD5)
                                        {
                                            <tr class="actionTask_D5" id="actionTask_D5_@rowD5" data-id="@rowD5">
                                                <td>
                                                    1
                                                </td>
                                                <td class="form-group">
                                                    <select class="form-control form-control-sm" id="D5_CauseSource_@rowD5" name="D5_CauseSource_@rowD5" required>
                                                        <option value="" disabled selected>--select--</option>
                                                        @foreach (var c in verifyRef.RefCauseSources.OrderBy(o => o.Description))
                                                        {
                                                            if (itemActionD5.RefCauseSourceId == c.Id)
                                                            {
                                                                <option value="@c.Id" selected>@c.Description</option>
                                                            }
                                                            else
                                                            {
                                                                <option value="@c.Id">@c.Description</option>
                                                            }
                                                        }
                                                    </select>
                                                </td>
                                                <td class="form-group">
                                                    <textarea class="form-control form-control-sm" id="D5_PermanentCorrectAction_@rowD5" name="D5_PermanentCorrectAction_@rowD5" rows="1" required>@itemActionD5.Detail</textarea>

                                                </td>
                                                <td class="form-group text-center">
                                                    <div class="icheck-success d-inline">
                                                        <input type="checkbox" id="D5_Verified_@rowD5" name="D5_Verified_@rowD5" required @(itemActionD5.Verify == true ? "checked" : "" )>
                                                        <label for="D5_Verified_@rowD5" class="font-weight-normal">

                                                        </label>
                                                    </div>

                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D5_DateValue_@rowD5" name="D5_DateValue_@rowD5" required value="@(itemActionD5.Date==null?null:Convert.ToDateTime(itemActionD5.Date).ToString("yyyy-MM-dd"))" />

                                                </td>
                                                <td class="form-group">
                                                    <textarea class="form-control form-control-sm" id="D5_VerificationMethod_@rowD5" name="D5_VerificationMethod_@rowD5" rows="1" required>@itemActionD5.VerificationMethod</textarea>
                                                </td>

                                                <td class="text-center ">
                                                    @if (rowD5 == 1)
                                                    {
                                                        <a href="javascript:void(0)" id="addAction_D5">
                                                            <i class="fas fa-plus text-success"></i>
                                                        </a>
                                                    }
                                                    else
                                                    {
                                                        <a href="javascript:void(0)" class="removeAction_D5" data-id="@rowD5">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>

                                                    }
                                                </td>


                                            </tr>

                                            rowD5++;
                                        }



                                    }
                                    else
                                    {
                                        <tr class="actionTask_D5" id="actionTask_D5_1" data-id="1">
                                            <td>
                                                1
                                            </td>
                                            <td class="form-group">
                                                <select class="form-control form-control-sm" id="D5_CauseSource_1" name="D5_CauseSource_1" required>
                                                    <option value="" selected disabled>--select--</option>
                                                    @foreach (var c in verifyRef.RefCauseSources.OrderBy(o => o.Description))
                                                    {
                                                        <option value="@c.Id">@c.Description</option>
                                                    }
                                                </select>
                                            </td>
                                            <td class="form-group">
                                                <textarea class="form-control form-control-sm" id="D5_PermanentCorrectAction_1" name="D5_PermanentCorrectAction_1" rows="1" required></textarea>

                                            </td>
                                            <td class="form-group text-center">
                                                <div class="icheck-success d-inline">
                                                    <input type="checkbox" id="D5_Verified_1" name="D5_Verified_1" required>
                                                    <label for="D5_Verified_1" class="font-weight-normal">

                                                    </label>
                                                </div>

                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D5_DateValue_1" name="D5_DateValue_1" required />
                                            </td>
                                            <td class="form-group">
                                                <textarea class="form-control form-control-sm" id="D5_VerificationMethod_1" name="D5_VerificationMethod_1" rows="1" required></textarea>
                                            </td>

                                            <td class="text-center">
                                                <a href="javascript:void(0)" id="addAction_D5">
                                                    <i class="fas fa-plus text-success"></i>
                                                </a>
                                            </td>


                                        </tr>

                                    }

                                }
                                else
                                {
                                    <tr class="actionTask_D5" id="actionTask_D5_1" data-id="1">
                                        <td>
                                            1
                                        </td>
                                        <td class="form-group">
                                            <select class="form-control form-control-sm" id="D5_CauseSource_1" name="D5_CauseSource_1">
                                                <option value="" disabled selected>--select--</option>
                                                @foreach (var c in verifyRef.RefCauseSources.OrderBy(o => o.Description))
                                                {
                                                    <option value="@c.Id">@c.Description</option>
                                                }
                                            </select>
                                        </td>
                                        <td class="form-group">
                                            <textarea class="form-control form-control-sm" id="D5_PermanentCorrectAction_1" name="D5_PermanentCorrectAction_1" rows="1" required></textarea>

                                        </td>
                                        <td class="form-group text-center">
                                            <div class="icheck-success d-inline">
                                                <input type="checkbox" id="D5_Verified_1" name="D5_Verified_1" required>
                                                <label for="D5_Verified_1" class="font-weight-normal">

                                                </label>
                                            </div>

                                        </td>
                                        <td class="form-group">
                                            <input type="date" class="form-control form-control-sm" id="D5_DateValue_1" name="D5_DateValue_1" required />
                                        </td>
                                        <td class="form-group">
                                            <textarea class="form-control form-control-sm" id="D5_VerificationMethod_1" name="D5_VerificationMethod_1" rows="1" required></textarea>
                                        </td>

                                        <td class="text-center">
                                            <a href="javascript:void(0)" id="addAction_D5">
                                                <i class="fas fa-plus text-success"></i>
                                            </a>
                                        </td>


                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                    <p style="margin-bottom:5px;">Attachments</p>
                    <div class="row">
                        <input type="file" multiple id="D5_Attachments" name="d5_attachments" />


                    </div>
                    @{
                        var d5 = 1;
                        var D5_Attachments = itemD5.Where(w => w.ReportHeaderId == Model.Id).FirstOrDefault();
                        foreach (var file in D5_Attachments.D5_Attachments)
                        {
                            <div class="row">
                                <a asp-controller="Home" asp-action="Viewfile_D5Attachments" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id'>@(d5++). @file.ContentName</a>
                                <a asp-controller="Home" asp-action="DeleteFile_D5Attachments" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id' style="padding-left:10px;color:red;" class="@(User.IsInRole("Admin")?"":"d-none")"><i class="fa fa-trash-alt"></i>Delete</a>
                            </div>
                        }
                    }
                </div>
            </div>
        </div>

    }

</div>
@* D6 *@
<div class="row">

    @{
        var itemD6 = Model.D6s;
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title mr-1 text-bold" style="align-self:center;">D6: </h3><h3 class="card-title">Implement Corrective Action | </h3> <small>  Define and execute an implementation plan for the corrective action.</small>
                    <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                            <i class="fas fa-minus"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row">
                        <table class="table table-sm table-striped table-bordered table-valign-middle">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Select permanent correct Action(s) - PCA</th>
                                    <th>PCA Implementation plan </th>
                                    <th style="width:300px;">Team menber</th>
                                    <th style="width:180px;">Implementation Date</th>
                                    <th>Customer concurrence</th>
                                    <th>PCA Status</th>
                                    <th>Add/Edit</th>
                                </tr>
                            </thead>
                            <tbody id="actionTaskBody_D6">
                                @if (itemD6.Count != 0)
                                {
                                    var _itemActionD6 = itemD6.FirstOrDefault().D6_Actions;
                                    int rowD6 = 1;
                                    if (_itemActionD6.Count != 0)
                                    {
                                        @foreach (var itemActionD6 in _itemActionD6)
                                        {
                                            <tr class="actionTask_D6" id="actionTask_D6_@rowD6" data-id="@rowD6">
                                                <td>
                                                    1
                                                </td>
                                                <td class="form-group">
                                                    <textarea class="form-control form-control-sm" id="D6_PermenentCorrectiveAction_@rowD6" name="D6_PermenentCorrectiveAction_@rowD6" rows="1" required>@itemActionD6.Detail</textarea>

                                                </td>
                                                <td class="form-group">
                                                    <textarea class="form-control form-control-sm" id="D6_ImplementationPlan_@rowD6" name="D6_ImplementationPlan_@rowD6" rows="1" required>@itemActionD6.ImplementationPlan</textarea>
                                                </td>
                                                <td class="form-group">
                                                    <select class="form-control form-control-sm select2" id="D6_TeamMember_@rowD6" name="D6_TeamMember_@rowD6" required style="width: 100%;" data-id="@rowD6">
                                                        <option value="" disabled selected>-- select --</option>
                                                        @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                        {
                                                            if (e.EmpId == itemActionD6.TeamMemberId)
                                                            {
                                                                <option value="@e.EmpId"
                                                                        data-domainid="@e.EmpDomainId"
                                                                        data-name="@e.EmpFullnameEN"
                                                                        data-email="@e.EmpEmail"
                                                                        data-position="@e.EmpPositionName"
                                                                        data-section="@e.EmpSectionName"
                                                                        data-department="@e.EmpDepartmentName" selected>
                                                                    @e.EmpFullnameEN
                                                                </option>
                                                            }
                                                            else
                                                            {
                                                                <option value="@e.EmpId"
                                                                        data-domainid="@e.EmpDomainId"
                                                                        data-name="@e.EmpFullnameEN"
                                                                        data-email="@e.EmpEmail"
                                                                        data-position="@e.EmpPositionName"
                                                                        data-section="@e.EmpSectionName"
                                                                        data-department="@e.EmpDepartmentName">
                                                                    @e.EmpFullnameEN
                                                                </option>
                                                            }

                                                        }
                                                    </select>
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D6_DateValue_@rowD6" name="D6_DateValue_@rowD6" required value="@(itemActionD6.ImplementActionDate==null?null:Convert.ToDateTime(itemActionD6.ImplementActionDate).ToString("yyyy-MM-dd"))" />

                                                </td>
                                                <td class="form-group">
                                                    <div class="clearfix D6_CustomerConcurrenceGroup">
                                                        <div class="icheck-danger d-inline">
                                                            <input type="radio" id="D6_CustomerConcurrence_No_@rowD6" name="D6_CustomerConcurrence_@rowD6" required value="false" @(itemActionD6.CustomerConcurrence == false ? "checked" : "" )>
                                                            <label for="D6_CustomerConcurrence_No_@rowD6">
                                                                No
                                                            </label>
                                                        </div>
                                                        <div class="icheck-success d-inline">
                                                            <input type="radio" id="D6_CustomerConcurrence_Yes_@rowD6" name="D6_CustomerConcurrence_@rowD6" required value="true" @(itemActionD6.CustomerConcurrence == true ? "checked" : "" )>
                                                            <label for="D6_CustomerConcurrence_Yes_@rowD6">
                                                                Yes
                                                            </label>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td class="form-group">
                                                    <select class="form-control form-control-sm" id="D6_PCAStatus_@rowD6" name="D6_PCAStatus_@rowD6" required>
                                                        <option value="" selected disabled>-- select --</option>
                                                        @foreach (var p in verifyRef.RefPCAStatuses.OrderBy(o => o.Name))
                                                        {
                                                            if (itemActionD6.RefPCAStatusId == p.Id)
                                                            {
                                                                <option value="@p.Id" selected>@p.Name</option>

                                                            }
                                                            else
                                                            {
                                                                <option value="@p.Id">@p.Name</option>

                                                            }
                                                        }

                                                    </select>
                                                </td>
                                                <td class="text-center">
                                                    @if (rowD6 == 1)
                                                    {
                                                        <a href="javascript:void(0)" id="addAction_D6">
                                                            <i class="fas fa-plus text-success"></i>
                                                        </a>
                                                    }
                                                    else
                                                    {
                                                        <a href="javascript:void(0)" class="removeAction_D6" data-id="@rowD6">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>

                                                    }
                                                </td>

                                            </tr>
                                            rowD6++;
                                        }



                                    }
                                    else
                                    {
                                        <tr class="actionTask_D6" id="actionTask_D6_1" data-id="1">
                                            <td>
                                                1
                                            </td>
                                            <td class="form-group">
                                                <textarea class="form-control form-control-sm" id="D6_PermenentCorrectiveAction_1" name="D6_PermenentCorrectiveAction_1" rows="1" required></textarea>

                                            </td>
                                            <td class="form-group">
                                                <textarea class="form-control form-control-sm" id="D6_ImplementationPlan_1" name="D6_ImplementationPlan_1" rows="1" required></textarea>
                                            </td>
                                            <td class="form-group">
                                                <select class="form-control form-control-sm select2" id="D6_TeamMember_1" name="D6_TeamMember_1" style="width: 100%;" required data-id="1">
                                                    <option value="" selected disabled>-- select --</option>
                                                    @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                    {

                                                        <option value="@e.EmpId"
                                                                data-domainid="@e.EmpDomainId"
                                                                data-name="@e.EmpFullnameEN"
                                                                data-email="@e.EmpEmail"
                                                                data-position="@e.EmpPositionName"
                                                                data-section="@e.EmpSectionName"
                                                                data-department="@e.EmpDepartmentName">
                                                            @e.EmpFullnameEN
                                                        </option>
                                                    }
                                                </select>
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D6_DateValue_1" name="D6_DateValue_1" required />
                                            </td>
                                            <td class="form-group">
                                                <div class="clearfix D6_CustomerConcurrenceGroup">
                                                    <div class="icheck-danger d-inline">
                                                        <input type="radio" id="D6_CustomerConcurrence_No_1" class="D6_CustomerConcurrenceCheck" name="D6_CustomerConcurrence_1" required value="false">
                                                        <label for="D6_CustomerConcurrence_No_1">
                                                            No
                                                        </label>
                                                    </div>
                                                    <div class="icheck-success d-inline">
                                                        <input type="radio" id="D6_CustomerConcurrence_Yes_1" class="D6_CustomerConcurrenceCheck" name="D6_CustomerConcurrence_1" value="true" required>
                                                        <label for="D6_CustomerConcurrence_Yes_1">
                                                            Yes
                                                        </label>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="form-group">
                                                <select class="form-control form-control-sm" id="D6_PCAStatus_1" name="D6_PCAStatus_1" required>
                                                    <option value="" selected disabled>-- select --</option>
                                                    @foreach (var p in verifyRef.RefPCAStatuses.OrderBy(o => o.Name))
                                                    {
                                                        <option value="@p.Id">@p.Name</option>
                                                    }
                                                </select>
                                            </td>
                                            <td class="text-center">
                                                <a href="javascript:void(0)" id="addAction_D6">
                                                    <i class="fas fa-plus text-success"></i>
                                                </a>
                                            </td>

                                        </tr>

                                    }

                                }
                                else
                                {
                                    <tr class="actionTask_D6" id="actionTask_D6_1" data-id="1">
                                        <td>
                                            1
                                        </td>
                                        <td class="form-group">
                                            <textarea class="form-control form-control-sm" id="D6_PermenentCorrectiveAction_1" name="D6_PermenentCorrectiveAction_1" rows="1" required></textarea>

                                        </td>
                                        <td class="form-group">
                                            <textarea class="form-control form-control-sm" id="D6_ImplementationPlan_1" name="D6_ImplementationPlan_1" rows="1" required></textarea>
                                        </td>
                                        <td class="form-group">
                                            <select class="form-control form-control-sm select2" id="D6_TeamMember_1" name="D6_TeamMember_1" style="width: 100%;" data-id="1" required>
                                                <option value="" selected disabled>-- select --</option>
                                                @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                {
                                                    <option value="@e.EmpId"
                                                            data-domainid="@e.EmpDomainId"
                                                            data-name="@e.EmpFullnameEN"
                                                            data-email="@e.EmpEmail"
                                                            data-position="@e.EmpPositionName"
                                                            data-section="@e.EmpSectionName"
                                                            data-department="@e.EmpDepartmentName">
                                                        @e.EmpFullnameEN
                                                    </option>
                                                }
                                            </select>
                                        </td>
                                        <td class="form-group">
                                            <input type="date" class="form-control form-control-sm" id="D6_DateValue_1" name="D6_DateValue_1" required />
                                        </td>
                                        <td class="form-group">
                                            <div class="clearfix D6_CustomerConcurrenceGroup">
                                                <div class="icheck-danger d-inline">
                                                    <input type="radio" id="D6_CustomerConcurrence_No_1" class="D6_CustomerConcurrenceCheck" name="D6_CustomerConcurrence_1" required value="false">
                                                    <label for="D6_CustomerConcurrence_No_1">
                                                        No
                                                    </label>
                                                </div>
                                                <div class="icheck-success d-inline">
                                                    <input type="radio" id="D6_CustomerConcurrence_Yes_1" class="D6_CustomerConcurrenceCheck" name="D6_CustomerConcurrence_1" required value="true">
                                                    <label for="D6_CustomerConcurrence_Yes_1">
                                                        Yes
                                                    </label>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="form-group">
                                            <select class="form-control form-control-sm" id="D6_PCAStatus_1" name="D6_PCAStatus_1" required>
                                                <option value="" selected disabled>-- select --</option>
                                                @foreach (var p in verifyRef.RefPCAStatuses.OrderBy(o => o.Name))
                                                {
                                                    <option value="@p.Id">@p.Name</option>
                                                }
                                            </select>
                                        </td>
                                        <td class="text-center">
                                            <a href="javascript:void(0)" id="addAction_D6">
                                                <i class="fas fa-plus text-success"></i>
                                            </a>
                                        </td>

                                    </tr>

                                }
                            </tbody>
                        </table>
                    </div>
                    <p style="margin-bottom:5px;">Attachments</p>
                    <div class="row">
                        <input type="file" id="D6_Attachments" name="d6_attachments" multiple />


                    </div>
                    @{
                        var d6 = 1;
                        var D6_Attachments = itemD6.Where(w => w.ReportHeaderId == Model.Id).FirstOrDefault();
                        foreach (var file in D6_Attachments.D6_Attachments)
                        {
                            <div class="row">
                                <a asp-controller="Home" asp-action="Viewfile_D6Attachments" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id'>@(d6++). @file.ContentName</a>
                                <a asp-controller="Home" asp-action="DeleteFile_D6Attachments" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id' style="padding-left:10px;color:red;" class="@(User.IsInRole("Admin")?"":"d-none")"><i class="fa fa-trash-alt"></i>Delete</a>
                            </div>
                        }
                    }
                </div>
            </div>
        </div>
    }

</div>
@* D7 *@
<div class="row">

    @{
        var itemD7 = Model.D7s;
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title mr-1 text-bold" style="align-self:center;">D7: </h3><h3 class="card-title">Define and plan preventive action | </h3> <small> Modify systems to Prevent Recurrence of this and similar problems. Recommend systemic improvements</small>
                    <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                            <i class="fas fa-minus"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    @* D7A *@
                    <div class="row">
                        <table class="table table-sm table-bordered table-striped table-valign-middle">
                            <thead>
                                <tr>
                                    <th>7A</th>
                                    <th>Select preventive Action -PA</th>
                                    <th>PA Implementation plan </th>
                                    <th style="width:300px;">Team menber</th>
                                    <th>Target Date</th>
                                    <th>Actual Date</th>
                                    <th>PA Status</th>
                                    <th>Add/Edit</th>
                                </tr>
                            </thead>
                            <tbody id="actionTaskBody_D7A">
                                @if (itemD7.Count != 0)
                                {
                                    var _itemD7A = itemD7.FirstOrDefault().D7_As;
                                    int rowD7A = 1;
                                    if (_itemD7A.Count != 0)
                                    {
                                        foreach (var itemD7A in _itemD7A)
                                        {
                                            <tr class="actionTask_D7A" id="actionTask_D7A_@rowD7A" data-id="@rowD7A">
                                                <td>
                                                    1
                                                </td>
                                                <td class="form-group">
                                                    <textarea class="form-control form-control-sm" id="D7A_SelectedPreventiveAction_@rowD7A" name="D7A_SelectedPreventiveAction_@rowD7A" rows="1" required>@itemD7A.PreventiveAction</textarea>

                                                </td>
                                                <td class="form-group">
                                                    <textarea class="form-control form-control-sm" id="D7A_ImplementationPlan_@rowD7A" name="D7A_ImplementationPlan_@rowD7A" rows="1" required>@itemD7A.PAImplementationPlan</textarea>

                                                </td>
                                                <td class="form-group">
                                                    <select class="form-control form-control-sm select2" id="D7A_TeamMember_@rowD7A" name="D7A_TeamMember_@rowD7A" required style="width: 100%;" data-id="@rowD7A">
                                                        <option value="" disabled selected>-- select --</option>
                                                        @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                        {
                                                            if (e.EmpId == itemD7A.TeamMemberId)
                                                            {
                                                                <option value="@e.EmpId"
                                                                        data-domainid="@e.EmpDomainId"
                                                                        data-name="@e.EmpFullnameEN"
                                                                        data-email="@e.EmpEmail"
                                                                        data-position="@e.EmpPositionName"
                                                                        data-section="@e.EmpSectionName"
                                                                        data-department="@e.EmpDepartmentName" selected>
                                                                    @e.EmpFullnameEN
                                                                </option>
                                                            }
                                                            else
                                                            {
                                                                <option value="@e.EmpId"
                                                                        data-domainid="@e.EmpDomainId"
                                                                        data-name="@e.EmpFullnameEN"
                                                                        data-email="@e.EmpEmail"
                                                                        data-position="@e.EmpPositionName"
                                                                        data-section="@e.EmpSectionName"
                                                                        data-department="@e.EmpDepartmentName">
                                                                    @e.EmpFullnameEN
                                                                </option>
                                                            }

                                                        }
                                                    </select>
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7A_TargetDateValue_@rowD7A" name="D7A_TargetDateValue_@rowD7A" required value="@(itemD7A.TargetDate==null?null:Convert.ToDateTime(itemD7A.TargetDate).ToString("yyyy-MM-dd"))" />

                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7A_ActualDate_@rowD7A" name="D7A_ActualDate_@rowD7A" required value="@(itemD7A.ActualDate==null?null:Convert.ToDateTime(itemD7A.ActualDate).ToString("yyyy-MM-dd"))" />

                                                </td>
                                                <td class="form-group">
                                                    <select class="form-control form-control-sm" id="D7A_PCAStatus_@rowD7A" required name="D7A_PCAStatus_@rowD7A">
                                                        <option value="" disabled selected>-- select --</option>
                                                        @foreach (var p in verifyRef.RefPCAStatuses.OrderBy(o => o.Name))
                                                        {
                                                            if (itemD7A.RefPCAStatusId == p.Id)
                                                            {

                                                                <option value="@p.Id" selected>@p.Name</option>
                                                            }
                                                            else
                                                            {
                                                                <option value="@p.Id">@p.Name</option>

                                                            }
                                                        }
                                                    </select>
                                                </td>
                                                <td class="text-center">
                                                    @if (rowD7A == 1)
                                                    {
                                                        <a href="javascript:void(0)" id="addAction_D7A">
                                                            <i class="fas fa-plus text-success"></i>
                                                        </a>
                                                    }
                                                    else
                                                    {
                                                        <a href="javascript:void(0)" class="removeAction_D7A" data-id="@rowD7A">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>

                                                    }

                                                </td>

                                            </tr>
                                            rowD7A++;
                                        }
                                    }
                                    else
                                    {
                                        <tr class="actionTask_D7A" id="actionTask_D7A_1" data-id="1">
                                            <td>
                                                1
                                            </td>
                                            <td class="form-group">
                                                <textarea class="form-control form-control-sm" id="D7A_SelectedPreventiveAction_1" name="D7A_SelectedPreventiveAction_1" rows="1" required></textarea>

                                            </td>
                                            <td class="form-group">
                                                <textarea class="form-control form-control-sm" id="D7A_ImplementationPlan_1" name="D7A_ImplementationPlan_1" rows="1" required></textarea>

                                            </td>
                                            <td class="form-group">
                                                <select class="form-control form-control-sm select2" id="D7A_TeamMember_1" name="D7A_TeamMember_1" style="width: 100%;" data-id="1" required>
                                                    <option value="" selected disabled>-- select --</option>
                                                    @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                    {
                                                        <option value="@e.EmpFullnameEN"
                                                                data-domainid="@e.EmpDomainId"
                                                                data-name="@e.EmpFullnameEN"
                                                                data-email="@e.EmpEmail"
                                                                data-position="@e.EmpPositionName"
                                                                data-section="@e.EmpSectionName"
                                                                data-department="@e.EmpDepartmentName">
                                                            @e.EmpFullnameEN
                                                        </option>
                                                    }
                                                </select>
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7A_TargetDateValue_1" name="D7A_TargetDateValue_1" required />


                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7A_ActualDate_1" name="D7A_ActualDate_1" required />

                                            </td>
                                            <td>
                                                <select class="form-control form-control-sm" id="D7A_PCAStatus_1" name="D7A_PCAStatus_1" required>
                                                    <option value="" selected disabled>-- select --</option>
                                                    @foreach (var p in verifyRef.RefPCAStatuses.OrderBy(o => o.Name))
                                                    {
                                                        <option value="@p.Id">@p.Name</option>
                                                    }
                                                </select>
                                            </td>
                                            <td class="text-center">
                                                <a href="javascript:void(0)" id="addAction_D7A">
                                                    <i class="fas fa-plus text-success"></i>
                                                </a>
                                            </td>

                                        </tr>
                                    }


                                }
                                else
                                {
                                    <tr class="actionTask_D7A" id="actionTask_D7A_1" data-id="1">
                                        <td>
                                            1
                                        </td>
                                        <td class="form-group">
                                            <textarea class="form-control form-control-sm" id="D7A_SelectedPreventiveAction_1" name="D7A_SelectedPreventiveAction_1" rows="1" required></textarea>

                                        </td>
                                        <td class="form-group">
                                            <textarea class="form-control form-control-sm" id="D7A_ImplementationPlan_1" name="D7A_ImplementationPlan_1" rows="1" required></textarea>

                                        </td>
                                        <td class="form-group">
                                            <select class="form-control form-control-sm select2" id="D7A_TeamMember_1" name="D7A_TeamMember_1" style="width: 100%;" data-id="1" required>
                                                <option value="" selected disabled>-- select --</option>
                                                @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                {
                                                    <option value="@e.EmpFullnameEN"
                                                            data-domainid="@e.EmpDomainId"
                                                            data-name="@e.EmpFullnameEN"
                                                            data-email="@e.EmpEmail"
                                                            data-position="@e.EmpPositionName"
                                                            data-section="@e.EmpSectionName"
                                                            data-department="@e.EmpDepartmentName">
                                                        @e.EmpFullnameEN
                                                    </option>
                                                }
                                            </select>
                                        </td>
                                        <td class="form-group">
                                            <input type="date" class="form-control form-control-sm" id="D7A_TargetDateValue_1" name="D7A_TargetDateValue_1" required />


                                        </td>
                                        <td class="form-group">
                                            <input type="date" class="form-control form-control-sm" id="D7A_ActualDate_1" name="D7A_ActualDate_1" required />

                                        </td>
                                        <td class="form-group">
                                            <select class="form-control form-control-sm" id="D7A_PCAStatus_1" name="D7A_PCAStatus_1" required>
                                                <option value="" selected disabled>-- select --</option>
                                                @foreach (var p in verifyRef.RefPCAStatuses.OrderBy(o => o.Name))
                                                {
                                                    <option value="@p.Id">@p.Name</option>
                                                }
                                            </select>
                                        </td>
                                        <td class="text-center">
                                            <a href="javascript:void(0)" id="addAction_D7A">
                                                <i class="fas fa-plus text-success"></i>
                                            </a>
                                        </td>

                                    </tr>
                                }



                            </tbody>
                        </table>
                    </div>
                    @* D7B *@
                    <div class="row">

                        <table class="table table-sm table-striped table-valign-middle table-bordered">
                            <thead>
                                <tr>
                                    <th><strong>7B</strong></th>
                                    <th colspan="4">List smilar Processes/ Items with the potential of the same defect</th>

                                </tr>
                                <tr>
                                    <th>No</th>
                                    <th>Process/Item</th>
                                    <th>Responsible </th>
                                    <th style="width:180px;">Plan Veridation Date</th>
                                    <th style="width:50px;">Add/Edit</th>
                                </tr>
                            </thead>
                            <tbody id="actionTaskBody_D7B">
                                @if (itemD7.Count != 0)
                                {
                                    var _itemD7B = itemD7.FirstOrDefault().D7_Bs;
                                    int rowD7B = 1;
                                    if (_itemD7B.Count != 0)
                                    {
                                        foreach (var itemD7B in _itemD7B)
                                        {
                                            <tr class="actionTask_D7B" id="actionTask_D7B_@rowD7B" data-id="@rowD7B">
                                                <td>
                                                    @rowD7B.
                                                </td>
                                                <td class="form-group">
                                                    <textarea class="form-control form-control-sm" id="D7B_ProcessItem_@rowD7B" name="D7B_ProcessItem_@rowD7B" rows="1" placeholder="Enter" required>@itemD7B.Process</textarea>

                                                </td>
                                                <td class="form-group">
                                                    <textarea class="form-control form-control-sm" id="D7B_Responsible_@rowD7B" name="D7B_Responsible_@rowD7B" rows="1" placeholder="Enter" required>@itemD7B.Responsible</textarea>
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7B_PlanValidationDateValue_@rowD7B" name="D7B_PlanValidationDateValue_@rowD7B" value="@(itemD7B.PlanValidationDate==null?null:Convert.ToDateTime(itemD7B.PlanValidationDate).ToString("yyyy-MM-dd"))" required />

                                                </td>
                                                <td class="text-center">
                                                    @if (rowD7B == 1)
                                                    {
                                                        <a href="javascript:void(0)" id="addAction_D7B">
                                                            <i class="fas fa-plus text-success"></i>
                                                        </a>
                                                    }
                                                    else
                                                    {
                                                        <a href="javascript:void(0)" class="removeAction_D7B" data-id="@rowD7B">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>

                                                    }

                                                </td>
                                            </tr>
                                            rowD7B++;
                                        }
                                    }
                                    else
                                    {
                                        <tr class="actionTask_D7B" id="actionTask_D7B_1" data-id="1">
                                            <td>
                                                1
                                            </td>
                                            <td class="form-group">
                                                <textarea class="form-control form-control-sm" id="D7B_ProcessItem_1" name="D7B_ProcessItem_1" placeholder="Enter" rows="1" required></textarea>
                                            </td>
                                            <td class="form-group">
                                                <textarea class="form-control form-control-sm" id="D7B_Responsible_1" name="D7B_Responsible_1" rows="1" required></textarea>
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7B_PlanValidationDateValue_1" name="D7B_PlanValidationDateValue_1" required />
                                            </td>
                                            <td class="text-center">
                                                <a href="javascript:void(0)" id="addAction_D7B">
                                                    <i class="fas fa-plus text-success"></i>
                                                </a>
                                            </td>
                                        </tr>
                                    }

                                }
                                else
                                {
                                    <tr class="actionTask_D7B" id="actionTask_D7B_1" data-id="1">
                                        <td>
                                            1
                                        </td>
                                        <td class="form-group">
                                            <textarea class="form-control form-control-sm" id="D7B_ProcessItem_1" name="D7B_ProcessItem_1" rows="1" required></textarea>
                                        </td>
                                        <td class="form-group">
                                            <textarea class="form-control form-control-sm" id="D7B_Responsible_1" name="D7B_Responsible_1" rows="1" required></textarea>
                                        </td>
                                        <td class="form-group">
                                            <input type="date" class="form-control form-control-sm" id="D7B_PlanValidationDateValue_1" required />
                                        </td>
                                        <td class="text-center">
                                            <a href="javascript:void(0)" id="addAction_D7B">
                                                <i class="fas fa-plus text-success"></i>
                                            </a>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>

                    </div>
                    @* D7C *@

                    @*@var itemD7C = itemD7.FirstOrDefault().D7_Cs;*@
                    @{


                        <div class="row">
                            <table class="table table-sm table-striped table-valign-middle table-bordered">
                                <thead>
                                    <tr>
                                        <th><strong>7C</strong></th>
                                        <th colspan="5">Reviewed and revised if necessary the folowing</th>

                                    </tr>
                                    <tr>
                                        <th rowspan="2">No</th>
                                        <th rowspan="2">Reviewed document</th>
                                        <th rowspan="2">Nature of revision </th>
                                        <th rowspan="2">Resp.</th>
                                        <th colspan="2">Review Completion Date</th>
                                    </tr>
                                    <tr>
                                        <th style="width:150px;">Plan</th>
                                        <th style="width:150px;">Actual</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @if (itemD7.Count != 0)
                                    {
                                        var itemD7C = itemD7.FirstOrDefault().D7_Cs;
                                        if (itemD7C.Count != 0)
                                        {
                                            <tr>
                                                <td>
                                                    1
                                                </td>
                                                <td>
                                                    Quality awareness communication
                                                </td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Description_1" placeholder="Revision description" required>@(itemD7C.FirstOrDefault().NatureOfRevisionNo1)</textarea></td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_1" placeholder="Name" required>@(@itemD7C.FirstOrDefault().Resp1)</textarea></td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_1" name="D7C_ReviewCompletionDatePlanValue_1" required value="@(itemD7C.FirstOrDefault().PlanDate1==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().PlanDate1).ToString("yyyy-MM-dd"))" />


                                                </td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_1" name="D7C_ReviewCompletionDateActualValue_1" required value="@(itemD7C.FirstOrDefault().ActualDate1==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().ActualDate1).ToString("yyyy-MM-dd"))" />


                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    2
                                                </td>
                                                <td>
                                                    Design FMEA
                                                </td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Description_2" name="D7C_Description_2" required placeholder="Revision description">@(itemD7C.FirstOrDefault().NatureOfRevisionNo2)</textarea></td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_2" name="D7C_Resp_2" placeholder="Name">@(itemD7C.FirstOrDefault().Resp2)</textarea></td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_2" name="D7C_ReviewCompletionDatePlanValue_2" required value="@(itemD7C.FirstOrDefault().PlanDate2==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().PlanDate2).ToString("yyyy-MM-dd"))" />


                                                </td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_2" name="D7C_ReviewCompletionDateActualValue_2" required value="@(itemD7C.FirstOrDefault().ActualDate2==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().ActualDate2).ToString("yyyy-MM-dd"))" />


                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    3
                                                </td>
                                                <td>
                                                    Process Flow Chart
                                                </td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Description_3" name="D7C_Description_3" required placeholder="Revision description">@(itemD7C.FirstOrDefault().NatureOfRevisionNo3)</textarea></td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_3" name="D7C_Resp_3" placeholder="Name" required>@(itemD7C.FirstOrDefault().Resp3)</textarea></td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_3" name="D7C_ReviewCompletionDatePlanValue_3" required value="@(itemD7C.FirstOrDefault().PlanDate3==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().PlanDate3).ToString("yyyy-MM-dd"))" />

                                                </td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_3" name="D7C_ReviewCompletionDateActualValue_3" required value="@(itemD7C.FirstOrDefault().ActualDate3==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().ActualDate3).ToString("yyyy-MM-dd"))" />
                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    4
                                                </td>
                                                <td>
                                                    Process FMEA
                                                </td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Description_4" name="D7C_Description_4" placeholder="Revision description" required>@(itemD7C.FirstOrDefault().NatureOfRevisionNo4)</textarea></td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_4" name="D7C_Resp_4" placeholder="Name" required>@(itemD7C.FirstOrDefault().Resp4)</textarea></td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_4" name="D7C_ReviewCompletionDatePlanValue_4" required value="@(itemD7C.FirstOrDefault().PlanDate4==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().PlanDate4).ToString("yyyy-MM-dd"))" />


                                                </td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_4" name="D7C_ReviewCompletionDateActualValue_4" required value="@(itemD7C.FirstOrDefault().ActualDate4==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().ActualDate4).ToString("yyyy-MM-dd"))" />


                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    5
                                                </td>
                                                <td>
                                                    Process Control Plan
                                                </td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Description_5" name="D7C_Description_5" required placeholder="Revision description">@(itemD7C.FirstOrDefault().NatureOfRevisionNo5)</textarea></td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_5" name="D7C_Resp_5" placeholder="Name" required>@(itemD7C.FirstOrDefault().Resp5)</textarea></td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_5" name="D7C_ReviewCompletionDatePlanValue_5" required value="@(itemD7C.FirstOrDefault().PlanDate5==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().PlanDate5).ToString("yyyy-MM-dd"))" />


                                                </td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_5" name="D7C_ReviewCompletionDateActualValue_5" required value="@(itemD7C.FirstOrDefault().ActualDate5==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().ActualDate5).ToString("yyyy-MM-dd"))" />


                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    6
                                                </td>
                                                <td>
                                                    Work Instructions
                                                </td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Description_6" name="D7C_Description_6" required placeholder="Revision description">@(itemD7C.FirstOrDefault().NatureOfRevisionNo6)</textarea></td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_6" name="D7C_Resp_6" required placeholder="Name">@(itemD7C.FirstOrDefault().Resp6)</textarea></td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_6" name="D7C_ReviewCompletionDatePlanValue_6" required value="@(itemD7C.FirstOrDefault().PlanDate6==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().PlanDate6).ToString("yyyy-MM-dd"))" />


                                                </td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_6" name="D7C_ReviewCompletionDateActualValue_6" required value="@(itemD7C.FirstOrDefault().ActualDate6==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().ActualDate6).ToString("yyyy-MM-dd"))" />


                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    7
                                                </td>
                                                <td>
                                                    Inspection standard - Receiving
                                                </td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Description_7" name="D7C_Description_7" required placeholder="Revision description">@(itemD7C.FirstOrDefault().NatureOfRevisionNo7)</textarea></td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_7" name="D7C_Resp_7" required placeholder="Name">@(itemD7C.FirstOrDefault().Resp7)</textarea></td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_7" name="D7C_ReviewCompletionDatePlanValue_7" required value="@(itemD7C.FirstOrDefault().PlanDate7==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().PlanDate7).ToString("yyyy-MM-dd"))" />


                                                </td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_7" name="D7C_ReviewCompletionDateActualValue_7" required value="@(itemD7C.FirstOrDefault().ActualDate7==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().ActualDate7).ToString("yyyy-MM-dd"))" />


                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    8
                                                </td>
                                                <td>
                                                    Inspection standard - Shipping
                                                </td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Description_8" name="D7C_Description_8" required placeholder="Revision description">@(itemD7C.FirstOrDefault().NatureOfRevisionNo8)</textarea></td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_8" name="D7C_Resp_8" required placeholder="Name">@(itemD7C.FirstOrDefault().Resp8)</textarea></td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_8" name="D7C_ReviewCompletionDatePlanValue_8" required value="@(itemD7C.FirstOrDefault().PlanDate8==null?null: Convert.ToDateTime(itemD7C.FirstOrDefault().PlanDate8).ToString("yyyy-MM-dd"))" />

                                                </td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_8" name="D7C_ReviewCompletionDateActualValue_8" required value="@(itemD7C.FirstOrDefault().ActualDate8==null?null: Convert.ToDateTime(itemD7C.FirstOrDefault().ActualDate8).ToString("yyyy-MM-dd"))" />


                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    9
                                                </td>
                                                <td>
                                                    PPAP resubmission
                                                </td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Description_9" name="D7C_Description_9" required placeholder="Revision description">@(itemD7C.FirstOrDefault().NatureOfRevisionNo9)</textarea></td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_9" name="D7C_Resp_9" required placeholder="Name">@(itemD7C.FirstOrDefault().Resp9)</textarea></td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_9" name="D7C_ReviewCompletionDatePlanValue_9" required value="@(itemD7C.FirstOrDefault().PlanDate9==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().PlanDate9).ToString("yyyy-MM-dd"))" />


                                                </td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_9" name="D7C_ReviewCompletionDateActualValue_9" required value="@(itemD7C.FirstOrDefault().ActualDate9==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().ActualDate9).ToString("yyyy-MM-dd"))" />


                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    10
                                                </td>
                                                <td>
                                                    Process Change Request
                                                </td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Description_10" name="D7C_Description_10" required placeholder="Revision description">@(itemD7C.FirstOrDefault().NatureOfRevisionNo10)</textarea></td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_10" name="D7C_Resp_10" required placeholder="Name">@(itemD7C.FirstOrDefault().Resp10)</textarea></td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_10" name="D7C_ReviewCompletionDatePlanValue_10" required value="@(itemD7C.FirstOrDefault().PlanDate10==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().PlanDate10).ToString("yyyy-MM-dd"))" />


                                                </td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_10" name="D7C_ReviewCompletionDateActualValue_10" required value="@(itemD7C.FirstOrDefault().ActualDate10==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().ActualDate10).ToString("yyyy-MM-dd"))" />

                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    11
                                                </td>
                                                <td>
                                                    Engineering Change Request
                                                </td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Description_11" name="D7C_Description_11" required placeholder="Revision description">@(itemD7C.FirstOrDefault().NatureOfRevisionNo11)</textarea></td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_11" name="D7C_Resp_11" required placeholder="Name">@(itemD7C.FirstOrDefault().Resp11)</textarea></td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_11" name="D7C_ReviewCompletionDatePlanValue_11" required value="@(itemD7C.FirstOrDefault().PlanDate11==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().PlanDate11).ToString("yyyy-MM-dd"))" />


                                                </td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_11" name="D7C_ReviewCompletionDateActualValue_11" required value="@(itemD7C.FirstOrDefault().ActualDate11==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().ActualDate11).ToString("yyyy-MM-dd"))" />


                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    12
                                                </td>
                                                <td>
                                                    Change Authorization
                                                </td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Description_12" name="D7C_Description_12" required placeholder="Revision description">@(itemD7C.FirstOrDefault().NatureOfRevisionNo12)</textarea></td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_12" name="D7C_Resp_12" required placeholder="Name">@(itemD7C.FirstOrDefault().Resp12)</textarea></td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_12" name="D7C_ReviewCompletionDatePlanValue_12" required value="@(itemD7C.FirstOrDefault().PlanDate12==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().PlanDate12).ToString("yyyy-MM-dd"))" />


                                                </td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_12" name="D7C_ReviewCompletionDateActualValue_12" required value="@(itemD7C.FirstOrDefault().ActualDate12==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().ActualDate12).ToString("yyyy-MM-dd"))" />

                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    13
                                                </td>
                                                <td>
                                                    Other
                                                </td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Description_13" name="D7C_Description_13" required placeholder="Revision description">@(itemD7C.FirstOrDefault().NatureOfRevisionNo13)</textarea></td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_13" name="D7C_Resp_13" required placeholder="Name">@(itemD7C.FirstOrDefault().Resp13)</textarea></td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_13" name="D7C_ReviewCompletionDatePlanValue_13" required value="@(itemD7C.FirstOrDefault().PlanDate13==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().PlanDate13).ToString("yyyy-MM-dd"))" />


                                                </td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_13" name="D7C_ReviewCompletionDateActualValue_13" required value="@(itemD7C.FirstOrDefault().ActualDate13==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().ActualDate13).ToString("yyyy-MM-dd"))" />
                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    14
                                                </td>
                                                <td>
                                                    Relevant QMS practices
                                                </td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Description_14" name="D7C_Description_14" required placeholder="Revision description">@(itemD7C.FirstOrDefault().NatureOfRevisionNo14)</textarea></td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_14" name="D7C_Resp_14" required placeholder="Name">@(itemD7C.FirstOrDefault().Resp14)</textarea></td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_14" name="D7C_ReviewCompletionDatePlanValue_14" required value="@(itemD7C.FirstOrDefault().PlanDate14==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().PlanDate14).ToString("yyyy-MM-dd"))" />


                                                </td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_14" name="D7C_ReviewCompletionDateActualValue_14" required value="@(itemD7C.FirstOrDefault().ActualDate14==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().ActualDate14).ToString("yyyy-MM-dd"))" />


                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    15
                                                </td>
                                                <td>
                                                    Read across action taken
                                                </td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Description_15" name="D7C_Description_15" required placeholder="Revision description">@(itemD7C.FirstOrDefault().NatureOfRevisionNo15)</textarea></td>
                                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_15" name="D7C_Resp_15" required placeholder="Name">@(itemD7C.FirstOrDefault().Resp15)</textarea></td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_15" name="D7C_ReviewCompletionDatePlanValue_15" required value="@(itemD7C.FirstOrDefault().PlanDate15==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().PlanDate15).ToString("yyyy-MM-dd"))" />


                                                </td>
                                                <td>
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_15" name="D7C_ReviewCompletionDateActualValue_15" required value="@(itemD7C.FirstOrDefault().ActualDate15==null?null:Convert.ToDateTime(itemD7C.FirstOrDefault().ActualDate15).ToString("yyyy-MM-dd"))" />

                                                </td>

                                            </tr>
                                        }
                                        else
                                        {
                                            <tr>
                                                <td>
                                                    1
                                                </td>
                                                <td>
                                                    Quality awareness communication
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_1" name="D7C_Description_1" required placeholder="Revision description"></textarea></td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_1" name="D7C_Resp_1" required placeholder="Name"></textarea></td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_1" name="D7C_ReviewCompletionDatePlanValue_1" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_1" name="D7C_ReviewCompletionDateActualValue_1" required />
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    2
                                                </td>
                                                <td>
                                                    Design FMEA
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_2" name="D7C_Description_2" required placeholder="Revision description"></textarea></td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_2" name="D7C_Resp_2" required placeholder="Name"></textarea></td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_2" name="D7C_ReviewCompletionDatePlanValue_2" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_2" name="D7C_ReviewCompletionDateActualValue_2" required />
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    3
                                                </td>
                                                <td>
                                                    Process Flow Chart
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_3" name="D7C_Description_3" required placeholder="Revision description"></textarea></td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_3" name="D7C_Resp_3" required placeholder="Name"></textarea></td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_3" name="D7C_ReviewCompletionDatePlanValue_3" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_3" name="D7C_ReviewCompletionDateActualValue_3" required />
                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    4
                                                </td>
                                                <td>
                                                    Process FMEA
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_4" name="D7C_Description_4" required placeholder="Revision description"></textarea></td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_4" name="D7C_Resp_4" required placeholder="Name"></textarea></td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_4" name="D7C_ReviewCompletionDatePlanValue_4" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_4" name="D7C_ReviewCompletionDateActualValue_4" required />
                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    5
                                                </td>
                                                <td>
                                                    Process Control Plan
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_5" name="D7C_Description_5" required placeholder="Revision description"></textarea></td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_5" name="D7C_Resp_5" required placeholder="Name"></textarea></td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_5" name="D7C_ReviewCompletionDatePlanValue_5" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_5" name="D7C_ReviewCompletionDateActualValue_5" required />
                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    6
                                                </td>
                                                <td>
                                                    Work Instructions
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_6" name="D7C_Description_6" required placeholder="Revision description"></textarea></td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_6" name="D7C_Resp_6" required placeholder="Name"></textarea></td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_6" name="D7C_ReviewCompletionDatePlanValue_6" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_6" name="D7C_ReviewCompletionDateActualValue_6" required />
                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    7
                                                </td>
                                                <td>
                                                    Inspection standard - Receiving
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_7" name="D7C_Description_7" required placeholder="Revision description"></textarea></td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_7" name="D7C_Resp_7" required placeholder="Name"></textarea></td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_7" name="D7C_ReviewCompletionDatePlanValue_7" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_7" name="D7C_ReviewCompletionDateActualValue_7" required />
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    8
                                                </td>
                                                <td>
                                                    Inspection standard - Shipping
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_8" name="D7C_Description_8" required placeholder="Revision description"></textarea></td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_8" name="D7C_Resp_8" required placeholder="Name"></textarea></td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_8" name="D7C_ReviewCompletionDatePlanValue_8" required />

                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_8" name="D7C_ReviewCompletionDateActualValue_8" required />


                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    9
                                                </td>
                                                <td>
                                                    PPAP resubmission
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_9" name="D7C_Description_9" required placeholder="Revision description"></textarea></td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_9" name="D7C_Resp_9" required placeholder="Name"></textarea></td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_9" name="D7C_ReviewCompletionDatePlanValue_9" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_9" name="D7C_ReviewCompletionDateActualValue_9" required />
                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    10
                                                </td>
                                                <td>
                                                    Process Change Request
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_10" name="D7C_Description_10" required placeholder="Revision description"></textarea></td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_10" name="D7C_Resp_10" required placeholder="Name"></textarea></td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_10" name="D7C_ReviewCompletionDatePlanValue_10" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_10" name="D7C_ReviewCompletionDateActualValue_10" required />

                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    11
                                                </td>
                                                <td>
                                                    Engineering Change Request
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_11" name="D7C_Description_11" required placeholder="Revision description"></textarea></td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_11" name="D7C_Resp_11" required placeholder="Name"></textarea></td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_11" name="D7C_ReviewCompletionDatePlanValue_11" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_11" name="D7C_ReviewCompletionDateActualValue_11" required />

                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    12
                                                </td>
                                                <td>
                                                    Change Authorization
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_12" name="D7C_Description_12" required placeholder="Revision description"></textarea></td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_12" name="D7C_Resp_12" required placeholder="Name"></textarea></td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_12" name="D7C_ReviewCompletionDatePlanValue_12" required />


                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_12" />

                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    13
                                                </td>
                                                <td>
                                                    Other
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_13" name="D7C_Description_13" required placeholder="Revision description"></textarea></td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_13" name="D7C_Resp_13" required placeholder="Name"></textarea></td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_13" name="D7C_ReviewCompletionDatePlanValue_13" required />


                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_13" name="D7C_ReviewCompletionDateActualValue_13" required />
                                                </td>

                                            </tr>
                                            <tr>
                                                <td>
                                                    14
                                                </td>
                                                <td>
                                                    Relevant QMS practices
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_14" name="D7C_Description_14" required placeholder="Revision description"></textarea></td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_14" name="D7C_Resp_14" required placeholder="Name"></textarea></td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_14" name="D7C_ReviewCompletionDatePlanValue_14" required />

                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_14" name="D7C_ReviewCompletionDateActualValue_14" required />


                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    15
                                                </td>
                                                <td>
                                                    Read across action taken
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_15" name="D7C_Description_15" required placeholder="Revision description"></textarea></td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_15" name="D7C_Resp_15" required placeholder="Name"></textarea></td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_15" name="D7C_ReviewCompletionDatePlanValue_15" required />
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_15" name="D7C_ReviewCompletionDateActualValue_15" required />
                                                </td>

                                            </tr>
                                        }
                                    }
                                    else
                                    {
                                        <tr>
                                            <td>
                                                1
                                            </td>
                                            <td>
                                                Quality awareness communication
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_1" name="D7C_Description_1" required placeholder="Revision description"></textarea></td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_1" name="D7C_Resp_1" required placeholder="Name"></textarea></td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_1" name="D7C_ReviewCompletionDatePlanValue_1" required />
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_1" name="D7C_ReviewCompletionDateActualValue_1" required />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                2
                                            </td>
                                            <td>
                                                Design FMEA
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_2" name="D7C_Description_2" required placeholder="Revision description"></textarea></td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_2" name="D7C_Resp_2" required placeholder="Name"></textarea></td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_2" name="D7C_ReviewCompletionDatePlanValue_2" required />
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_2" name="D7C_ReviewCompletionDateActualValue_2" required />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                3
                                            </td>
                                            <td>
                                                Process Flow Chart
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_3" name="D7C_Description_3" required placeholder="Revision description"></textarea></td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_3" name="D7C_Resp_3" required placeholder="Name"></textarea></td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_3" name="D7C_ReviewCompletionDatePlanValue_3" required />
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_3" name="D7C_ReviewCompletionDateActualValue_3" required />
                                            </td>

                                        </tr>
                                        <tr>
                                            <td>
                                                4
                                            </td>
                                            <td>
                                                Process FMEA
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_4" name="D7C_Description_4" required placeholder="Revision description"></textarea></td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_4" name="D7C_Resp_4" required placeholder="Name"></textarea></td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_4" name="D7C_ReviewCompletionDatePlanValue_4" required />
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_4" name="D7C_ReviewCompletionDateActualValue_4" required />
                                            </td>

                                        </tr>
                                        <tr>
                                            <td>
                                                5
                                            </td>
                                            <td>
                                                Process Control Plan
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_5" name="D7C_Description_5" required placeholder="Revision description"></textarea></td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_5" name="D7C_Resp_5" required placeholder="Name"></textarea></td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_5" name="D7C_ReviewCompletionDatePlanValue_5" required />
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_5" name="D7C_ReviewCompletionDateActualValue_5" required />
                                            </td>

                                        </tr>
                                        <tr>
                                            <td>
                                                6
                                            </td>
                                            <td>
                                                Work Instructions
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_6" name="D7C_Description_6" required placeholder="Revision description"></textarea></td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_6" name="D7C_Resp_6" required placeholder="Name"></textarea></td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_6" name="D7C_ReviewCompletionDatePlanValue_6" required />
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_6" name="D7C_ReviewCompletionDateActualValue_6" required />
                                            </td>

                                        </tr>
                                        <tr>
                                            <td>
                                                7
                                            </td>
                                            <td>
                                                Inspection standard - Receiving
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_7" name="D7C_Description_7" required placeholder="Revision description"></textarea></td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_7" name="D7C_Resp_7" required placeholder="Name"></textarea></td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_7" name="D7C_ReviewCompletionDatePlanValue_7" required />
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_7" name="D7C_ReviewCompletionDateActualValue_7" required />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                8
                                            </td>
                                            <td>
                                                Inspection standard - Shipping
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_8" name="D7C_Description_8" required placeholder="Revision description"></textarea></td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_8" name="D7C_Resp_8" required placeholder="Name"></textarea></td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_8" name="D7C_ReviewCompletionDatePlanValue_8" required />

                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_8" name="D7C_ReviewCompletionDateActualValue_8" required />


                                            </td>

                                        </tr>
                                        <tr>
                                            <td>
                                                9
                                            </td>
                                            <td>
                                                PPAP resubmission
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_9" name="D7C_Description_9" required placeholder="Revision description"></textarea></td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_9" name="D7C_Resp_9" required placeholder="Name"></textarea></td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_9" name="D7C_ReviewCompletionDatePlanValue_9" required />
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_9" name="D7C_ReviewCompletionDateActualValue_9" required />
                                            </td>

                                        </tr>
                                        <tr>
                                            <td>
                                                10
                                            </td>
                                            <td>
                                                Process Change Request
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_10" name="D7C_Description_10" required placeholder="Revision description"></textarea></td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_10" name="D7C_Resp_10" required placeholder="Name"></textarea></td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_10" name="D7C_ReviewCompletionDatePlanValue_10" required />
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_10" name="D7C_ReviewCompletionDateActualValue_10" required />

                                            </td>

                                        </tr>
                                        <tr>
                                            <td>
                                                11
                                            </td>
                                            <td>
                                                Engineering Change Request
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_11" name="D7C_Description_11" required placeholder="Revision description"></textarea></td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_11" name="D7C_Resp_11" required placeholder="Name"></textarea></td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_11" name="D7C_ReviewCompletionDatePlanValue_11" required />

                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_11" name="D7C_ReviewCompletionDateActualValue_11" required />

                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                12
                                            </td>
                                            <td>
                                                Change Authorization
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_12" name="D7C_Description_12" required placeholder="Revision description"></textarea></td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_12" name="D7C_Resp_12" required placeholder="Name"></textarea></td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_12" name="D7C_ReviewCompletionDatePlanValue_12" required />
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_12" required />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                13
                                            </td>
                                            <td>
                                                Other
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_13" name="D7C_Description_13" required placeholder="Revision description"></textarea></td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_13" name="D7C_Resp_13" required placeholder="Name"></textarea></td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_13" name="D7C_ReviewCompletionDatePlanValue_13" required />
                                            </td>
                                            <td>
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_13" name="D7C_ReviewCompletionDateActualValue_13" required />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                14
                                            </td>
                                            <td>
                                                Relevant QMS practices
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_14" name="D7C_Description_14" required placeholder="Revision description"></textarea></td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_14" name="D7C_Resp_14" required placeholder="Name"></textarea></td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_14" name="D7C_ReviewCompletionDatePlanValue_14" required />
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_14" name="D7C_ReviewCompletionDateActualValue_14" required />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                15
                                            </td>
                                            <td>
                                                Read across action taken
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Description_15" name="D7C_Description_15" required placeholder="Revision description"></textarea></td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" id="D7C_Resp_15" name="D7C_Resp_15" required placeholder="Name"></textarea></td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_15" name="D7C_ReviewCompletionDatePlanValue_15" required />
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_15" name="D7C_ReviewCompletionDateActualValue_15" required />
                                            </td>

                                        </tr>
                                    }

                                </tbody>
                            </table>
                        </div>
                    }
                    <p style="margin-bottom:5px;">Attachments</p>
                    <div class="row">
                        <input type="file" multiple id="D7_Attachments" name="d7_attachments" />
                    </div>
                    @{
                        var d7 = 1;
                        var D7_Attachments = itemD7.Where(w => w.ReportHeaderId == Model.Id).FirstOrDefault();
                        foreach (var file in D7_Attachments.D7_Attachments)
                        {
                            <div class="row">
                                <a asp-controller="Home" asp-action="Viewfile_D7Attachments" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id'>@(d7++). @file.ContentName</a>
                                <a asp-controller="Home" asp-action="DeleteFile_D7Attachments" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id' style="padding-left:10px;color:red;" class="@(User.IsInRole("Admin")?"":"d-none")"><i class="fa fa-trash-alt"></i>Delete</a>
                            </div>
                        }
                    }
                </div>
            </div>
        </div>
    }

</div>
<div class="row ">
    @{
        var itemD8 = Model.D8s;
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title mr-1 text-bold" style="align-self:center;">D8: </h3><h3 class="card-title">Define and plan preventive action | </h3> <small> Modify systems to Prevent Recurrence of this and similar problems. Recommend systemic improvements</small>
                    <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                            <i class="fas fa-minus"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <table class="table table-sm table-bordered table-striped table-valign-middle table-bordered">
                                <thead>
                                    <tr>
                                        <th><strong>8A</strong></th>
                                        <th colspan="3">Follow-up Meeting</th>

                                    </tr>
                                    <tr>
                                        <th>No</th>
                                        <th>Planed Date</th>
                                        <th>Actual Date </th>
                                        <th class="text-center">Add/Edit</th>
                                    </tr>
                                </thead>
                                <tbody id="actionTaskBody_D8A">
                                    @if (itemD8.Count != 0)
                                    {
                                        var _itemD8A = itemD8.FirstOrDefault().D8_As;
                                        int rowD8A = 1;
                                        if (_itemD8A.Count != 0)
                                        {
                                            @foreach (var itemD8A in _itemD8A)
                                            {
                                                <tr class="actionTask_D8A" id="actionTask_D8A_@rowD8A" data-id="@rowD8A">
                                                    <td>
                                                        @rowD8A
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D8_PlanDateValue_@rowD8A" value="@(itemD8A.PlanDate==null?null:Convert.ToDateTime(itemD8A.PlanDate).ToString("yyyy-MM-dd"))" />

                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D8_ActualDateValue_@rowD8A" value="@(itemD8A.ActualDate==null?null:Convert.ToDateTime(itemD8A.ActualDate).ToString("yyyy-MM-dd"))" />

                                                    </td>
                                                    <td class="text-center">
                                                        @if (rowD8A == 1)
                                                        {
                                                            <a href="javascript:void(0)" id="addAction_D8A">
                                                                <i class="fas fa-plus text-success"></i>
                                                            </a>
                                                        }
                                                        else
                                                        {
                                                            <a href="javascript:void(0)" class="removeAction_D8A" data-id="@rowD8A">
                                                                <i class="fas fa-minus text-danger"></i>
                                                            </a>

                                                        }

                                                    </td>
                                                </tr>
                                                rowD8A++;
                                            }



                                        }
                                        else
                                        {
                                            <tr class="actionTask_D8A" id="actionTask_D8A_1" data-id="1">
                                                <td>
                                                    1
                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D8_PlanDateValue_1" name="D8_PlanDateValue_1" required />

                                                </td>
                                                <td class="form-group">
                                                    <input type="date" class="form-control form-control-sm" id="D8_ActualDateValue_1" name="D8_ActualDateValue_1" required />
                                                </td>
                                                <td class="text-center">
                                                    <a href="javascript:void(0)" id="addAction_D8A">
                                                        <i class="fas fa-plus text-success"></i>
                                                    </a>
                                                </td>
                                            </tr>
                                        }

                                    }
                                    else
                                    {
                                        <tr class="actionTask_D8A" id="actionTask_D8A_1" data-id="1">
                                            <td>
                                                1
                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D8_PlanDateValue_1" name="D8_PlanDateValue_1" required />

                                            </td>
                                            <td class="form-group">
                                                <input type="date" class="form-control form-control-sm" id="D8_ActualDateValue_1" name="D8_ActualDateValue_1" required />


                                            </td>
                                            <td class="text-center">
                                                <a href="javascript:void(0)" id="addAction_D8A">
                                                    <i class="fas fa-plus text-success"></i>
                                                </a>
                                            </td>
                                        </tr>
                                    }

                                </tbody>
                            </table>
                        </div>
                    </div>
                    @{
                        //@((Model.WorkFlow.RefStatusId ==StatusId.WaitingApprove && Model.WorkFlow.ActionId.Contains(User.Identity.Name.Split('\\').Last())) || Model.WorkFlow.RefStatusId == StatusId.MgrApproved || Model.WorkFlow.RefStatusId == StatusId.Completed || Model.WorkFlow.RefStatusId == StatusId.Rejected ?"":"d-none")

                        <div class="row @(Model.WorkFlowId ==2?"d-none":"")">
                            <table class="table table-sm table-striped table-valign-middle table-bordered">
                                <thead>
                                    <tr>
                                        <th><strong>8B</strong></th>
                                        <th colspan="4">Closure &amp; Sign-off</th>

                                    </tr>
                                    <tr>
                                        <th>No</th>
                                        <th>Verification</th>
                                        <th>Title </th>
                                        <th>Signature </th>
                                        <th>Date</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @if (itemD8.Count != 0)
                                    {
                                        var itemD8B = itemD8.FirstOrDefault().D8_Bs;
                                        if (itemD8B.Count != 0)
                                        {
                                            <tr>
                                                <td>
                                                    1
                                                </td>
                                                <td>
                                                    Vendor management
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" rows="1" placeholder="Title" id="Title1" name="Title1" required>@(itemD8B.FirstOrDefault().Title1)</textarea></td>
                                                <td class="form-group">
                                                    <div class="col-sm-6">
                                                        <!-- radio -->
                                                        @if (itemD8B.Count == 0)
                                                        {
                                                            <div class="clearfix D8_B_ReviewGroup">
                                                                <div class="icheck-success d-inline">
                                                                    <input type="radio" id="D8_B_Approve" name="D8_B_Review" value="true" @(Model.WorkFlow.RefStatusId == StatusId.MgrApproved ? "checked" : "") required>
                                                                    <label for="D8_B_Approve">
                                                                        Approve
                                                                    </label>
                                                                </div>
                                                                <div class="icheck-danger d-inline">
                                                                    <input type="radio" id="D8_B_Disapprove" name="D8_B_Review" value="false" required>
                                                                    <label for="D8_B_Disapprove">
                                                                        Disapprove
                                                                    </label>
                                                                </div>
                                                            </div>
                                                        }
                                                        else
                                                        {
                                                            @if (itemD8B.FirstOrDefault().Signature1 == "" || itemD8B.FirstOrDefault().Signature1 == null)
                                                            {
                                                                <div class="form-group clearfix D8_B_ReviewGroup">
                                                                    <div class="icheck-success d-inline">
                                                                        <input type="radio" id="D8_B_Approve" name="D8_B_Review" value="true" required @(Model.WorkFlow.RefStatusId == StatusId.MgrApproved ? "checked" : "")>
                                                                        <label for="D8_B_Approve">
                                                                            Approve
                                                                        </label>
                                                                    </div>
                                                                    <div class="icheck-danger d-inline">
                                                                        <input type="radio" id="D8_B_Disapprove" name="D8_B_Review" required value="false">
                                                                        <label for="D8_B_Disapprove">
                                                                            Disapprove
                                                                        </label>
                                                                    </div>
                                                                </div>

                                                            }
                                                            else
                                                            {
                                                                @itemD8B.FirstOrDefault()?.Signature1
                                                            }

                                                        }


                                                    </div>

                                                </td>
                                                <td><span>@Convert.ToDateTime(itemD8B.FirstOrDefault()?.Date1).ToString("dd/MM/yyyy")</span></td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    2
                                                </td>
                                                <td>
                                                    Customer
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" rows="1" placeholder="Title" id="Title2" name="Title2" required>@(itemD8B.Count != 0 ? itemD8B.FirstOrDefault().Title2 : "")</textarea></td>
                                                <td class="form-group"><input class="form-control form-control-sm" id="Signature2" name="Signature2" placeholder="Signature" required value="@itemD8B.FirstOrDefault()?.Signature2" /></td>
                                                <td class="form-group"><span>@Convert.ToDateTime(itemD8B.FirstOrDefault()?.Date2).ToString("dd/MM/yyyy")</span></td>
                                            </tr>
                                        }
                                        else
                                        {
                                            <tr>
                                                <td>
                                                    1
                                                </td>
                                                <td>
                                                    Vendor management
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" rows="1" placeholder="Title" id="Title1" name="Title1" required></textarea></td>
                                                <td class="form-group">
                                                    <div class="col-sm-6">
                                                        <!-- radio -->
                                                        <div class="clearfix D8_B_ReviewGroup">
                                                            <div class="icheck-success d-inline">
                                                                <input type="radio" id="D8_B_Approve" name="D8_B_Review" value="true" required>
                                                                <label for="D8_B_Approve">
                                                                    Approve
                                                                </label>
                                                            </div>
                                                            <div class="icheck-danger d-inline">
                                                                <input type="radio" id="D8_B_Disapprove" name="D8_B_Review" value="false" required>
                                                                <label for="D8_B_Disapprove">
                                                                    Disapprove
                                                                </label>
                                                            </div>
                                                        </div>


                                                    </div>

                                                </td>
                                                <td></td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    2
                                                </td>
                                                <td>
                                                    Customer
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" rows="1" id="Title2" name="Title2" required placeholder="Title"></textarea></td>
                                                <td class="form-group"><input class="form-control form-control-sm" id="Signature2" name="Signature2" required placeholder="Signature" /></td>
                                                <td></td>
                                            </tr>
                                        }
                                    }
                                    else
                                    {
                                        <tr>
                                            <td>
                                                1
                                            </td>
                                            <td>
                                                Vendor management
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" rows="1" placeholder="Title" id="Title1" required name="Title1"></textarea></td>
                                            <td class="form-group">
                                                <div class="col-sm-6">
                                                    <!-- radio -->
                                                    <div class="clearfix D8_B_ReviewGroup">
                                                        <div class="icheck-success d-inline">
                                                            <input type="radio" id="D8_B_Approve" name="D8_B_Review" required value="true">
                                                            <label for="D8_B_Approve">
                                                                Approve
                                                            </label>
                                                        </div>
                                                        <div class="icheck-danger d-inline">
                                                            <input type="radio" id="D8_B_Disapprove" name="D8_B_Review" required value="false">
                                                            <label for="D8_B_Disapprove">
                                                                Disapprove
                                                            </label>
                                                        </div>
                                                    </div>


                                                </div>

                                            </td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td>
                                                2
                                            </td>
                                            <td>
                                                Customer
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" rows="1" placeholder="Title" required id="Title2" name="Title2"></textarea></td>
                                            <td class="form-group"><input class="form-control form-control-sm" id="Signature2" name="Signature2" required placeholder="Signature" /></td>
                                            <td></td>
                                        </tr>
                                    }

                                </tbody>
                            </table>
                        </div>
                    }
                    @{
                        if (itemD8.Count != 0)
                        {
                            var itemD8C = itemD8.FirstOrDefault().D8_Cs;
                            if (itemD8C.Count != 0)
                            {
                                <div class="row @(Model.WorkFlowId ==2 || Model.WorkFlowId ==3?"d-none":"")">
                                    <table class="table table-sm table-striped table-valign-middle table-bordered">
                                        <thead>
                                            <tr>
                                                <th><strong>8C</strong></th>
                                                <th colspan="2">Closure &amp; Sign-off</th>

                                            </tr>
                                            <tr>
                                                <th>When</th>
                                                <th>Where</th>
                                                <th>How </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td class="form-group">
                                                    <input class="form-control form-control-sm" placeholder="When" id="D8C_When" name="D8C_When" required value="@(itemD8C.Count != 0 ? itemD8C.FirstOrDefault().When : "")" />
                                                </td>
                                                <td class="form-group">
                                                    <textarea class="form-control form-control-sm" rows="1" id="D8C_Description" name="D8C_Description" required placeholder="Description">@(itemD8C.Count != 0 ? itemD8C.FirstOrDefault().Where : "")</textarea>
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" id="D8C_How" name="D8C_How" rows="1" required placeholder="How">@(itemD8C.Count != 0 ? itemD8C.FirstOrDefault().How : "")</textarea></td>

                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            }
                            else
                            {
                                <div class="row @(Model.WorkFlowId ==2|| Model.WorkFlowId ==3?"d-none":"")">
                                    <table class="table table-sm table-striped table-valign-middle table-bordered">
                                        <thead>
                                            <tr>
                                                <th><strong>8C</strong></th>
                                                <th colspan="2">Closure &amp; Sign-off</th>

                                            </tr>
                                            <tr>
                                                <th>When</th>
                                                <th>Where</th>
                                                <th>How </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td class="form-group">
                                                    <input class="form-control form-control-sm" placeholder="When" id="D8C_When" name="D8C_When" required />
                                                </td>
                                                <td class="form-group">
                                                    <textarea class="form-control form-control-sm" rows="1" placeholder="Description" id="D8C_Description" name="D8C_Description" required></textarea>
                                                </td>
                                                <td class="form-group"><textarea class="form-control form-control-sm" rows="1" placeholder="How" id="D8C_How" name="D8C_How" required></textarea></td>

                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            }

                        }
                        else
                        {
                            <div class="row @(Model.WorkFlowId ==2|| Model.WorkFlowId ==3?"d-none":"")">
                                <table class="table table-sm table-striped table-valign-middle table-bordered">
                                    <thead>
                                        <tr>
                                            <th><strong>8C</strong></th>
                                            <th colspan="2">Closure &amp; Sign-off</th>

                                        </tr>
                                        <tr>
                                            <th>When</th>
                                            <th>Where</th>
                                            <th>How </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="form-group">
                                                <input class="form-control form-control-sm" placeholder="When" id="D8C_When" name="D8C_When" required />
                                            </td>
                                            <td class="form-group">
                                                <textarea class="form-control form-control-sm" rows="1" placeholder="Description" id="D8C_Description" name="D8C_Description" required></textarea>
                                            </td>
                                            <td class="form-group"><textarea class="form-control form-control-sm" rows="1" placeholder="How" id="D8C_How" name="D8C_How" required></textarea></td>

                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        }

                    }


                    <p style="margin-bottom:5px;">Attachments</p>
                    <div class="row">
                        <input type="file" multiple id="D8_Attachments" name="d8_attachments" />

                    </div>
                    @{
                        var d8 = 1;
                        var D8_Attachments = itemD8.Where(w => w.ReportHeaderId == Model.Id).FirstOrDefault();
                        foreach (var file in D8_Attachments.D8_Attachments)
                        {
                            <div class="row">
                                <a asp-controller="Home" asp-action="Viewfile_D8Attachments" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id'>@(d8++). @file.ContentName</a>
                                <a asp-controller="Home" asp-action="DeleteFile_D8Attachments" asp-route-reportId='@Model.Id' asp-route-fileid='@file.Id' style="padding-left:10px;color:red;" class="@(User.IsInRole("Admin")?"":"d-none")"><i class="fa fa-trash-alt"></i>Delete</a>
                            </div>
                        }
                    }
                </div>
            </div>
        </div>
    }

</div>
@section Scripts {
    <script type="text/javascript">
        //$(function () {
        $(document).ready(function () {
            $(document).on('click', '[data-toggle="lightbox"]', function (event) {
                event.preventDefault();
                $(this).ekkoLightbox({
                    alwaysShowClose: true
                });
            });

            $.validator.setDefaults({
                submitHandler: function () {
                    alert("Form successful submitted!");
                }
            });
            $('#D2_NonConformAttachments').on('change', function () {
                const fSize = this.files[0].size/1024/1024;
                var fExt = this.files[0].type;

                if ((fExt === "image/png" || fExt === "image/jpeg") && fSize <= 20) {

                } else {
                    alert("Upload file extensions .jpg and .png. File size not over: 20 MB");
                    $('#D2_NonConformAttachments').val("");
                }

            });
            $('#D2_ConformAttachments').on('change', function () {
                const fSize = this.files[0].size/1024/1024;
                var fExt = this.files[0].type;

                if ((fExt === "image/png" || fExt === "image/jpeg") && fSize <= 20) {

                } else {
                    alert("Upload file extensions .jpg and .png. File size not over: 20 MB");
                    $('#D2_ConformAttachments').val("");
                }

            });
            $('#reportForm').validate({
                rules: {
                    "D2_NonConformAttachments[]": {
                        extension: "jpg|jpeg",
                        size: 20971520
                    },
                    "D2_ConformAttachments[]": {
                        extension: "jpg|jpeg",
                        size: 20971520
                    }
                },

                errorElement: 'span',
                errorPlacement: function (error, element) {
                    error.addClass('invalid-feedback');
                    element.closest('.form-group').append(error);
                },
                highlight: function (element, errorClass, validClass) {
                    $(element).addClass('is-invalid');
                },
                unhighlight: function (element, errorClass, validClass) {
                    $(element).removeClass('is-invalid');
                }
            });

            $('[data-mask]').inputmask();
            $('.select2bs4').select2({
                theme: 'bootstrap4'
            });
            $('.select2').select2();
            //D0
            $("#addAction").click(function (e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask").length + 1;

                var str = `
                     <tr class="actionTask" id="actionTask_${row}" data-id="${row}">
                                        <td class="form-group">
                                            <textarea class="form-control form-control-sm" id="D0_Action_${row}" name="D0_Action_${row}" rows="1" required></textarea>
                                        </td>
                                        <td class="form-group" style="width:300px;">
                                            <select class="form-control form-control-sm select2" id="D0_TeamMember_${row}" name="D0_TeamMember_${row}" required style="width: 100%;" data-id="${row}">
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                 {
                                                    <text>
                str += `
                                                            <option value='@e.EmpId'
                                                                data-domainid='@e.EmpDomainId'
                                                                data-name='@e.EmpFullnameEN'
                                                                data-email='@e.EmpEmail'
                                                                data-position='@e.EmpPositionName'
                                                                data-section='@e.EmpSectionName'
                                                                data-department='@e.EmpDepartmentName'>
                                                                ` + `@e.EmpFullnameEN` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                str += ` </select>
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm inputdate" id="D0_DateStart_${row}" name="D0_DateStart_${row}" required  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D0_Metric_${row}" name="D0_Metric_${row}" required  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D0_Eff_${row}" name="D0_Eff_${row}" required />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="text" class="form-control form-control-sm" id="D0_PartId_${row}" name="D0_PartId_${row}" required  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D0_DateFinish_${row}" name="D0_DateFinish_${row}" required  />
                                                    </td>
                                                    <td class="text-center">
                                                        <a href="javascript:void(0)" class="removeAction" data-id="${row}">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>
                                                    </td>
                                                </tr>
                                            `;

                $("#actionTaskBody").append(str);

                $(`.removeAction`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_${row}`).remove();
                });
                $('.select2').select2();
            });

            //D1
            $("#addAction_D1").click(function (e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask_D1").length + 1;

                var str = `
                     <tr class="actionTask_D1" id="actionTask_D1_${row}" data-id="${row}">

                                        <td class="form-group" >
                                            <select class="form-control form-control-sm" id="D1_Function_${row}" name="D1_Function_${row}" style="width: 100%;" data-id="${row}" required>
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var v in verifyRef.RefFunctions.Where(w => w.Active).OrderBy(o => o.Description))
                                                 {
                                                    <text>
                str += `
                                                            <option value='@v.Id' >
                                                                ` + `@v.Description` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                str += ` </select>
                                          </td>
                                          <td class="form-group" style="width:400px;">
                                             <select class="form-control form-control-sm select2" id="D1_TeamMember_${row}" name="D1_TeamMember_${row}" style="width: 100%;" data-id="${row}" required>
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                 {
                                                    <text>
                str += `
                                                            <option value='@e.EmpId'
                                                                data-domainid='@e.EmpDomainId'
                                                                data-name='@e.EmpFullnameEN'
                                                                data-email='@e.EmpEmail'
                                                                data-position='@e.EmpPositionName'
                                                                data-section='@e.EmpSectionName'
                                                                data-department='@e.EmpDepartmentName'>
                                                                ` + `@e.EmpFullnameEN` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                str += ` </select>
                                                    </td>

                                                   <td class="form-group" style="width:400px;">
                                             <select class="form-control form-control-sm select2" id="D1_EmailTeamMember_${row}" name="D1_EmailTeamMember_${row}" style="width: 100%;" data-id="${row}" required>
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                 {
                                                    <text>
                str += `
                                                            <option value='@e.EmpId'
                                                                data-domainid='@e.EmpDomainId'
                                                                data-name='@e.EmpFullnameEN'
                                                                data-email='@e.EmpEmail'
                                                                data-position='@e.EmpPositionName'
                                                                data-section='@e.EmpSectionName'
                                                                data-department='@e.EmpDepartmentName'>
                                                                ` + `@e.EmpEmail` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                str += ` </select>
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D1_DateStartValue_${row}" name="D1_DateStartValue_${row}" required  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="text" class="form-control form-control-sm" id="D1_PhoneNo_${row}" name="D1_PhoneNo_${row}" data-inputmask="'mask': ['999-999-9999 [x99999]', '+099 99 99 9999[9]-9999']" data-mask required />
                                                    </td>
                                                    <td class="text-center">
                                                        <a href="javascript:void(0)" class="removeAction_D1" data-id="${row}">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>
                                                    </td>
                                                </tr>
                                            `;

                $("#actionTaskBody_D1").append(str);

                $(`.removeAction_D1`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_D1_${row}`).remove();
                });
                $('.select2').select2();
                $('[data-mask]').inputmask();
            });

            //D3
            $("#addAction_D3").click(function (e) {
                AddD3(e);
            });
             function AddD3(e) {
               e.stopImmediatePropagation();

                const row = $(".actionTask_D3").length + 1;

                var str = `
                     <tr class="actionTask_D3" id="actionTask_D3_${row}" data-id="${row}">
                                        <td class="form-group">
                                            <textarea class="form-control form-control-sm" id="D3_Action_${row}" name="D3_Action_${row}" rows="1" required></textarea>
                                        </td>
                                        <td class="form-group" style="width:300px;">
                                            <select class="form-control form-control-sm select2" id="D3_TeamMember_${row}" name="D3_TeamMember_${row}" style="width: 100%;" data-id="${row}" required>
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                 {
                                                    <text>
                str += `
                                                            <option value='@e.EmpId'
                                                                data-domainid='@e.EmpDomainId'
                                                                data-name='@e.EmpFullnameEN'
                                                                data-email='@e.EmpEmail'
                                                                data-position='@e.EmpPositionName'
                                                                data-section='@e.EmpSectionName'
                                                                data-department='@e.EmpDepartmentName'>
                                                                ` + `@e.EmpFullnameEN` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                str += ` </select>
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D3_DateStartValue_${row}" name="D3_DateStartValue_${row}" required />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D3_Metric_${row}" name="D3_Metric_${row}" required />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D3_Eff_${row}" name="D3_Eff_${row}" required  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="text" class="form-control form-control-sm" id="D3_PartId_${row}" name="D0_PartId_${row}" required />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D3_DateFinishValue_${row}" name="D3_DateFinishValue_${row}" required  />
                                                    </td>
                                                    <td class="text-center">
                                                        <a href="javascript:void(0)" class="removeAction_D3" data-id="${row}">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>
                                                    </td>
                                                </tr>
                                            `;

                $("#actionTaskBody_D3").append(str);

                $(`.removeAction_D3`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_D3_${row}`).remove();
                });
                $('.select2').select2();
            }
            //D4
            $("#addAction_D4").click(function (e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask_D4").length + 1;

                var str = `
                     <tr class="actionTask_D4" id="actionTask_D4_${row}" data-id="${row}">
                                        <td class="form-group" >
                                            <select class="form-control form-control-sm" id="D4_CauseSource_${row}" name="D4_CauseSource_${row}" style="width: 100%;" data-id="${row}" required>
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var c in verifyRef.RefCauseSources.Where(w => w.Active).OrderBy(o => o.Description))
                                                 {
                                                    <text>
                str += `
                                                            <option value='@c.Id' >
                                                                ` + `@c.Description` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                str += ` </select>
                                          </td>
                                                    <td class="form-group">
                                                        <textarea class="form-control form-control-sm" id="D4_CauseSourceDescription_${row}" name="D4_CauseSourceDescription_${row}" rows="1" required></textarea>
                                                    </td>
                                                    <td class="form-group text-center" >

                                                        <div class="icheck-success d-inline">
                                                            <input type="checkbox" id="D4_Verified_${row}" name="D4_Verified_${row}" required>
                                                            <label for="D4_Verified_${row}" class="font-weight-normal">

                                                            </label>
                                                        </div>
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D4_DateValue_${row}" name="D4_DateValue_${row}" required  />
                                                    </td>
                                                    <td class="form-group ">
                                                        <input type="text" class="form-control form-control-sm" id="D4_VerificationMethod_${row}" name="D4_VerificationMethod_${row}" required  />
                                                    </td>
                                                    <td class="text-center">
                                                        <a href="javascript:void(0)" class="removeAction_D4" data-id="${row}">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>
                                                    </td>
                                                </tr>
                                            `;

                $("#actionTaskBody_D4").append(str);

                $(`.removeAction_D4`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_D4_${row}`).remove();
                });
                $('.select2').select2();
            });

            //D5
            $("#addAction_D5").click(function (e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask_D5").length + 1;

                var str = `
                     <tr class="actionTask_D5" id="actionTask_D5_${row}" data-id="${row}">
<td class="form-group">
${row}
                                                    </td>
                                        <td class="form-group" >
                                            <select class="form-control form-control-sm" id="D5_CauseSource_${row}" name="D5_CauseSource_${row}" style="width: 100%;" data-id="${row}" required>
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var c in verifyRef.RefCauseSources.Where(w => w.Active).OrderBy(o => o.Description))
                                                 {
                                                    <text>
                str += `
                                                            <option value='@c.Id' >
                                                                ` + `@c.Description` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                str += ` </select>
                                          </td>
                                                    <td class="form-group">
                                                        <textarea class="form-control form-control-sm" id="D5_PermanentCorrectAction_${row}" name="D5_PermanentCorrectAction_${row}" rows="1" required></textarea>
                                                    </td>
                                                    <td class="form-group text-center" >
                                                        <div class="icheck-success d-inline">
                                                            <input type="checkbox" id="D5_Verified_${row}" name="D5_Verified_${row}" required>
                                                            <label for="D5_Verified_${row}" class="font-weight-normal">
                                                            </label>
                                                        </div>
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D5_DateValue_${row}" name="D5_DateValue_${row}"  required />
                                                    </td>
                                                    <td class="form-group ">
                                                        <input type="text" class="form-control form-control-sm" id="D5_VerificationMethod_${row}" name="D5_VerificationMethod_${row}" required  />
                                                    </td>
                                                    <td class="text-center">
                                                        <a href="javascript:void(0)" class="removeAction_D5" data-id="${row}">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>
                                                    </td>
                                                </tr>
                                            `;

                $("#actionTaskBody_D5").append(str);

                $(`.removeAction_D5`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_D5_${row}`).remove();
                });
                $('.select2').select2();
            });

            //D6
            $("#addAction_D6").click(function (e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask_D6").length + 1;

                var str = `
                     <tr class="actionTask_D6" id="actionTask_D6_${row}" data-id="${row}">
<td class="form-group">
${row}
                                                    </td>
                                                   <td class="form-group">
                                                        <textarea class="form-control form-control-sm" id="D6_PermenentCorrectiveAction_${row}" name="D6_PermenentCorrectiveAction_${row}" rows="1" required></textarea>
                                                    </td>
                                                    <td class="form-group" >
                                                       <textarea class="form-control form-control-sm" id="D6_ImplementationPlan_${row}" name="D6_ImplementationPlan_${row}" rows="1" required></textarea>

                                                    </td>
                                                    <td class="form-group" style="width:300px;">
                                            <select class="form-control form-control-sm select2" id="D6_TeamMember_${row}" name="D6_TeamMember_${row}" style="width: 100%;" data-id="${row}" required>
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                 {
                                                    <text>
                str += `
                                                            <option value='@e.EmpId'
                                                                data-domainid='@e.EmpDomainId'
                                                                data-name='@e.EmpFullnameEN'
                                                                data-email='@e.EmpEmail'
                                                                data-position='@e.EmpPositionName'
                                                                data-section='@e.EmpSectionName'
                                                                data-department='@e.EmpDepartmentName'>
                                                                ` + `@e.EmpFullnameEN` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                str += ` </select>
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D6_DateValue_${row}" name="D6_DateValue_${row}" required />
                                                    </td>
                                                    <td class="form-group ">
                                                       <div class="clearfix D6_CustomerConcurrenceGroup">
                                                            <div class="icheck-danger d-inline">
                                                                <input type="radio" id="D6_CustomerConcurrence_No_${row}" class="D6_CustomerConcurrenceCheck" name="D6_CustomerConcurrence_${row}" value="false" required>
                                                                <label for="D6_CustomerConcurrence_No_${row}">
                                                                    No
                                                                </label>
                                                            </div>
                                                            <div class="icheck-success d-inline">
                                                                <input type="radio" id="D6_CustomerConcurrence_Yes_${row}" class="D6_CustomerConcurrenceCheck" name="D6_CustomerConcurrence_${row}" value="true" required>
                                                                <label for="D6_CustomerConcurrence_Yes_${row}">
                                                                    Yes
                                                                </label>
                                                            </div>
                                                        </div>
                                                    </td>
                                            <td class="form-group" >
                                            <select class="form-control form-control-sm" id="D6_PCAStatus_${row}" name="D6_PCAStatus_${row}" style="width: 100%;" required data-id="${row}">
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var c in verifyRef.RefPCAStatuses.Where(w => w.Active).OrderBy(o => o.Name))
                                                 {
                                                    <text>
                str += `
                                                            <option value='@c.Id' >
                                                                ` + `@c.Name` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                str += ` </select>
                                          </td>
                                                    <td class="text-center">
                                                        <a href="javascript:void(0)" class="removeAction_D5" data-id="${row}">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>
                                                    </td>
                                                </tr>
                                            `;

                $("#actionTaskBody_D6").append(str);

                $(`.removeAction_D6`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_D6_${row}`).remove();
                });
                $('.select2').select2();
            });

            //D7A
            $("#addAction_D7A").click(function (e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask_D7A").length + 1;

                var str = `
                     <tr class="actionTask_D7A" id="actionTask_D7A_${row}" data-id="${row}">
                        <td class="form-group">
                            ${row}
                        </td>
                        <td class="form-group">
                             <textarea class="form-control form-control-sm" id="D7A_SelectedPreventiveAction_${row}" name="D7A_SelectedPreventiveAction_${row}" rows="1" required></textarea>
                         </td>
                         <td class="form-group" >
                            <textarea class="form-control form-control-sm" id="D7A_ImplementationPlan_${row}" name="D7A_ImplementationPlan_${row}" rows="1" required></textarea>

                         </td>
                         <td class="form-group" style="width:300px;">
                             <select class="form-control form-control-sm select2" id="D7A_TeamMember_${row}" name="D7A_TeamMember_${row}" style="width: 100%;" data-id="${row}" required>
                                   <option value="" selected disabled>--select--</option> `;
                      @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                      {
                         <text>
                str += `
                                 <option value='@e.EmpId'
                                     data-domainid='@e.EmpDomainId'
                                     data-name='@e.EmpFullnameEN'
                                     data-email='@e.EmpEmail'
                                     data-position='@e.EmpPositionName'
                                     data-section='@e.EmpSectionName'
                                     data-department='@e.EmpDepartmentName'>
                                     ` + `@e.EmpFullnameEN` + `
                                 </option>
                                                                 `;
                        </text>
                     }
                str += ` </select>
                         </td>
                         <td class="form-group">
                             <input type="date" class="form-control form-control-sm" id="D7A_TargetDateValue_${row}" name="D7A_TargetDateValue_${row}" required  />
                         </td>
                         <td class="form-group ">
                            <input type="date" class="form-control form-control-sm" id="D7A_ActualDate_${row}" name="D7A_ActualDate_${row}" required />
                         </td>
                 <td class="form-group" >
                 <select class="form-control form-control-sm" id="D7A_PCAStatus_${row}" name="D7A_PCAStatus_${row}" style="width: 100%;" data-id="${row}" required>
                     <option value="" selected disabled>--select--</option> `;
                      @foreach (var c in verifyRef.RefPCAStatuses.Where(w => w.Active).OrderBy(o => o.Name))
                      {
                         <text>
                str += `
                                 <option value='@c.Id' >
                                     ` + `@c.Name` + `
                                 </option>
                                                                 `;
                        </text>
                     }
                str += ` </select>
               </td>
                         <td class="text-center">
                             <a href="javascript:void(0)" class="removeAction_D7A" data-id="${row}">
                                 <i class="fas fa-minus text-danger"></i>
                             </a>
                         </td>
                     </tr>
                 `;

                $("#actionTaskBody_D7A").append(str);

                $(`.removeAction_D7A`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_D7A_${row}`).remove();
                });
                $('.select2').select2();
            });

            //D7B
            $("#addAction_D7B").click(function (e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask_D7B").length + 1;

                var str = `
                     <tr class="actionTask_D7B" id="actionTask_D7B_${row}" data-id="${row}">
                        <td class="form-group">
                            ${row}
                        </td>
                        <td class="form-group">
                             <textarea class="form-control form-control-sm" id="D7B_ProcessItem_${row}" name="D7B_ProcessItem_${row}" rows="1" required></textarea>
                         </td>
                         <td class="form-group" >
                            <textarea class="form-control form-control-sm" id="D7B_Responsible_${row}" name="D7B_Responsible_${row}" rows="1" required></textarea>

                         </td>
                         <td class="form-group">
                             <input type="date" class="form-control form-control-sm" id="D7B_PlanValidationDateValue_${row}" name="D7B_PlanValidationDateValue_${row}" required />
                         </td>
                         <td class="text-center">
                             <a href="javascript:void(0)" class="removeAction_D7B" data-id="${row}">
                                 <i class="fas fa-minus text-danger"></i>
                             </a>
                         </td>
                     </tr>
                 `;

                $("#actionTaskBody_D7B").append(str);

                $(`.removeAction_D7B`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_D7B_${row}`).remove();
                });
                $('.select2').select2();
            });

            //D8A
            $("#addAction_D8A").click(function (e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask_D8A").length + 1;

                var str = `
                     <tr class="actionTask_D8A" id="actionTask_D8A_${row}" data-id="${row}">
                        <td class="form-group">
                            ${row}
                        </td>
                        <td class="form-group">
                            <input type="date" class="form-control form-control-sm" id="D8_PlanDateValue_${row}" name="D8_PlanDateValue_${row}" required  />
                         </td>
                         <td class="form-group" >
                            <input type="date" class="form-control form-control-sm" id="D8_ActualDateValue_${row}" name="D8_ActualDateValue_${row}" required  />

                         </td>
                         <td class="text-center">
                             <a href="javascript:void(0)" class="removeAction_D8A" data-id="${row}">
                                 <i class="fas fa-minus text-danger"></i>
                             </a>
                         </td>
                     </tr>
                 `;

                $("#actionTaskBody_D8A").append(str);

                $(`.removeAction_D8A`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_D8A_${row}`).remove();
                });
                $('.select2').select2();
            });

            $(`.removeAction`).click(function (e) {
                e.stopImmediatePropagation();
                var getId = $(this).data("id");

                $(`#actionTask_${getId}`).remove();
            });
             $(`.removeAction_D1`).click(function (e) {
                e.stopImmediatePropagation();
                var getId = $(this).data("id");

                $(`#actionTask_D1_${getId}`).remove();
             });
            $(`.removeAction_D3`).click(function (e) {
                e.stopImmediatePropagation();
                var getId = $(this).data("id");

                $(`#actionTask_D3_${getId}`).remove();
            });
            $(`.removeAction_D4`).click(function (e) {
                e.stopImmediatePropagation();
                var getId = $(this).data("id");

                $(`#actionTask_D4_${getId}`).remove();
            });
            $(`.removeAction_D5`).click(function (e) {
                e.stopImmediatePropagation();
                var getId = $(this).data("id");

                $(`#actionTask_D5_${getId}`).remove();
            });
            $(`.removeAction_D6`).click(function (e) {
                e.stopImmediatePropagation();
                var getId = $(this).data("id");

                $(`#actionTask_D6_${getId}`).remove();
            });
            $(`.removeAction_D7A`).click(function (e) {
                e.stopImmediatePropagation();
                var getId = $(this).data("id");

                $(`#actionTask_D7A_${getId}`).remove();
            });
            $(`.removeAction_D7B`).click(function (e) {
                e.stopImmediatePropagation();
                var getId = $(this).data("id");

                $(`#actionTask_D7B_${getId}`).remove();
            });
          


            $(`.removeAction_D8A`).click(function (e) {
                e.stopImmediatePropagation();
                var getId = $(this).data("id");

                $(`#actionTask_D8A_${getId}`).remove();
            });
         

            const Toast = Swal.mixin({
                toast: true,
                position: "center",
                showConfirmButton: false,
                timer: 3000,
            });
            $("#btnSave").click((e) => {
                //alert($("#btnSave").val());

                $("#SubmitFormSpinn").removeClass("d-none");
                $("button[name=btnSave]").prop("disabled", true);
                $("button[name=btnSubmit]").prop("disabled", true);
                $("button[name=btnMgrSubmit]").prop("disabled", true);
                UpdateData(e,2,"save");

            });
            $("#btnSubmit").click((e) => {
                if ($("#reportForm").valid()) {
                    $("#SubmitFormSpinn").removeClass("d-none");
                    $("button[name=btnSave]").prop("disabled", true);
                    $("button[name=btnSubmit]").prop("disabled", true);
                    $("button[name=btnMgrSubmit]").prop("disabled", true);

                    UpdateData(e, 3,"");
                   // $("#btnSubmit").prop("disabled", true);
                  //  alert("CALL");
                }

               // UpdateData(e, 3);

            });
            $("#btnMgrSubmit").click((e) => {
                if ($("#reportForm").valid()) {
                    $("#SubmitFormSpinn").removeClass("d-none");
                    $("button[name=btnSave]").prop("disabled", true);
                    $("button[name=btnSubmit]").prop("disabled", true);
                    $("button[name=btnMgrSubmit]").prop("disabled", true);
                     $(`input[name='D8_B_Review']:checked`).each(function (i) {

                         if ($(this).val() == 'true') {
                             UpdateData(e, 6,"");

                         } else {
                             UpdateData(e, 2,"");
                         }
                });

                }

            });
            $("#btnComplete").click((e) => {
                if ($("#reportForm").valid()) {
                    $("#SubmitFormSpinn").removeClass("d-none");
                    $("button[name=btnSave]").prop("disabled", true);
                    $("button[name=btnSubmit]").prop("disabled", true);
                    $("button[name=btnMgrSubmit]").prop("disabled", true);
                    UpdateData(e, 4,"");
                }

            });
            function UpdateData(e,workFlowId,btnSave) {
                 e.stopImmediatePropagation();
                var data = new FormData();
                //HeaderReport
                data.append("btnSave", btnSave);

                data.append("NcrNo", $('#NcrNo').val());
                data.append("DateOpened", $('#HeaderDateOpened').val());
                data.append("DateTargetedClosure", $('#HeaderDateTargetedClosure').val());
                data.append("DateClosed", $('#HeaderDateClosed').val());
                data.append("DateClosureD0", $('#DateClosureD0').val());
                data.append("DateClosureD1", $('#DateClosureD1').val());
                data.append("DateClosureD2", $('#DateClosureD2').val());
                data.append("DateClosureD3", $('#DateClosureD3').val());
                data.append("DateClosureD4", $('#DateClosureD4').val());
                data.append("DateClosureD5", $('#DateClosureD5').val());
                data.append("DateClosureD6", $('#DateClosureD6').val());
                data.append("DateClosureD7", $('#DateClosureD7').val());
                data.append("DateClosureD8", $('#DateClosureD8').val());
                data.append("DateEffectivenessCheck", $('#DateEffectivenessCheck').val());
                data.append("WorkFlowId", workFlowId);

                //D0
                data.append(`D0s[0].D0_Comment`, $("#D0_Comment").val());
                data.append(`D0s[0].D0_PartNumber`, $("#D0_PartNumber").val());
                data.append(`D0s[0].D0_PartDescription`, $("#D0_PartNumber").val());
                data.append(`D0s[0].D0_PONum`, $("#D0_PartNumber").val());
                data.append(`D0s[0].D0_POItem`, $("#D0_POItem").val());
                data.append(`D0s[0].D0_CustomerContact`, $("#D0_CustomerContact").val());
                data.append(`D0s[0].D0_WitnessedBy`, $("#D0_WitnessedBy").val());
                data.append(`D0s[0].D0_AffectedCustomerProduct`, $("#D0_AffectedCustomerProduct").val());
                data.append(`D0s[0].D0_CustomerReference`, $("#D0_CustomerReference").val());


                $("input[name='D0_DeliveryAffected_1']:checked").each(function (index) {
                    data.append("D0s[0].D0_DeliveryAffected", $(this).val());

                });

                $("input[name='D0_SuspectRootCauseIdentified_1']:checked").each(function (index) {
                    data.append("D0s[0].D0_SuspectRootCauseIdentified", $(this).val());

                });

                $("input[name='D0_RootCauseVerified_1']:checked").each(function (index) {
                    data.append("D0s[0].D0_RootCauseVerified", $(this).val());

                });
                $("input[name='D0_EmergencyRespondAction_1']:checked").each(function (index) {
                    data.append("D0s[0].D0_EmergencyRespondAction", $(this).val());

                });
                $("input[name='D0_RecurringProblem_1']:checked").each(function (index) {
                    data.append("D0s[0].D0_RecurringProblem", $(this).val());

                });

                $(".actionTask").each(function (index)
                {
                    var thisId = $(this).data("id");
                    var member = $(`#D0_TeamMember_${thisId}`).find(":selected");

                    if ($(`#D0_Action_${thisId}`).val() != "") {
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].Action`, $(`#D0_Action_${thisId}`).val());
                    }
                    if (member.val() != "") {
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].TeamMemberId`, member.val());
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].TeamMemberEmail`, member.data("email"));
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].TeamMemberName`, member.data("name"));
                    }
                    if ($(`#D0_DateStart_${thisId}`).val() != "") {
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].DateStart`, $(`#D0_DateStart_${thisId}`).val());
                    }
                    if ($(`#D0_DateFinish_${thisId}`).val() != "") {
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].DateFinish`, $(`#D0_DateFinish_${thisId}`).val());
                    }
                    if ($(`#D0_Metric_${thisId}`).val() != "") {
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].Metric`, $(`#D0_Metric_${thisId}`).val());
                    }
                    if ($(`#D0_Eff_${thisId}`).val() != "") {
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].Eff`, $(`#D0_Eff_${thisId}`).val());
                    }
                    if ($(`#D0_PartId_${thisId}`).val() != "") {
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].PartId`, $(`#D0_PartId_${thisId}`).val());
                    }

                });

                var input = document.getElementById("D0_Attachments");
                if (typeof input != "undefined" && input != null) {
                    var files = input.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d0_attachments", files[i]);
                    }
                }
                //D1
                $(".actionTask_D1").each(function (index) {
                    var thisId = $(this).data("id");
                    var member = $(`#D1_TeamMember_${thisId}`).find(":selected");

                    if ($(`#D1_Function_${thisId}`).val() != null) {
                        data.append(`D1s[${index}].RefFunctionId`, $(`#D1_Function_${thisId}`).val());
                    }

                    if (member.val() != "") {
                        data.append(`D1s[${index}].D1_EmployeeId`, member.val());
                        data.append(`D1s[${index}].D1_EmployeeName`, member.data("name"));
                    }
                    if ($(`#D1_DateStartValue_${thisId}`).val() != "") {
                        data.append(`D1s[${index}].D1_DateStart`, $(`#D1_DateStartValue_${thisId}`).val());
                    }
                    if ($(`#D1_PhoneNo_${thisId}`).val() != "") {
                        data.append(`D1s[${index}].D1_PhoneNo`, $(`#D1_PhoneNo_${thisId}`).val());
                    }
                    //console.log($(`#D1_EmailTeamMember_${thisId}`).val());
                    if ($(`#D1_EmailTeamMember_${thisId}`).val() != null) {
                        data.append(`D1s[${index}].D1_Email`, $(`#D1_EmailTeamMember_${thisId}`).find(":selected").data("email"));
                    }

                });

                //D2
                data.append(`D2s[0].D2_DefineCustomerExperience`, $(`#D2_DefineCustomerExperience`).val());
                data.append(`D2s[0].D2_FailureMode`, $(`#D2_FailureMode`).val());
                data.append(`D2s[0].D2_RequiredByTheSpecification`, $(`#D2_RequiredByTheSpecification`).val());
                data.append(`D2s[0].D2_TheSpecificationDocument`, $(`#D2_TheSpecificationDocument`).val());
                data.append(`D2s[0].D2_ProblemSource`, $(`#D2_ProblemSource`).val());
                data.append(`D2s[0].D2_CustomerProblemTypeDefinition`, $(`#D2_CustomerProblemTypeDefinition`).val());
                data.append(`D2s[0].D2_NumberOfPartsProducedWithinProblemBoundary`, $(`#D2_NumberOfPartsProducedWithinProblemBoundary`).val());
                data.append(`D2s[0].D2_NumberOfPartsAffected`, $(`#D2_NumberOfPartsAffected`).val());


                $("input[name='D2_RecurringProblem_1']:checked").each(function (index) {
                    data.append("D2s[0].D2_RecurringProblem", $(this).val());

                });
                $("input[name='D2_FailureModeInDPFMEA_1']:checked").each(function (index) {
                    data.append("D2s[0].D2_FailureModeInDPFMEA", $(this).val());

                });
                var inputD2Recuring = document.getElementById("D2_AttachmentRecurrings");
                if (typeof inputD2Recuring != "undefined" && inputD2Recuring != null) {
                    var files = inputD2Recuring.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d2_attachmentRecurrings", files[i]);
                    }
                }
                var inputD2FMEA = document.getElementById("D2_AttachmentFailures");
                if (typeof inputD2FMEA != "undefined" && inputD2FMEA != null) {
                    var files = inputD2FMEA.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d2_attachmentFailures", files[i]);
                    }
                }
               

                var chkD2SupSupplier = $("#D2_SupSupplier").is(":checked");
                if (chkD2SupSupplier) {
                    data.append(`D2s[0].D2_SupSupplier`, chkD2SupSupplier);
                    data.append(`D2s[0].D2_SupSupplierDetail`, $("#D2_SupSupplierDetail").val());
                }
                else {
                    data.append(`D2s[0].D2_SupSupplier`, false);
                }

                var chkD2Organization = $("#D2_Organization").is(":checked");
                if (chkD2Organization) {
                    data.append(`D2s[0].D2_Organization`, chkD2Organization);
                    data.append(`D2s[0].D2_OrganizationDetail`, $("#D2_OrganizationDetail").val());
                }
                else {
                    data.append(`D2s[0].D2_Organization`, false);
                }

                var chkD2Customer = $("#D2_Customer").is(":checked");
                if (chkD2Customer) {
                    data.append(`D2s[0].D2_Customer`, chkD2Customer);
                    data.append(`D2s[0].D2_CustomerDetail`, $("#D2_CustomerDetail").val());
                }
                else {
                    data.append(`D2s[0].D2_Customer`, false);
                }

                var chkD2Other1 = $("#D2_Other1").is(":checked");
                if (chkD2Other1) {
                    data.append(`D2s[0].D2_Other1`,chkD2Other1);
                    data.append(`D2s[0].D2_Other1Detail`, $("#D2_Other1Detail").val());
                }
                else {
                    data.append(`D2s[0].D2_Other1`, false);
                }

                var chkD2CustomerOfCustomer = $("#D2_CustomerOfCustomer").is(":checked");
                if (chkD2CustomerOfCustomer) {
                    data.append(`D2s[0].D2_CustomerOfCustomer`, chkD2CustomerOfCustomer);
                    data.append(`D2s[0].D2_CustomerOfCustomerDetail`, $("#D2_CustomerOfCustomerDetail").val());}
                else {
                    data.append(`D2s[0].D2_CustomerOfCustomer`, false);
                }

                var chkD2AircraftOperators = $("#D2_AircraftOperators").is(":checked");
                if (chkD2AircraftOperators) {
                    data.append(`D2s[0].D2_AircraftOperators`, chkD2AircraftOperators);
                    data.append(`D2s[0].D2_AircraftOperatorsDetail`, $("#D2_AircraftOperatorsDetail").val());
                } else {
                    data.append(`D2s[0].D2_AircraftOperators`, false);

                }

                var chkD2SpareParts = $("#D2_SpareParts").is(":checked");
                if (chkD2SpareParts) {
                    data.append(`D2s[0].D2_SpareParts`, chkD2SpareParts);
                    data.append(`D2s[0].D2_SparePartsDetail`, $("#D2_SparePartsDetail").val());
                } else {
                    data.append(`D2s[0].D2_SpareParts`, false);

                }

                var chkD2Other2 = $("#D2_Other2").is(":checked");
                if (chkD2Other2) {
                    data.append(`D2s[0].D2_Other2`, chkD2Other2);
                    data.append(`D2s[0].D2_Other2Detail`, $("#D2_Other2Detail").val());
                } else {
                    data.append(`D2s[0].D2_Other2`, false);

                }

                data.append(`D2s[0].D2_ProblemPartEarliestKnownOccurrenceDate`, $("#D2_ProblemPartEarliestKnownOccurrenceDateValue").val());
                data.append(`D2s[0].D2_ProblemPartEarliestKnownAwarenessDate`, $("#D2_ProblemPartEarliestKnownAwarenessDateValue").val());
                data.append(`D2s[0].D2_ProblemPartEarliestKnownShipmentDate`, $("#D2_ProblemPartEarliestKnownShipmentDateValue").val());
                var inputD2attach = document.getElementById("D2_Attachments");
                if (typeof inputD2attach != "undefined" && inputD2attach != null) {
                    var files = inputD2attach.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d2_attachments", files[i]);
                    }
                }
                var inputD2ConformAttachments = document.getElementById("D2_ConformAttachments");
                if (typeof inputD2ConformAttachments != "undefined" && inputD2ConformAttachments != null) {
                    var files = inputD2ConformAttachments.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d2_ConformAttachments", files[i]);
                    }
                }
                var inputD2NonConformAttachments = document.getElementById("D2_NonConformAttachments");
                if (typeof inputD2NonConformAttachments != "undefined" && inputD2NonConformAttachments != null) {
                    var files = inputD2NonConformAttachments.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d2_NonConformAttachments", files[i]);
                    }
                }
                //D3
                var chkD3 = $("#D3_CopyFromD0").is(":checked");
                data.append(`D3s[0].CopyFromD0`, chkD3);
                $(".actionTask_D3").each(function (index) {
                    var thisId = $(this).data("id");
                    var member = $(`#D3_TeamMember_${thisId}`).find(":selected");

                    if ($(`#D3_Action_${thisId}`).val() != "") {
                        data.append(`D3s[0].D3_Actions[${index}].D3_Detail`, $(`#D3_Action_${thisId}`).val());
                    }
                    if (member.val() != "") {
                        data.append(`D3s[0].D3_Actions[${index}].D3_TeamMember`, member.val());
                        data.append(`D3s[0].D3_Actions[${index}].D3_TeamMemberName`, member.data("email"));
                        data.append(`D3s[0].D3_Actions[${index}].D3_TeamMemberEmail`, member.data("name"));
                    }
                    if ($(`#D3_DateStartValue_${thisId}`).val() != "") {
                        data.append(`D3s[0].D3_Actions[${index}].D3_DateStart`, $(`#D3_DateStartValue_${thisId}`).val());
                    }
                    if ($(`#D3_Metric_${thisId}`).val() != "") {
                        data.append(`D3s[0].D3_Actions[${index}].D3_Metric`, $(`#D3_Metric_${thisId}`).val());
                    }
                    if ($(`#D3_Eff_${thisId}`).val() != "") {
                        data.append(`D3s[0].D3_Actions[${index}].D3_Eff`, $(`#D3_Eff_${thisId}`).val());
                    }
                    if ($(`#D3_PartId_${thisId}`).val() != "") {
                        data.append(`D3s[0].D3_Actions[${index}].D3_PartId`, $(`#D3_PartId_${thisId}`).val());
                    }
                    if ($(`#D3_DateStartValue_${thisId}`).val() != "") {
                        data.append(`D3s[0].D3_Actions[${index}].D3_DateFinish`, $(`#D3_DateFinishValue_${thisId}`).val());
                    }


                });
                var inputD3attach = document.getElementById("D3_Attachments");
                if (typeof inputD3attach != "undefined" && inputD3attach != null) {
                    var files = inputD3attach.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d3_attachments", files[i]);
                    }
                }
                //D4
                $(".actionTask_D4").each(function (index) {
                    var thisId = $(this).data("id");
                    var member = $(`#D4_CauseSource_${thisId}`).find(":selected");
                    var chkVerifyD4 = $(`#D4_Verified_${thisId}`).is(":checked");
                    if (member.val() != "") {
                        data.append(`D4s[0].D4_CauseSources[${index}].RefCauseSourceId`, member.val());
                    }
                    if ($(`#D4_CauseSourceDescription_${thisId}`).val() != "") {
                        data.append(`D4s[0].D4_CauseSources[${index}].CauseDescription`, $(`#D4_CauseSourceDescription_${thisId}`).val());
                    }
                    data.append(`D4s[0].D4_CauseSources[${index}].Verified`, chkVerifyD4);


                    if ($(`#D4_DateValue_${thisId}`).val() != "") {
                        data.append(`D4s[0].D4_CauseSources[${index}].Date`, $(`#D4_DateValue_${thisId}`).val());
                    }
                    if ($(`#D4_VerificationMethod_${thisId}`).val() != "") {
                        data.append(`D4s[0].D4_CauseSources[${index}].VerificationMethod`, $(`#D4_VerificationMethod_${thisId}`).val());
                    }
                });
                $("input[name='D4_HasEscapePointCausesBeenaddressed_1']:checked").each(function (index) {
                    data.append("D4s[0].D4_HasEscapePointCausesBeenAddressed", $(this).val());
                });
                $("input[name='D4_CanCausesExplainDifferences_1']:checked").each(function (index) {
                    data.append("D4s[0].D4_CanCausesExplainDifferences", $(this).val());
                });
                $("input[name='D4_IdentifyCausesInProcessFMEA_1']:checked").each(function (index) {
                    data.append("D4s[0].D4_IdentifyCausesInProcessFMEA", $(this).val());
                });
                var chkFishboneD4 = $("#D4_FishboneCheck").is(":checked");
                data.append("D4s[0].D4_FishBone", chkFishboneD4);
                if ($(`#FishBone_Main`).val() != "") {
                    data.append(`D4s[0].FishBone_Main`, $(`#FishBone_Main`).val());
                }
                if ($(`#FishBone_Machine`).val() != "") {
                    data.append(`D4s[0].FishBone_Machine`, $(`#FishBone_Machine`).val());
                }
                if ($(`#FishBone_Manufacturing`).val() != "") {
                    data.append(`D4s[0].FishBone_Manufacturing`, $(`#FishBone_Manufacturing`).val());
                }
                if ($(`#FishBone_Measurement`).val() != "") {
                    data.append(`D4s[0].FishBone_Measurement`, $(`#FishBone_Measurement`).val());
                }
                if ($(`#FishBone_Material`).val() != "") {
                    data.append(`D4s[0].FishBone_Material`, $(`#FishBone_Material`).val());
                }
                if ($(`#FishBone_Environment`).val() != "") {
                    data.append(`D4s[0].FishBone_Environment`, $(`#FishBone_Environment`).val());
                }

                var chkFiveWhyD4 = $("#FiveWhy").is(":checked");
                data.append("D4s[0].D4_FiveWhy", chkFiveWhyD4);
                if ($(`#FiveWhy_DefineTheProblem`).val() != "") {
                    data.append(`D4s[0].DefineTheProblem`, $(`#FiveWhy_DefineTheProblem`).val());
                }
                if ($(`#FiveWhy_Why1`).val() != "") {
                    data.append(`D4s[0].Why1`, $(`#FiveWhy_Why1`).val());
                }
                if ($(`#FiveWhy_How1`).val() != "") {
                    data.append(`D4s[0].How1`, $(`#FiveWhy_How1`).val());
                }
                if ($(`#FiveWhy_Why2`).val() != "") {
                    data.append(`D4s[0].Why2`, $(`#FiveWhy_Why2`).val());
                }
                if ($(`#FiveWhy_How2`).val() != "") {
                    data.append(`D4s[0].How2`, $(`#FiveWhy_How2`).val());
                }
                if ($(`#FiveWhy_Why3`).val() != "") {
                    data.append(`D4s[0].Why3`, $(`#FiveWhy_Why3`).val());
                }
                if ($(`#FiveWhy_How3`).val() != "") {
                    data.append(`D4s[0].How3`, $(`#FiveWhy_How3`).val());
                }
                if ($(`#FiveWhy_Why4`).val() != "") {
                    data.append(`D4s[0].Why4`, $(`#FiveWhy_Why4`).val());
                }
                if ($(`#FiveWhy_How4`).val() != "") {
                    data.append(`D4s[0].How4`, $(`#FiveWhy_How4`).val());
                }
                var inputD4attach = document.getElementById("D4_Attachments");
                if (typeof inputD4attach != "undefined" && inputD4attach != null) {
                    var files = inputD4attach.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d4_attachments", files[i]);
                    }
                }

                //D5
                data.append(`D5s[0].Detail`,"-");
                $(".actionTask_D5").each(function (index) {
                    var thisId = $(this).data("id");
                    var causeSource = $(`#D5_CauseSource_${thisId}`).find(":selected");
                    var chkVerifyD5 = $(`#D5_Verified_${thisId}`).is(":checked");
                    if (causeSource.val() != "") {
                        data.append(`D5s[0].D5_Actions[${index}].RefCauseSourceId`, causeSource.val());
                    }
                    if ($(`#D5_PermanentCorrectAction_${thisId}`).val() != "") {
                        data.append(`D5s[0].D5_Actions[${index}].Detail`, $(`#D5_PermanentCorrectAction_${thisId}`).val());

                    }
                    data.append(`D5s[0].D5_Actions[${index}].Verify`, chkVerifyD5);


                    if ($(`#D5_DateValue_${thisId}`).val() != "") {
                        data.append(`D5s[0].D5_Actions[${index}].Date`, $(`#D5_DateValue_${thisId}`).val());
                    }
                    if ($(`#D5_VerificationMethod_${thisId}`).val() != "") {
                        data.append(`D5s[0].D5_Actions[${index}].VerificationMethod`, $(`#D5_VerificationMethod_${thisId}`).val());
                    }
                });
                var inputD5attach = document.getElementById("D5_Attachments");
                if (typeof inputD5attach != "undefined" && inputD5attach != null) {
                    var files = inputD5attach.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d5_attachments", files[i]);
                    }
                }

                //D6
                data.append(`D6s[0].Detail`,"-");
                $(".actionTask_D6").each(function (index) {
                    var thisId = $(this).data("id");
                    var member = $(`#D6_TeamMember_${thisId}`).find(":selected");
                    if (member.val() != "") {
                        data.append(`D6s[0].D6_Actions[${index}].TeamMemberId`, member.val());
                        data.append(`D6s[0].D6_Actions[${index}].TeamMemberName`, member.data("name"));
                        data.append(`D6s[0].D6_Actions[${index}].TeamMemberEmail`, member.data("email"));
                    }
                    if ($(`#D6_PermenentCorrectiveAction_${thisId}`).val() != "") {
                        data.append(`D6s[0].D6_Actions[${index}].Detail`, $(`#D6_PermenentCorrectiveAction_${thisId}`).val());

                    }
                    if ($(`#D6_ImplementationPlan_${thisId}`).val() != "") {
                        data.append(`D6s[0].D6_Actions[${index}].ImplementationPlan`, $(`#D6_ImplementationPlan_${thisId}`).val());

                    }
                    $(`input[name='D6_CustomerConcurrence_${thisId}']:checked`).each(function (i) {
                        //alert($(this).val());
                        data.append(`D6s[0].D6_Actions[${index}].CustomerConcurrence`, $(this).val());
                    });
                    if ($(`#D6_DateValue_${thisId}`).val() != null) {
                        data.append(`D6s[0].D6_Actions[${index}].ImplementActionDate`, $(`#D6_DateValue_${thisId}`).val());

                    }

                    data.append(`D6s[0].D6_Actions[${index}].RefPCAStatusId`, $(`#D6_PCAStatus_${thisId}`).val());
                });
                var inputD6attach = document.getElementById("D6_Attachments");
                if (typeof inputD6attach != "undefined" && inputD6attach != null) {
                    var files = inputD6attach.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d6_attachments", files[i]);
                    }
                }

                //D7A
                data.append(`D7s[0].Detail`, "-");
                $(".actionTask_D7A").each(function (index) {
                    var thisId = $(this).data("id");
                    var member = $(`#D7A_TeamMember_${thisId}`).find(":selected");
                    if (member.val() != "") {
                        data.append(`D7s[0].D7_As[${index}].TeamMemberId`, member.val());
                        data.append(`D7s[0].D7_As[${index}].TeamMemberName`, member.data("name"));
                        data.append(`D7s[0].D7_As[${index}].TeamMemberEmail`, member.data("email"));
                    }
                    if ($(`#D7A_SelectedPreventiveAction_${thisId}`).val() != "") {
                        data.append(`D7s[0].D7_As[${index}].PreventiveAction`, $(`#D7A_SelectedPreventiveAction_${thisId}`).val());
                    }
                    if ($(`#D7A_ImplementationPlan_${thisId}`).val() != "") {
                        data.append(`D7s[0].D7_As[${index}].PAImplementationPlan`, $(`#D7A_ImplementationPlan_${thisId}`).val());
                    }
                    data.append(`D7s[0].D7_As[${index}].TargetDate`, $(`#D7A_TargetDateValue_${thisId}`).val());
                    data.append(`D7s[0].D7_As[${index}].ActualDate`, $(`#D7A_ActualDate_${thisId}`).val());
                    data.append(`D7s[0].D7_As[${index}].RefPCAStatusId`, $(`#D7A_PCAStatus_${thisId}`).val());

                });
                $(".actionTask_D7B").each(function (index) {
                    var thisId = $(this).data("id");

                    if ($(`#D7B_Responsible_${thisId}`).val() != "") {
                        data.append(`D7s[0].D7_Bs[${index}].Responsible`, $(`#D7B_Responsible_${thisId}`).val());
                    }
                    if ($(`#D7B_ProcessItem_${thisId}`).val() != "") {
                        data.append(`D7s[0].D7_Bs[${index}].Process`, $(`#D7B_ProcessItem_${thisId}`).val());
                    }
                    if ($(`#D7B_PlanValidationDateValue_${thisId}`).val() != null) {
                        data.append(`D7s[0].D7_Bs[${index}].PlanValidationDate`, $(`#D7B_PlanValidationDateValue_${thisId}`).val());
                    }

                });
                var inputD7attach = document.getElementById("D7_Attachments");
                if (typeof inputD7attach != "undefined" && inputD7attach != null) {
                    var files = inputD7attach.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d7_attachments", files[i]);
                    }
                }

                if ($(`#D7C_Description_1`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo1`, $(`#D7C_Description_1`).val());
                }
                if ($(`#D7C_Description_2`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo2`, $(`#D7C_Description_2`).val());
                }
                if ($(`#D7C_Description_3`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo3`, $(`#D7C_Description_3`).val());
                }
                if ($(`#D7C_Description_4`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo4`, $(`#D7C_Description_4`).val());
                }
                if ($(`#D7C_Description_5`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo5`, $(`#D7C_Description_5`).val());
                }
                if ($(`#D7C_Description_6`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo6`, $(`#D7C_Description_6`).val());
                }
                if ($(`#D7C_Description_7`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo7`, $(`#D7C_Description_7`).val());
                }
                if ($(`#D7C_Description_8`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo8`, $(`#D7C_Description_8`).val());
                }
                if ($(`#D7C_Description_9`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo9`, $(`#D7C_Description_9`).val());
                }
                if ($(`#D7C_Description_10`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo10`, $(`#D7C_Description_10`).val());
                }
                if ($(`#D7C_Description_11`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo11`, $(`#D7C_Description_11`).val());
                }
                if ($(`#D7C_Description_12`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo12`, $(`#D7C_Description_12`).val());
                }
                if ($(`#D7C_Description_13`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo13`, $(`#D7C_Description_13`).val());
                }
                if ($(`#D7C_Description_14`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo14`, $(`#D7C_Description_14`).val());
                }
                if ($(`#D7C_Description_15`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo15`, $(`#D7C_Description_15`).val());
                }

                if ($(`#D7C_Resp_1`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp1`, $(`#D7C_Resp_1`).val());
                }
                if ($(`#D7C_Resp_2`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp2`, $(`#D7C_Resp_2`).val());
                }
                if ($(`#D7C_Resp_3`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp3`, $(`#D7C_Resp_3`).val());
                }
                if ($(`#D7C_Resp_4`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp4`, $(`#D7C_Resp_4`).val());
                }
                if ($(`#D7C_Resp_5`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp5`, $(`#D7C_Resp_5`).val());
                }
                if ($(`#D7C_Resp_6`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp6`, $(`#D7C_Resp_6`).val());
                }
                if ($(`#D7C_Resp_7`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp7`, $(`#D7C_Resp_7`).val());
                }
                if ($(`#D7C_Resp_8`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp8`, $(`#D7C_Resp_8`).val());
                }
                if ($(`#D7C_Resp_9`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp9`, $(`#D7C_Resp_9`).val());
                }
                if ($(`#D7C_Resp_10`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp10`, $(`#D7C_Resp_10`).val());
                }
                if ($(`#D7C_Resp_11`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp11`, $(`#D7C_Resp_11`).val());
                }
                if ($(`#D7C_Resp_12`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp12`, $(`#D7C_Resp_12`).val());
                }
                if ($(`#D7C_Resp_13`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp13`, $(`#D7C_Resp_13`).val());
                }
                if ($(`#D7C_Resp_14`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp14`, $(`#D7C_Resp_14`).val());
                }
                if ($(`#D7C_Resp_15`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp15`, $(`#D7C_Resp_15`).val());
                }

                if ($(`#D7C_ReviewCompletionDatePlanValue_1`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate1`, $(`#D7C_ReviewCompletionDatePlanValue_1`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_2`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate2`, $(`#D7C_ReviewCompletionDatePlanValue_2`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_3`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate3`, $(`#D7C_ReviewCompletionDatePlanValue_3`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_4`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate4`, $(`#D7C_ReviewCompletionDatePlanValue_4`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_5`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate5`, $(`#D7C_ReviewCompletionDatePlanValue_5`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_6`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate6`, $(`#D7C_ReviewCompletionDatePlanValue_6`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_7`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate7`, $(`#D7C_ReviewCompletionDatePlanValue_7`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_8`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate8`, $(`#D7C_ReviewCompletionDatePlanValue_8`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_9`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate9`, $(`#D7C_ReviewCompletionDatePlanValue_9`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_10`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate10`, $(`#D7C_ReviewCompletionDatePlanValue_10`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_11`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate11`, $(`#D7C_ReviewCompletionDatePlanValue_11`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_12`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate12`, $(`#D7C_ReviewCompletionDatePlanValue_12`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_13`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate13`, $(`#D7C_ReviewCompletionDatePlanValue_13`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_14`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate14`, $(`#D7C_ReviewCompletionDatePlanValue_14`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_15`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate15`, $(`#D7C_ReviewCompletionDatePlanValue_15`).val());
                }

                if ($(`#D7C_ReviewCompletionDateActualValue_1`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate1`, $(`#D7C_ReviewCompletionDateActualValue_1`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_2`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate2`, $(`#D7C_ReviewCompletionDateActualValue_2`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_3`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate3`, $(`#D7C_ReviewCompletionDateActualValue_3`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_4`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate4`, $(`#D7C_ReviewCompletionDateActualValue_4`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_5`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate5`, $(`#D7C_ReviewCompletionDateActualValue_5`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_6`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate6`, $(`#D7C_ReviewCompletionDateActualValue_6`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_7`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate7`, $(`#D7C_ReviewCompletionDateActualValue_7`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_8`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate8`, $(`#D7C_ReviewCompletionDateActualValue_8`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_9`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate9`, $(`#D7C_ReviewCompletionDateActualValue_9`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_10`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate10`, $(`#D7C_ReviewCompletionDateActualValue_10`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_11`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate11`, $(`#D7C_ReviewCompletionDateActualValue_11`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_12`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate12`, $(`#D7C_ReviewCompletionDateActualValue_12`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_13`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate13`, $(`#D7C_ReviewCompletionDateActualValue_13`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_14`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate14`, $(`#D7C_ReviewCompletionDateActualValue_14`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_15`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate15`, $(`#D7C_ReviewCompletionDateActualValue_15`).val());
                }

                //D8A
                data.append(`D8s[0].Detail`, "-");
                $(".actionTask_D8A").each(function (index) {
                    var thisId = $(this).data("id");

                    if ($(`#D8_PlanDateValue_${thisId}`).val() != "") {
                        data.append(`D8s[0].D8_As[${index}].PlanDate`, $(`#D8_PlanDateValue_${thisId}`).val());
                    }
                    if ($(`#D8_ActualDateValue_${thisId}`).val() != "") {
                        data.append(`D8s[0].D8_As[${index}].ActualDate`, $(`#D8_ActualDateValue_${thisId}`).val());
                    }

                });

                //D8B
                if (workFlowId == 6) {
                    if ($("#Title1").val() != "") {
                    data.append(`D8s[0].D8_Bs[0].Title1`, $("#Title1").val());
                }
                if ($("#Title2").val() != "") {
                    data.append(`D8s[0].D8_Bs[0].Title2`, $("#Title2").val());
                }

                data.append(`D8s[0].D8_Bs[0].Signature1`, '@creator.EmpDomainId');
                data.append(`D8s[0].D8_Bs[0].Signature2`, $("#Signature2").val());
                }


                var inputD8attach = document.getElementById("D8_Attachments");
                if (typeof inputD8attach != "undefined" && inputD8attach != null) {
                    var files = inputD8attach.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d8_attachments", files[i]);
                    }
                }

                //D8C
                data.append(`D8s[0].D8_Cs[0].When`, $("#D8C_When").val());
                data.append(`D8s[0].D8_Cs[0].Where`, $("#D8C_Description").val());
                data.append(`D8s[0].D8_Cs[0].How`, $("#D8C_How").val());



                $.ajax({
                            contentType: false,
                            processData: false,
                            type: "POST",
                            url: '@Url.Action("Edit", "Home")',
                            data: data,
                            success: function (data) {
                                Toast.fire({
                                    icon: 'success',
                                    title: ' Your work has been saved'
                                });

                                setTimeout(function() {
                                    window.location.href = '@Url.Action("Edit", "Home")';// + data;
                                }, 1000);
                            },
                            error: function (err) {
                                $("#SubmitFormSpinn").addClass("d-none");
                                $("button[name=btnSave]").prop("disabled", false);
                                $("button[name=btnSubmit]").prop("disabled", false);
                                $("button[name=btnMgrSubmit]").prop("disabled", false);

                                console.log(err);
                            }
                        });

            }

            $("#D2_SupSupplier").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $("#D2_SupSupplierDetail").removeAttr("disabled");
                } else {
                    $("#D2_SupSupplierDetail").attr("disabled", "disabled");
                }
            });
            $("#D2_Organization").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $("#D2_OrganizationDetail").removeAttr("disabled");
                } else {
                    $("#D2_OrganizationDetail").attr("disabled", "disabled");
                }
            });
            $("#D2_Customer").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $("#D2_CustomerDetail").removeAttr("disabled");
                } else {
                    $("#D2_CustomerDetail").attr("disabled", "disabled");
                }
            });
            $("#D2_Other1").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $("#D2_Other1Detail").removeAttr("disabled");
                } else {
                    $("#D2_Other1Detail").attr("disabled", "disabled");
                }
            });
            $("#D2_CustomerOfCustomer").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $("#D2_CustomerOfCustomerDetail").removeAttr("disabled");
                } else {
                    $("#D2_CustomerOfCustomerDetail").attr("disabled", "disabled");
                }
            });
            $("#D2_AircraftOperators").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $("#D2_AircraftOperatorsDetail").removeAttr("disabled");
                } else {
                    $("#D2_AircraftOperatorsDetail").attr("disabled", "disabled");
                }
            });
            $("#D2_SpareParts").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $("#D2_SparePartsDetail").removeAttr("disabled");
                } else {
                    $("#D2_SparePartsDetail").attr("disabled", "disabled");
                }
            });
            $("#D2_Other2").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $("#D2_Other2Detail").removeAttr("disabled");
                } else {
                    $("#D2_Other2Detail").attr("disabled", "disabled");
                }
            });
            $("#D4_FishboneCheck").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $(".fishbone").removeClass("d-none");

                } else {
                    $(".fishbone").addClass("d-none");
                }
            });
            $("#FiveWhy").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $(".fivewhy").removeClass("d-none");

                } else {
                    $(".fivewhy").addClass("d-none");
                }
            });
            $("#D3_CopyFromD0").change(function () {
                var obj = $(this);
                if (obj.is(":checked")) {
                    $(".actionTask_D3").each(function (index) {
                        const row = index + 1;
                        $(`#actionTask_D3_${row}`).remove();

                    });
                    $(".actionTask").each(function (index) {
                        const row = index + 1;
                        var member2 = $(`#D0_TeamMember_${row}`).find(":selected");
                       // $(`#actionTask_D3_${row}`).remove();
                        var str = `
                     <tr class="actionTask_D3" id="actionTask_D3_${row}" data-id="${row}">
                                        <td class="form-group" style="width:300px;">
                                            <textarea class="form-control form-control-sm" id="D3_Action_${row}" name="D3_Action_${row}" rows="1" required>` + $(`#D0_Action_${row}`).val() + `</textarea>
                                        </td>
                                        <td class="form-group" style="width:300px;">
                                            <select class="form-control form-control-sm select2" id="D3_TeamMember_${row}" name="D3_TeamMember_${row}" style="width: 100%;" data-id="${row}">
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                 {
                                                    <text>
                        str += `
                                                            <option value='@e.EmpId'
                                                                           data-domainid='@e.EmpDomainId'
                                                                           data-name='@e.EmpFullnameEN'
                                                                           data-email='@e.EmpEmail'
                                                                           data-position='@e.EmpPositionName'
                                                                           data-section='@e.EmpSectionName'
                                                                           data-department='@e.EmpDepartmentName'

                                                               >
                                                                           ` + `@e.EmpFullnameEN` + `
                                                            </option>
                                                            `;

                                                   </text>
                                                   }
                        str += ` </select>

                                                                     </td>

                                                                     <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm inputdate" id="D3_DateStartValue_${row}" name="D3_DateStartValue_${row}" value="` + $(`#D0_DateStart_${row}`).val() + `"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D3_Metric_${row}" name="D3_Metric_${row}" value="` + $(`#D0_Metric_${row}`).val() + `" />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D3_Eff_${row}" name="D3_Eff_${row}" value="` + $(`#D0_Eff_${row}`).val() + `" />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="text" class="form-control form-control-sm" id="D3_PartId_${row}" name="D3_PartId_${row}" value="` + $(`#D0_PartId_${row}`).val() + `"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D3_DateFinishValue_${row}" name="D3_DateFinishValue_${row}" value="` + $(`#D0_DateFinish_${row}`).val() + `" />
                                                    </td>
                                                    <td class="text-center">`;
                        if (index == 0) {

                            str += `
                            <a href="javascript:void(0)" id="addAction_D3">
                                <i class="fas fa-plus text-success"></i>
                            </a> `;

                        } else {
                            str += `
                            <a href="javascript:void(0)" class="removeAction_D3" data-id="${row}">
                                <i class="fas fa-minus text-danger"></i>
                            </a> `;
                        }
                        str += `
                                                    </td>
                                                </tr>
                                            `;

                        $("#actionTaskBody_D3").append(str);

                        $(`.removeAction_D3`).click(function (e) {
                            e.stopImmediatePropagation();

                            $(`#actionTask_D3_${row}`).remove();
                        });
                        $('.select2').select2();
                        $("#addAction_D3").click(function (e) {
                            AddD3(e);
                        });
                    });
                }
                else {
                     $(".actionTask_D3").each(function (index) {
                        const row = index + 1;
                        $(`#actionTask_D3_${row}`).remove();

                     });

                     var str = `
                     <tr class="actionTask_D3" id="actionTask_D3_1" data-id="1">
                                        <td class="form-group" style="width:300px;">
                                            <textarea class="form-control form-control-sm" id="D3_Action_1" name="D3_Action_1" rows="1" required></textarea>
                                        </td>
                                        <td class="form-group" style="width:300px;">
                                            <select class="form-control form-control-sm select2" id="D3_TeamMember_1" name="D3_TeamMember_1" style="width: 100%;" data-id="1">
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var e in verifyRef.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                 {
                                                    <text>
                        str += `
                                                            <option value='@e.EmpId'
                                                                           data-domainid='@e.EmpDomainId'
                                                                           data-name='@e.EmpFullnameEN'
                                                                           data-email='@e.EmpEmail'
                                                                           data-position='@e.EmpPositionName'
                                                                           data-section='@e.EmpSectionName'
                                                                           data-department='@e.EmpDepartmentName'

                                                               >
                                                                           ` + `@e.EmpFullnameEN` + `
                                                            </option>
                                                            `;

                                                   </text>
                                                   }
                        str += ` </select>

                                                                     </td>

                                                                     <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm inputdate" id="D3_DateStartValue_1" name="D3_DateStartValue_1"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D3_Metric_1" name="D3_Metric_1"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D3_Eff_1" name="D3_Eff_1" />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="text" class="form-control form-control-sm" id="D3_PartId_1" name="D3_PartId_1"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D3_DateFinishValue_1" name="D3_DateFinishValue_1" />
                                                    </td>
                                                    <td class="text-center">`;
                    str += `
                            <a href="javascript:void(0)" id="addAction_D3">
                                <i class="fas fa-plus text-success"></i>
                            </a> `;
                        str += `
                                                    </td>
                                                </tr>
                                            `;

                        $("#actionTaskBody_D3").append(str);

                        $(`.removeAction_D3`).click(function (e) {
                            e.stopImmediatePropagation();

                            $(`#actionTask_D3_1`).remove();
                        });
                    $('.select2').select2();
                    $("#addAction_D3").click(function (e) {
                        AddD3(e);
                    });
                }


            });
        });
    </script>

}


