@model CreateReference
@{
    ViewData["Title"] = "Home Page";
    Layout = "~/Views/Shared/_Layout2.cshtml";

    var verifyRef = ViewBag.VerifyRef as VerifyReference;
    var creator = ViewBag.creator as EmpInfo;

}
<div class="row m-2">
    <div class="col-sm-6">
        <h1>8D Report - Create New</h1>
    </div>
    <div class="col-sm-2">
        <div class="form-group">
            <span class="text-bold">Date Opened</span>
            <input type="date" class="form-control form-control-sm inputdate" id="HeaderDateOpened" />
        </div>
    </div>
    <div class="col-sm-2">
        <div class="form-group">
            <span class="text-bold">Targeted Closure</span>
            <input type="date" class="form-control form-control-sm inputdate" id="HeaderDateTargetedClosure" />
        </div>
    </div>
    <div class="col-sm-2">
        <div class="form-group">
            <span class="text-bold">Date Closed</span>
            <input type="date" class="form-control form-control-sm inputdate" id="HeaderDateClosed" />
        </div>
    </div>

</div>
<div class="row mb-1">
    <div class="col-sm-3">
        <div class="position-relative p-2 bg-gray" style="height: 180px">
            <div class="ribbon-wrapper ribbon-xl">
                <div class="ribbon bg-primary">
                    Progress Tracker
                </div>
            </div>
            <div class="d-none">
                <strong>Report No:</strong> SAT-8D-22-001<br />
                <strong>Created Date:</strong> 07-Apr-2022<br />
                <strong>Created By:</strong> Sarocha S.<br />
            </div>

            <strong>NCR No:</strong> <input class="form-control form-control-sm col-sm-6" id="NcrNo" /><br />

        </div>
    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px;text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    0
                </div>
            </div>

            <img src="~/dist/img/D1.jpg" class="img-fluid" style="height:55px;width:55px;" />
            <small>Implement Immediate containment and prep.</small>
        </div>
    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px; text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    1
                </div>
            </div>
            <img src="~/dist/img/D2.jpg" class="img-fluid" style="height:55px;width:55px;" /><br />
            <small>Form the team</small>
        </div>

    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px; text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    2
                </div>
            </div>
            <img src="~/dist/img/D3.jpg" class="img-fluid" style="height:55px;width:55px;" />
            <small>Define the Problem</small>
        </div>
    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px; text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    3
                </div>
            </div>
            <img src="~/dist/img/D4.jpg" class="img-fluid" style="height:55px;width:55px;" />
            <small>Develop Containment Actions</small>
        </div>
    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px; text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    4
                </div>
            </div>
            <img src="~/dist/img/D5.jpg" class="img-fluid" style="height:55px;width:55px;" />

            <small>Identify and verify Root Cause</small>
        </div>
    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px; text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    5
                </div>
            </div>
            <img src="~/dist/img/D6.jpg" class="img-fluid" style="height:55px;width:55px;" />

            <small>Identify Corrective Action</small>
        </div>
    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px; text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    6
                </div>
            </div>
            <img src="~/dist/img/D7.jpg" class="img-fluid" style="height:55px;width:55px;" />

            <small>Implement Corrective Action</small>
        </div>
    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px; text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    7
                </div>
            </div>
            <img src="~/dist/img/D8.jpg" class="img-fluid" style="height:55px;width:55px;" />
            <small>Define and plan Preventive action</small>

        </div>
    </div>
    <div class="col-sm-1">
        <div class="position-relative p-3 bg-gray" style="height: 180px; text-align: center;">
            <div class="ribbon-wrapper">
                <div class="ribbon bg-primary">
                    8
                </div>
            </div>
            <img src="~/dist/img/D9.jpg" class="img-fluid" style="height:55px;width:55px;" />
            <small>Recognise the team</small>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-sm-3">
        <p class="text-right text-bold">Closure Date</p>
    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD0" />

    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD1" />

    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD2" />

    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD3" />

    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD4" />

    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD5" />

    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD6" />

    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD7" />

    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateClosureD8" />
    </div>
</div>
<div class="row">
    <div class="col-sm-3">
        <p class="text-right text-bold">Effectiveness check Date</p>
    </div>
    <div class="col-sm-1">
        <input type="date" class="form-control form-control-sm" id="DateEffectivenessCheck" />

    </div>

</div>
@* D0 *@
<div class="row">
    <div class="col-12">
        <!-- Default box -->
        <div class="card">
            <div class="card-header">

                <h3 class="card-title mr-1 text-bold" style="align-self:center;">D0: </h3><h3 class="card-title">Implement Immediate Containment and Prepare for 8D</h3>
                <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="form-group col-md-12">
                        <span>Implement Immediate Containment and Prepare for 8D</span>
                        <textarea class="form-control form-control-sm col-md-6" id="D0_Comment" placeholder="Enter Comment"></textarea>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 form-group">
                        <span>Part number</span>
                        <input class="form-control form-control-sm" id="D0_PartNumber" placeholder="Part number" />
                    </div>
                    <div class="col-md-4 form-group">
                        <span>PO number</span>
                        <input class="form-control form-control-sm" id="D0_PONum" placeholder="PO number" />
                    </div>
                    <div class="col-md-4 form-group">
                        <span>Customer contact</span>
                        <input class="form-control form-control-sm" id="D0_CustomerContact" placeholder="Name" />
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 form-group">
                        <span>Part Description</span>
                        <textarea class="form-control form-control-sm" id="D0_PartDescription" placeholder="Description"></textarea>

                    </div>
                    <div class="col-md-4 form-group">
                        <span>PO item</span>
                        <input class="form-control form-control-sm" id="D0_POItem" placeholder="PO item" />
                    </div>
                    <div class="col-md-4 form-group">
                        <span>Witnessed by</span>
                        <input class="form-control form-control-sm" id="D0_WitnessedBy" placeholder="Name" />
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 form-group">
                        <span>Affected customer product</span>
                        <input class="form-control form-control-sm" id="D0_AffectedCustomerProduct" placeholder="Product" />
                    </div>
                    <div class="col-md-6 form-group">
                        <span>Customer reference</span>
                        <input class="form-control form-control-sm" id="D0_CustomerReference" placeholder="Customer reference" />
                    </div>
                </div>
                <hr />
                <strong>Containment Checklist</strong>
                <div class="row">
                    <div class="col-sm-2">
                        <span>Delivery affected?</span>
                    </div>
                    <div class="col-sm-6">
                        <!-- radio -->
                        <div class="form-group clearfix DeliveryAffectedVerifyTaskGroup">
                            <div class="icheck-danger d-inline">
                                <input type="radio" id="D0_DeliveryAffected_1" class="D0_DeliveryAffectedCheck" value="false" name="D0_DeliveryAffected_1">
                                <label for="D0_DeliveryAffected_1">
                                    No
                                </label>
                            </div>
                            <div class="icheck-success d-inline">
                                <input type="radio" id="D0_DeliveryAffected_2" class="D0_DeliveryAffectedCheck" value="true" name="D0_DeliveryAffected_1">
                                <label for="D0_DeliveryAffected_2">
                                    Yes
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-2">
                        <span>Suspect root cause identified?</span>
                    </div>
                    <div class="col-sm-6">
                        <!-- radio -->
                        <div class="form-group clearfix SuspectRootCauseIdentifiedVerifyTaskGroup">
                            <div class="icheck-danger d-inline">
                                <input type="radio" id="D0_SuspectRootCauseIdentified_No" class="D0_SuspectRootCauseIdentifiedCheck" value="false" name="D0_SuspectRootCauseIdentified_1">
                                <label for="D0_SuspectRootCauseIdentified_No">
                                    No
                                </label>
                            </div>
                            <div class="icheck-success d-inline">
                                <input type="radio" id="D0_SuspectRootCauseIdentified_Yes" class="D0_SuspectRootCauseIdentifiedCheck" value="true" name="D0_SuspectRootCauseIdentified_1">
                                <label for="D0_SuspectRootCauseIdentified_Yes">
                                    Yes
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-2">
                        <span>Root cause verified?</span>

                    </div>
                    <div class="col-sm-6">
                        <!-- radio -->
                        <div class="form-group clearfix RootCauseVerifiedVerifyTaskGroup">
                            <div class="icheck-danger d-inline">
                                <input type="radio" id="D0_RootCauseVerified_No" class="D0_RootCauseVerifiedCheck" value="false" name="D0_RootCauseVerified_1">
                                <label for="D0_RootCauseVerified_No">
                                    No
                                </label>
                            </div>
                            <div class="icheck-success d-inline">
                                <input type="radio" id="D0_RootCauseVerified_Yes" class="D0_RootCauseVerifiedCheck" value="true" name="D0_RootCauseVerified_1">
                                <label for="D0_RootCauseVerified_Yes">
                                    Yes
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-2">
                        <span>Emergency respond action?</span>

                    </div>
                    <div class="col-sm-6">
                        <!-- radio -->
                        <div class="form-group clearfix EmergencyRespondActionVerifyTaskGroup">
                            <div class="icheck-danger d-inline">
                                <input type="radio" id="D0_EmergencyRespondAction_No" class="D0_EmergencyRespondActionCheck" value="false" name="D0_EmergencyRespondAction_1">
                                <label for="D0_EmergencyRespondAction_No">
                                    No
                                </label>
                            </div>
                            <div class="icheck-success d-inline">
                                <input type="radio" id="D0_EmergencyRespondAction_Yes" class="D0_EmergencyRespondActionCheck" value="true" name="D0_EmergencyRespondAction_1">
                                <label for="D0_EmergencyRespondAction_Yes">
                                    Yes
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-2">
                        <span>Recurring problem?</span>

                    </div>
                    <div class="col-sm-6">
                        <!-- radio -->
                        <div class="form-group clearfix RecurringProblemVerifyTaskGroup">
                            <div class="icheck-danger d-inline">
                                <input type="radio" id="D0_RecurringProblem_No" class="D0_RecurringProblemCheck" value="false" name="D0_RecurringProblem_1">
                                <label for="D0_RecurringProblem_No">
                                    No
                                </label>
                            </div>
                            <div class="icheck-success d-inline">
                                <input type="radio" id="D0_RecurringProblem_Yes" class="D0_RecurringProblemCheck" value="true" name="D0_RecurringProblem_1">
                                <label for="D0_RecurringProblem_Yes">
                                    Yes
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                @{
                    <strong>Emergency Respond Action </strong>
                    <table class="table table-sm table-striped table-valign-middle table-bordered">
                        <thead>
                            <tr>
                                <th>Action</th>
                                <th>Team member</th>
                                <th>Date Start</th>
                                <th>Metric</th>
                                <th>% Eff.</th>
                                <th>Part ID</th>
                                <th>Date Finish</th>
                                <th>Add/Edit</th>
                            </tr>
                        </thead>
                        <tbody id="actionTaskBody">
                            <tr class="actionTask" id="actionTask_1" data-id="1">
                                <td class="form-group" style="width:300px;">
                                    <textarea class="form-control form-control-sm" id="D0_Action_1" name="D0_Action_1" rows="1" required></textarea>
                                </td>
                                <td class="form-group" style="width:300px;">
                                    <select class="form-control form-control-sm select2" id="D0_TeamMember_1" name="D0_TeamMember_1" style="width: 100%;" data-id="1">
                                        <option value="" selected disabled>-- select --</option>
                                        @foreach (var e in Model.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                        {
                                            <option value="@e.EmpId"
                                                    data-domainid="@e.EmpDomainId"
                                                    data-name="@e.EmpFullnameEN"
                                                    data-email="@e.EmpEmail"
                                                    data-position="@e.EmpPositionName"
                                                    data-section="@e.EmpSectionName"
                                                    data-department="@e.EmpDepartmentName">
                                                @e.EmpFullnameEN
                                            </option>
                                        }

                                    </select>
                                </td>
                                <td class="form-group">
                                    <input type="date" class="form-control form-control-sm inputdate" id="D0_DateStartValue_1" />

                                </td>
                                <td class="form-group">
                                    <input type="number" class="form-control form-control-sm" id="D0_Metric_1" name="D0_Metric_1" required />
                                </td>
                                <td class="form-group">
                                    <input type="number" class="form-control form-control-sm" id="D0_Eff_1" name="D0_Eff_1" required />
                                </td>
                                <td class="form-group">
                                    <input type="text" class="form-control form-control-sm" id="D0_PartId_1" name="D0_PartId_1" required />
                                </td>
                                <td class="form-group">
                                    <input type="date" class="form-control form-control-sm inputdate" id="D0_DateFinishValue_1" />
                                </td>
                                <td class="text-center">
                                    <a href="javascript:void(0)" id="addAction">
                                        <i class="fas fa-plus text-success"></i>
                                    </a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                }

                <div class="row">
                    <div class="form-group">
                        <p>Attatchments</p>
                        <input type="file" id="D0_Attachments" name="d0_attachments" multiple />
                    </div>

                </div>
            </div>
        </div>
        <!-- /.card -->
    </div>
</div>
@* D1 *@
<div class="row">
    <div class="col-12">
        <!-- Default box -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title mr-1 text-bold" style="align-self:center;">D1: </h3><h3 class="card-title">Emergency Respond Action</h3>


                <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            </div>
            <div class="card-body">

                <div class="row">
                    @{
                        <table class="table table-sm table-striped table-valign-middle table-bordered">
                            <thead>
                                <tr>
                                    <th style="width:150px;">Function</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Date Start</th>
                                    <th>Phone No</th>
                                    <th>Add/Edit</th>
                                </tr>
                            </thead>
                            <tbody id="actionTaskBody_D1">
                                <tr class="actionTask_D1" id="actionTask_D1_1" data-id="1">
                                    <td class="form-group">
                                        <select class="form-control form-control-sm" id="D1_Function_1" name="D1_Function_1">
                                            <option value="" selected disabled>-- select --</option>
                                            @foreach (var f in Model.RefFunctions.Where(w => w.Active).OrderBy(o => o.Description))
                                            {
                                                <option value="@f.Id">@f.Description</option>

                                            }
                                        </select>
                                    </td>
                                    <td class="form-group" style="width:400px;">
                                        <select class="form-control form-control-sm select2" id="D1_TeamMember_1" name="D1_TeamMember_1" style="width: 100%;" data-id="1">
                                            <option value="" selected disabled>-- select --</option>
                                            @foreach (var item in Model.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                            {
                                                <option value="@item.EmpId"
                                                        data-domainid="@item.EmpDomainId"
                                                        data-name="@item.EmpFullnameEN"
                                                        data-email="@item.EmpEmail"
                                                        data-position="@item.EmpPositionName"
                                                        data-section="@item.EmpSectionName"
                                                        data-department="@item.EmpDepartmentName">
                                                    @item.EmpFullnameEN
                                                </option>
                                            }

                                        </select>
                                    </td>
                                    <td class="form-group" style="width:400px;">
                                        <select class="form-control form-control-sm select2" id="D1_EmailTeamMember_1" name="D1_EmailTeamMember_1" style="width: 100%;" data-id="1">
                                            <option value="" selected disabled>-- select --</option>
                                            @foreach (var item in Model.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                            {
                                                <option value="@item.EmpEmail"
                                                        data-domainid="@item.EmpDomainId"
                                                        data-name="@item.EmpFullnameEN"
                                                        data-email="@item.EmpEmail"
                                                        data-position="@item.EmpPositionName"
                                                        data-section="@item.EmpSectionName"
                                                        data-department="@item.EmpDepartmentName">
                                                    @item.EmpEmail
                                                </option>
                                            }

                                        </select>

                                    </td>
                                    <td class="form-group">
                                        <input type="date" class="form-control form-control-sm " id="D1_DateStartValue_1" />

                                    </td>
                                    <td class="form-group">
                                        <input type="text" class="form-control form-control-sm" id="D1_PhoneNo_1" name="D1_PhoneNo_1" data-inputmask="'mask': ['999-999-9999 [x99999]', '+099 99 99 9999[9]-9999']" data-mask>
                                    </td>
                                    <td class="text-center">
                                        <a href="javascript:void(0)" id="addAction_D1">
                                            <i class="fas fa-plus text-success"></i>
                                        </a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    }

                </div>

            </div>
            <!-- /.card-body -->

        </div>

        <!-- /.card -->
    </div>
</div>
@* D2 *@
<div class="row">
    <div class="col-12">
        <!-- Default box -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title mr-1 text-bold" style="align-self:center;">D2: </h3><h3 class="card-title">Define the Problem</h3>

                <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            </div>
            <div class="card-body">

                <div class="row">
                    <div class="form-group col-sm-6">
                        <span>Define customer experience</span>
                        <textarea class="form-control form-control-sm" id="D2_DefineCustomerExperience" placeholder="Enter customer experience"></textarea>

                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-sm-6">
                        <span>Failure mode: (what’s wrong with what?) and effect (at org. level and at customer)</span>
                        <textarea class="form-control form-control-sm" id="D2_FailureMode" placeholder="Enter Failure mode"></textarea>

                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-sm-6">
                        <span>What is required by the specification?</span>
                        <textarea class="form-control form-control-sm" id="D2_RequiredByTheSpecification" placeholder="Enter requirement"></textarea>

                    </div>
                    <div class="form-group col-sm-6">
                        <span>What’s the specification? Whose document is it?</span>
                        <textarea class="form-control form-control-sm" id="D2_TheSpecificationDocument" placeholder="Enter specification"></textarea>

                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-sm-6">
                        <span>Problem source: where in manufacturing process (if known)</span>
                        <textarea class="form-control form-control-sm" id="D2_ProblemSource" placeholder="Enter where"></textarea>

                    </div>
                    <div class="form-group col-sm-6">
                        <span>Customer problem type definition </span>
                        <textarea class="form-control form-control-sm" placeholder="Enter definition" id="D2_CustomerProblemTypeDefinition"></textarea>

                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-6">
                        <strong>Affected Part Quantification</strong><br />
                        <span>Number of parts produced within Problem Boundary</span>
                        <input class="form-control col-md-4 form-control-sm" type="number" placeholder="0" id="D2_NumberOfPartsProducedWithinProblemBoundary" /><br />
                        <span>Number of parts affected</span>
                        <input class="form-control col-md-4 form-control-sm" type="number" placeholder="0" id="D2_NumberOfPartsAffected" /><br />
                        <span>% of parts affected</span>
                        <input class="form-control col-md-4 form-control-sm" type="number" placeholder="0" disabled />
                    </div>
                    <div class=" col-md-6  ">
                        <div class="row">
                            <div class="form-group clearfix D2_RecurringProblemGroup">
                                <span>Recurring problem?</span><br />
                                <div class="icheck-danger d-inline">
                                    <input type="radio" id="D2_RecurringProblem_1" class="D2_RecurringProblemCheck" value="false" name="D2_RecurringProblem_1">
                                    <label for="D2_RecurringProblem_1">
                                        No
                                    </label>
                                </div>
                                <div class="icheck-success d-inline">
                                    <input type="radio" id="D2_RecurringProblem_2" class="D2_RecurringProblemCheck" value="true" name="D2_RecurringProblem_1">
                                    <label for="D2_RecurringProblem_2">
                                        Yes
                                    </label>
                                </div>
                                <br />
                                <input class="mb-2" type="file" multiple id="D2_AttachmentRecurrings" name="d2_attachmentRecurrings" />
                            </div>

                        </div>
                        <div class="row">
                            <div class="form-group clearfix D2_FailureModeInDPFMEAGroup">
                                <span>Failure mode in (D) (P) FMEA?</span>
                                <br />
                                <div class="icheck-danger d-inline">
                                    <input type="radio" id="D2_FailureModeInDPFMEA_1" class="D2_FailureModeInDPFMEACheck" value="false" name="D2_FailureModeInDPFMEA_1">
                                    <label for="D2_FailureModeInDPFMEA_1">
                                        No
                                    </label>
                                </div>
                                <div class="icheck-success d-inline">
                                    <input type="radio" id="D2_FailureModeInDPFMEA_2" class="D2_FailureModeInDPFMEACheck" value="true" name="D2_FailureModeInDPFMEA_1">
                                    <label for="D2_FailureModeInDPFMEA_2">
                                        Yes
                                    </label>
                                </div>
                                <br />
                                <input class="mb-1" type="file" multiple id="D2_AttachmentFailures" name="d2_attachmentFailures" />
                            </div>


                        </div>

                    </div>

                </div>
                <p style="margin-bottom:5px;"><strong>Problem Boundaries</strong></p>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group clearfix">
                            <div class="icheck-primary d-inline">
                                <input type="checkbox" id="D2_SupSupplier" name="D2_SupSupplier">
                                <label for="D2_SupSupplier" class="font-weight-normal">
                                    Sup Supplier
                                </label>
                                <input type="text" class="form-control form-control-sm" id="D2_SupSupplierDetail" placeholder="Enter text" disabled />
                            </div>
                            <br />
                            <div class="icheck-primary d-inline">
                                <input type="checkbox" id="D2_Organization" name="D2_Organization">
                                <label for="D2_Organization" class="font-weight-normal">
                                    Organization
                                </label>
                                <input type="text" class="form-control form-control-sm" id="D2_OrganizationDetail" placeholder="Enter text" disabled />
                            </div>
                            <br />
                            <div class="icheck-primary d-inline">
                                <input type="checkbox" id="D2_Customer" name="D2_Customer">
                                <label for="D2_Customer" class="font-weight-normal">
                                    Customer
                                </label>
                                <input type="text" class="form-control form-control-sm" id="D2_CustomerDetail" placeholder="Enter text" disabled />
                            </div>
                            <br />
                            <div class="icheck-primary d-inline">
                                <input type="checkbox" id="D2_Other1" name="D2_Other1">
                                <label for="D2_Other1" class="font-weight-normal">
                                    Other 1
                                </label>
                                <input type="text" class="form-control form-control-sm" id="D2_Other1Detail" placeholder="Enter text" disabled />
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group clearfix">
                            <div class="icheck-primary d-inline">
                                <input type="checkbox" id="D2_CustomerOfCustomer" name="D2_CustomerOfCustomer">
                                <label for="D2_CustomerOfCustomer" class="font-weight-normal">
                                    Customer of Customer
                                </label>
                                <input type="text" class="form-control form-control-sm" id="D2_CustomerOfCustomerDetail" placeholder="Enter text" disabled />
                            </div>
                            <br />
                            <div class="icheck-primary d-inline">
                                <input type="checkbox" id="D2_AircraftOperators" name="D2_AircraftOperators">
                                <label for="D2_AircraftOperators" class="font-weight-normal">
                                    Aircraft Operators
                                </label>
                                <input type="text" class="form-control form-control-sm" id="D2_AircraftOperatorsDetail" placeholder="Enter text" disabled />
                            </div>
                            <br />
                            <div class="icheck-primary d-inline">
                                <input type="checkbox" id="D2_SpareParts" name="D2_SpareParts">
                                <label for="D2_SpareParts" class="font-weight-normal">
                                    Spare Parts
                                </label>
                                <input type="text" class="form-control form-control-sm" id="D2_SparePartsDetail" placeholder="Enter text" disabled />
                            </div>
                            <br />
                            <div class="icheck-primary d-inline">
                                <input type="checkbox" id="D2_Other2" name="D2_Other2">
                                <label for="D2_Other2" class="font-weight-normal">
                                    Other 2
                                </label>
                                <input type="text" class="form-control form-control-sm" id="D2_Other2Detail" placeholder="Enter text" disabled />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <span>Problem part earliest known occurrence date</span>
                            <input type="date" class="form-control form-control-sm col-sm-3" id="D2_ProblemPartEarliestKnownOccurrenceDateValue" />


                        </div>
                    </div>

                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <span>Problem part earliest known awareness date</span>
                            <input type="date" class="form-control form-control-sm col-sm-3" id="D2_ProblemPartEarliestKnownAwarenessDateValue" />

                        </div>
                    </div>

                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <span>Problem part earliest known shipment date</span>
                            <input type="date" class="form-control form-control-sm col-sm-3" id="D2_ProblemPartEarliestKnownShipmentDateValue" />


                        </div>
                    </div>

                </div>

                <div class="row">
                    <div class="col-md-6">
                        <p style="margin-bottom:5px;"><strong>Conform Attachments</strong> </p>
                        <div class="row">
                            <input type="file" id="D2_ConformAttachments" name="d2_ConformAttachments" />
                        </div>
                    </div>
                    <div class="col-md-6">
                        <p style="margin-bottom:5px;"><strong>Non-Conform Attachments</strong> </p>
                        <div class="row">
                            <input type="file" id="D2_NonConformAttachments" name="d2_NonConformAttachments" />
                        </div>
                    </div>
                </div>
                <p style="margin-bottom:5px;">Attachments</p>
                <div class="row">
                    <input type="file" id="D2_Attachments" name="d2_attachments" multiple />
                </div>
                <!-- /.card-body -->

            </div>
            <!-- /.card -->
        </div>
    </div>
</div>
@* D3 *@
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title mr-1 text-bold" style="align-self:center;">D3: </h3><h3 class="card-title">Develop Containment Actions </h3> <small> | Eliminate or significantly reduce the effects of the failure mode on the cust</small>
                <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="form-group">
                        <div class="icheck-primary d-inline">
                            <input type="checkbox" id="D3_CopyFromD0" name="D3_CopyFromD0">
                            <label for="D3_CopyFromD0" class="font-weight-normal">
                                Containment in place and effective (From D0)
                            </label>
                        </div>
                    </div>
                </div>
                <div class="row">
                    @{
                        <table class="table table-sm table-striped table-valign-middle table-bordered">
                            <thead>
                                <tr>
                                    <th>Action</th>
                                    <th>Team member</th>
                                    <th>Date Start</th>
                                    <th>Metric</th>
                                    <th>% Eff.</th>
                                    <th>Part ID</th>
                                    <th>Date Finish</th>
                                    <th>Add/Edit</th>
                                </tr>
                            </thead>
                            <tbody id="actionTaskBody_D3">
                                <tr class="actionTask_D3" id="actionTask_D3_1" data-id="1">
                                    <td class="form-group" style="width:300px;">
                                        <textarea class="form-control form-control-sm" id="D3_Action_1" name="D3_Action_1" rows="1" required></textarea>
                                    </td>
                                    <td class="form-group" style="width:300px;">

                                        <select class="form-control form-control-sm select2" id="D3_TeamMember_1" name="D3_TeamMember_1" style="width: 100%;" data-id="1">
                                            <option value="" selected disabled>-- select --</option>
                                            @foreach (var item in Model.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                            {
                                                <option value="@item.EmpId"
                                                        data-domainid="@item.EmpDomainId"
                                                        data-name="@item.EmpFullnameEN"
                                                        data-email="@item.EmpEmail"
                                                        data-position="@item.EmpPositionName"
                                                        data-section="@item.EmpSectionName"
                                                        data-department="@item.EmpDepartmentName">
                                                    @item.EmpFullnameEN
                                                </option>
                                            }

                                        </select>
                                    </td>
                                    <td class="form-group">
                                        <input type="date" class="form-control form-control-sm" id="D3_DateStartValue_1" />


                                    </td>
                                    <td class="form-group">
                                        <input type="number" class="form-control form-control-sm" id="D3_Metric_1" name="D3_Metric_1" required />
                                    </td>
                                    <td class="form-group">
                                        <input type="number" class="form-control form-control-sm" id="D3_Eff_1" name="D3_Eff_1" required />
                                    </td>
                                    <td class="form-group">
                                        <input type="text" class="form-control form-control-sm" id="D3_PartId_1" name="D3_PartId_1" required />
                                    </td>
                                    <td class="form-group">
                                        <input type="date" class="form-control form-control-sm" id="D3_DateFinishValue_1" />


                                    </td>
                                    <td class="text-center">
                                        <a href="javascript:void(0)" id="addAction_D3">
                                            <i class="fas fa-plus text-success"></i>
                                        </a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    }
                </div>
                <p style="margin-bottom:5px;">Attachments</p>
                <div class="row">
                    <input type="file" multiple id="D3_Attachments" name="d3_attachments" />
                </div>
            </div>
        </div>
    </div>
</div>
@* D4 *@
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title mr-1 text-bold" style="align-self:center;">D4: </h3><h3 class="card-title">Identify and Verify Root Causes |</h3> <small>  Identify & verify all causes that explain the occurrence of the failure mode</small>
                <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <table class="table table-sm table-striped table-valign-middle table-bordered">
                        <thead>
                            <tr>
                                <th>Cause source</th>
                                <th>Cause description</th>
                                <th>Verified</th>
                                <th>Date</th>
                                <th>Verification method(attached)</th>
                                <th>Add/Edit</th>
                            </tr>
                        </thead>
                        <tbody id="actionTaskBody_D4">
                            <tr class="actionTask_D4" id="actionTask_D4_1" data-id="1">
                                <td class="form-group" style="width:300px;">
                                    <select class="form-control form-control-sm" id="D4_CauseSource_1" name="D4_CauseSource_1">
                                        <option value="" disabled selected>--select--</option>
                                        @foreach (var c in Model.RefCauseSources.OrderBy(o => o.Description))
                                        {
                                            <option value="@c.Id">@c.Description</option>

                                        }

                                    </select>
                                </td>
                                <td class="form-group" style="width:300px;">
                                    <textarea class="form-control form-control-sm" id="D4_CauseSourceDescription_1" name="D4_CauseSourceDescription_1" rows="1" required></textarea>

                                </td>
                                <td class="form-group text-center">
                                    <div class="icheck-success d-inline">
                                        <input type="checkbox" id="D4_Verified_1" name="D4_Verified_1">
                                        <label for="D4_Verified_1" class="font-weight-normal">

                                        </label>
                                    </div>

                                </td>
                                <td class="form-group">
                                    <input type="date" class="form-control form-control-sm" id="D4_DateValue_1" />



                                </td>
                                <td class="form-group">
                                    <textarea class="form-control form-control-sm" id="D4_VerificationMethod_1" name="D4_VerificationMethod_1" rows="1" required></textarea>

                                </td>
                                <td class="text-center">
                                    <a href="javascript:void(0)" id="addAction_D4">
                                        <i class="fas fa-plus text-success"></i>
                                    </a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="row">
                    <div class="col-sm-3">
                        <span>Has Escape Point Causes been addressed?</span>
                    </div>
                    <div class="col-sm-6">
                        <!-- radio -->
                        <div class="form-group clearfix D4_HasEscapePointCausesBeenaddressedGroup">
                            <div class="icheck-danger d-inline">
                                <input type="radio" id="D4_HasEscapePointCausesBeenaddressed_1" class="D4_HasEscapePointCausesBeenaddressedCheck" name="D4_HasEscapePointCausesBeenaddressed_1" value="false">
                                <label for="D4_HasEscapePointCausesBeenaddressed_1">
                                    No
                                </label>
                            </div>
                            <div class="icheck-success d-inline">
                                <input type="radio" id="D4_HasEscapePointCausesBeenaddressed_2" class="D4_HasEscapePointCausesBeenaddressedCheck" name="D4_HasEscapePointCausesBeenaddressed_1" value="true">
                                <label for="D4_HasEscapePointCausesBeenaddressed_2">
                                    Yes
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-3">
                        <span>Can Causes Explain differences in IS/IS NOT chart?</span>
                    </div>
                    <div class="col-sm-6">
                        <!-- radio -->
                        <div class="form-group clearfix D4_CanCausesExplainDifferencesGroup">
                            <div class="icheck-danger d-inline">
                                <input type="radio" id="D4_CanCausesExplainDifferences_1" class="D4_CanCausesExplainDifferencesCheck" name="D4_CanCausesExplainDifferences_1" value="false">
                                <label for="D4_CanCausesExplainDifferences_1">
                                    No
                                </label>
                            </div>
                            <div class="icheck-success d-inline">
                                <input type="radio" id="D4_CanCausesExplainDifferences_2" class="D4_CanCausesExplainDifferencesCheck" name="D4_CanCausesExplainDifferences_1" value="true">
                                <label for="D4_CanCausesExplainDifferences_2">
                                    Yes
                                </label>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="row">
                    <div class="col-sm-3">
                        <span>Identify Causes in Process FMEA?</span>
                    </div>
                    <div class="col-sm-6">
                        <!-- radio -->
                        <div class="form-group clearfix D4_IdentifyCausesInProcessFMEAGroup">
                            <div class="icheck-danger d-inline">
                                <input type="radio" id="D4_IdentifyCausesInProcessFMEA_1" class="D4_IdentifyCausesInProcessFMEACheck" name="D4_IdentifyCausesInProcessFMEA_1" value="false">
                                <label for="D4_IdentifyCausesInProcessFMEA_1">
                                    No
                                </label>
                            </div>
                            <div class="icheck-success d-inline">
                                <input type="radio" id="D4_IdentifyCausesInProcessFMEA_2" class="D4_IdentifyCausesInProcessFMEACheck" name="D4_IdentifyCausesInProcessFMEA_1" value="true">
                                <label for="D4_IdentifyCausesInProcessFMEA_2">
                                    Yes
                                </label>
                            </div>
                        </div>
                    </div>

                </div>
                <p style="margin-bottom:5px;"><strong>Identify the cause</strong> </p>
                <div class="row">
                    <div class="col-6">
                        <div class="form-group">
                            <div class="icheck-primary d-inline">
                                <input type="checkbox" id="D4_FishboneCheck" name="D4_FishboneCheck">
                                <label for="D4_FishboneCheck" class="font-weight-normal">
                                    Fish bone
                                </label>
                            </div>
                        </div>
                        <div class="row fishbone d-none">
                            <div class="form-group col-12">
                                <span>Main</span>
                                <textarea class="form-control" placeholder="Enter comment" id="FishBone_Main"></textarea>
                            </div>
                        </div>
                        <div class="row fishbone d-none">
                            <div class="form-group col-12">
                                <span>Machine</span>
                                <textarea class="form-control" placeholder="Enter comment" id="FishBone_Machine"></textarea>
                            </div>
                        </div>
                        <div class="row fishbone d-none">
                            <div class="form-group col-12">
                                <span>Manufacturing</span>
                                <textarea class="form-control" placeholder="Enter comment" id="FishBone_Manufacturing"></textarea>
                            </div>
                        </div>
                        <div class="row fishbone d-none">
                            <div class="form-group col-12">
                                <span>Measurement</span>
                                <textarea class="form-control" placeholder="Enter comment" id="FishBone_Measurement"></textarea>
                            </div>
                        </div>
                        <div class="row fishbone d-none">
                            <div class="form-group col-12">
                                <span>Material</span>
                                <textarea class="form-control" placeholder="Enter comment" id="FishBone_Material"></textarea>
                            </div>
                        </div>
                        <div class="row fishbone d-none">
                            <div class="form-group col-12">
                                <span>Environment</span>
                                <textarea class="form-control" placeholder="Enter comment" id="FishBone_Environment"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="form-group">
                            <div class="icheck-primary d-inline">
                                <input type="checkbox" id="FiveWhy" name="FiveWhy">
                                <label for="FiveWhy" class="font-weight-normal">
                                    The 5 Whys
                                </label>
                            </div>
                        </div>
                        <div class="row fivewhy d-none">
                            <div class="form-group col-6">
                                <span>Define the problem</span>
                                <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_DefineTheProblem"></textarea>
                            </div>
                            <div class="form-group col-6">
                            </div>
                        </div>
                        <div class="row fivewhy d-none">
                            <div class="form-group col-6">
                                <span>Why is happening?</span>
                                <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_Why1"></textarea>
                            </div>
                            <div class="form-group col-6">
                                <span>How it happening?</span>
                                <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_How1"></textarea>
                            </div>
                        </div>
                        <div class="row fivewhy d-none">
                            <div class="form-group col-6">
                                <span>Why is that?</span>
                                <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_Why2"></textarea>
                            </div>
                            <div class="form-group col-6">
                                <span>How it happening?</span>
                                <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_How2"></textarea>
                            </div>
                        </div>
                        <div class="row fivewhy d-none">
                            <div class="form-group col-6">
                                <span>Why is that?</span>
                                <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_Why3"></textarea>
                            </div>
                            <div class="form-group col-6">
                                <span>How it happening?</span>
                                <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_How3"></textarea>
                            </div>
                        </div>
                        <div class="row fivewhy d-none">
                            <div class="form-group col-6">
                                <span>Why is that?</span>
                                <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_Why4"></textarea>
                            </div>
                            <div class="form-group col-6">
                                <span>How it happening?</span>
                                <textarea class="form-control" placeholder="Enter comment" id="FiveWhy_How4"></textarea>
                            </div>
                        </div>
                    </div>

                </div>
                <p style="margin-bottom:5px;">Attachments</p>
                <div class="row">
                    <input type="file" multiple id="D4_Attachments" name="d4_attachments" />
                </div>
            </div>
        </div>
    </div>
</div>
@* D5 *@
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title mr-1 text-bold" style="align-self:center;">D5: </h3><h3 class="card-title">Identify Corrective Action | </h3> <small>  Identify & verify all causes that explain the occurrence of the failure mode</small>
                <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <table class="table table-sm table-striped table-bordered table-valign-middle">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Cause source</th>
                                <th>Select permanent correct Action(s)</th>
                                <th>Verifed</th>
                                <th>Date</th>
                                <th>Verification method</th>
                                <th>Add/Edit</th>

                            </tr>
                        </thead>
                        <tbody id="actionTaskBody_D5">
                            <tr class="actionTask_D5" id="actionTask_D5_1" data-id="1">
                                <td>
                                    1
                                </td>
                                <td>
                                    <select class="form-control form-control-sm" id="D5_CauseSource_1" name="D5_CauseSource_1">
                                        <option value="" disabled selected>--select--</option>
                                        @foreach (var c in Model.RefCauseSources.OrderBy(o => o.Description))
                                        {
                                            <option value="@c.Id">@c.Description</option>
                                        }
                                    </select>
                                </td>
                                <td>
                                    <textarea class="form-control form-control-sm" id="D5_PermanentCorrectAction_1" name="D5_PermanentCorrectAction_1" rows="1" required></textarea>

                                </td>
                                <td class="form-group text-center">
                                    <div class="icheck-success d-inline">
                                        <input type="checkbox" id="D5_Verified_1">
                                        <label for="D5_Verified_1" class="font-weight-normal">

                                        </label>
                                    </div>

                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D5_DateValue_1" />

                                </td>
                                <td>
                                    <textarea class="form-control form-control-sm" id="D5_VerificationMethod_1" name="D5_VerificationMethod_1" rows="1" required></textarea>
                                </td>

                                <td class="text-center">
                                    <a href="javascript:void(0)" id="addAction_D5">
                                        <i class="fas fa-plus text-success"></i>
                                    </a>
                                </td>


                            </tr>

                        </tbody>
                    </table>
                </div>
                <p style="margin-bottom:5px;">Attachments</p>
                <div class="row">
                    <input type="file" multiple id="D5_Attachments" name="d5_attachments" />
                </div>
            </div>
        </div>
    </div>
</div>
@* D6 *@
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title mr-1 text-bold" style="align-self:center;">D6: </h3><h3 class="card-title">Implement Corrective Action | </h3> <small>  Define and execute an implementation plan for the corrective action.</small>
                <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <table class="table table-sm table-striped table-bordered table-valign-middle">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Select permanent correct Action(s) - PCA</th>
                                <th>PCA Implementation plan </th>
                                <th style="width:300px;">Team menber</th>
                                <th style="width:180px;">Implementation Date</th>
                                <th>Customer concurrence</th>
                                <th>PCA Status</th>
                                <th>Add/Edit</th>
                            </tr>
                        </thead>
                        <tbody id="actionTaskBody_D6">
                            <tr class="actionTask_D6" id="actionTask_D6_1" data-id="1">
                                <td>
                                    1
                                </td>
                                <td>
                                    <textarea class="form-control form-control-sm" id="D6_PermenentCorrectiveAction_1" name="D6_PermenentCorrectiveAction_1" rows="1" required></textarea>

                                </td>
                                <td>
                                    <textarea class="form-control form-control-sm" id="D6_ImplementationPlan_1" name="D6_ImplementationPlan_1" rows="1" required></textarea>
                                </td>
                                <td>
                                    <select class="form-control form-control-sm select2" id="D6_TeamMember_1" name="D6_TeamMember_1" style="width: 100%;" data-id="1">
                                        <option value="" selected disabled>-- select --</option>
                                        @foreach (var item in Model.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                        {
                                            <option value="@item.EmpFullnameEN"
                                                    data-domainid="@item.EmpDomainId"
                                                    data-name="@item.EmpFullnameEN"
                                                    data-email="@item.EmpEmail"
                                                    data-position="@item.EmpPositionName"
                                                    data-section="@item.EmpSectionName"
                                                    data-department="@item.EmpDepartmentName">
                                                @item.EmpFullnameEN
                                            </option>
                                        }
                                    </select>
                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D6_DateValue_1" name="D6_DateValue_1" />
                                </td>
                                <td>
                                    <div class="form-group clearfix D6_CustomerConcurrenceGroup">
                                        <div class="icheck-danger d-inline">
                                            <input type="radio" id="D6_CustomerConcurrence_No_1" class="D6_CustomerConcurrenceCheck" name="D6_CustomerConcurrence_1" value="false">
                                            <label for="D6_CustomerConcurrence_No_1">
                                                No
                                            </label>
                                        </div>
                                        <div class="icheck-success d-inline">
                                            <input type="radio" id="D6_CustomerConcurrence_Yes_1" class="D6_CustomerConcurrenceCheck" name="D6_CustomerConcurrence_1" value="true">
                                            <label for="D6_CustomerConcurrence_Yes_1">
                                                Yes
                                            </label>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <select class="form-control form-control-sm" id="D6_PCAStatus_1" name="D6_PCAStatus_1">
                                        <option value="" selected disabled>-- select --</option>
                                        @foreach (var p in Model.RefPCAStatuses.OrderBy(o => o.Name))
                                        {
                                            <option value="@p.Id">@p.Name</option>
                                        }
                                    </select>
                                </td>
                                <td class="text-center">
                                    <a href="javascript:void(0)" id="addAction_D6">
                                        <i class="fas fa-plus text-success"></i>
                                    </a>
                                </td>

                            </tr>

                        </tbody>
                    </table>
                </div>
                <p style="margin-bottom:5px;">Attachments</p>
                <div class="row">
                    <input type="file" id="D6_Attachments" name="d6_attachments" multiple />
                </div>
            </div>
        </div>
    </div>
</div>
@* D7 *@
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title mr-1 text-bold" style="align-self:center;">D7: </h3><h3 class="card-title">Define and plan preventive action | </h3> <small> Modify systems to Prevent Recurrence of this and similar problems. Recommend systemic improvements</small>
                <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            </div>
            <div class="card-body">
                @* D7A *@
                <div class="row">
                    <table class="table table-sm table-bordered table-striped table-valign-middle">
                        <thead>
                            <tr>
                                <th>7A</th>
                                <th>Select preventive Action -PA</th>
                                <th>PA Implementation plan </th>
                                <th style="width:300px;">Team menber</th>
                                <th>Target Date</th>
                                <th>Actual Date</th>
                                <th>PA Status</th>
                                <th>Add/Edit</th>
                            </tr>
                        </thead>
                        <tbody id="actionTaskBody_D7A">
                            <tr class="actionTask_D7A" id="actionTask_D7A_1" data-id="1">
                                <td>
                                    1
                                </td>
                                <td>
                                    <textarea class="form-control form-control-sm" id="D7A_SelectedPreventiveAction_1" name="D7A_SelectedPreventiveAction_1" rows="1" required></textarea>

                                </td>
                                <td>
                                    <textarea class="form-control form-control-sm" id="D7A_ImplementationPlan_1" name="D7A_ImplementationPlan_1" rows="1" required></textarea>

                                </td>
                                <td>
                                    <select class="form-control form-control-sm select2" id="D7A_TeamMember_1" name="D7A_TeamMember_1" style="width: 100%;" data-id="1">
                                        <option value="" selected disabled>-- select --</option>
                                        @foreach (var e in Model.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                        {
                                            <option value="@e.EmpId"
                                                    data-domainid="@e.EmpDomainId"
                                                    data-name="@e.EmpFullnameEN"
                                                    data-email="@e.EmpEmail"
                                                    data-position="@e.EmpPositionName"
                                                    data-section="@e.EmpSectionName"
                                                    data-department="@e.EmpDepartmentName">
                                                @e.EmpFullnameEN
                                            </option>
                                        }
                                    </select>
                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7A_TargetDateValue_1" name="D7A_TargetDateValue_1" />


                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7A_ActualDate_1" name="D7A_ActualDate_1" />

                                </td>
                                <td>
                                    <select class="form-control form-control-sm" id="D7A_PCAStatus_1" name="D7A_PCAStatus_1">
                                        <option value="" selected disabled>-- select --</option>
                                        @foreach (var p in Model.RefPCAStatuses.OrderBy(o => o.Name))
                                        {
                                            <option value="@p.Id">@p.Name</option>
                                        }
                                    </select>
                                </td>
                                <td class="text-center">
                                    <a href="javascript:void(0)" id="addAction_D7A">
                                        <i class="fas fa-plus text-success"></i>
                                    </a>
                                </td>

                            </tr>

                        </tbody>
                    </table>
                </div>
                @* D7B *@
                <div class="row">
                    <table class="table table-sm table-striped table-valign-middle table-bordered">
                        <thead>
                            <tr>
                                <th><strong>7B</strong></th>
                                <th colspan="4">List smilar Processes/ Items with the potential of the same defect</th>

                            </tr>
                            <tr>
                                <th>No</th>
                                <th>Process/Item</th>
                                <th>Responsible </th>
                                <th style="width:180px;">Plan Veridation Date</th>
                                <th style="width:50px;">Add/Edit</th>
                            </tr>
                        </thead>
                        <tbody id="actionTaskBody_D7B">
                            <tr class="actionTask_D7B" id="actionTask_D7B_1" data-id="1">
                                <td>
                                    1
                                </td>
                                <td>
                                    <textarea class="form-control form-control-sm" id="D7B_ProcessItem_1" name="D7B_ProcessItem_1" rows="1" required></textarea>

                                </td>
                                <td>
                                    <textarea class="form-control form-control-sm" id="D7B_Responsible_1" name="D7B_Responsible_1" rows="1" required></textarea>
                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7B_PlanValidationDateValue_1" />


                                </td>
                                <td class="text-center">
                                    <a href="javascript:void(0)" id="addAction_D7B">
                                        <i class="fas fa-plus text-success"></i>
                                    </a>
                                </td>
                            </tr>

                        </tbody>
                    </table>
                </div>
                @* D7C *@
                <div class="row">
                    <table class="table table-sm table-striped table-valign-middle table-bordered">
                        <thead>
                            <tr>
                                <th><strong>7C</strong></th>
                                <th colspan="5">Reviewed and revised if necessary the folowing</th>

                            </tr>
                            <tr>
                                <th rowspan="2">No</th>
                                <th rowspan="2">Reviewed document</th>
                                <th rowspan="2">Nature of revision </th>
                                <th rowspan="2">Resp.</th>
                                <th colspan="2">Review Completion Date</th>
                            </tr>
                            <tr>
                                <th style="width:150px;">Plan</th>
                                <th style="width:150px;">Actual</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    1
                                </td>
                                <td>
                                    Quality awareness communication
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Description_1" placeholder="Revision description"></textarea></td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_1" placeholder="Name"></textarea></td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_1" />


                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_1" />


                                </td>
                            </tr>
                            <tr>
                                <td>
                                    2
                                </td>
                                <td>
                                    Design FMEA
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Description_2" placeholder="Revision description"></textarea></td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_2" placeholder="Name"></textarea></td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_2" />


                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_2" />


                                </td>
                            </tr>
                            <tr>
                                <td>
                                    3
                                </td>
                                <td>
                                    Process Flow Chart
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Description_3" placeholder="Revision description"></textarea></td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_3" placeholder="Name"></textarea></td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_3" />

                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_3" />


                                </td>

                            </tr>
                            <tr>
                                <td>
                                    4
                                </td>
                                <td>
                                    Process FMEA
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Description_4" placeholder="Revision description"></textarea></td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_4" placeholder="Name"></textarea></td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_4" />


                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_4" />


                                </td>

                            </tr>
                            <tr>
                                <td>
                                    5
                                </td>
                                <td>
                                    Process Control Plan
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Description_5" placeholder="Revision description"></textarea></td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_5" placeholder="Name"></textarea></td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_5" />


                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_5" />


                                </td>

                            </tr>
                            <tr>
                                <td>
                                    6
                                </td>
                                <td>
                                    Work Instructions
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Description_6" placeholder="Revision description"></textarea></td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_6" placeholder="Name"></textarea></td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_6" />


                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_6" />


                                </td>

                            </tr>
                            <tr>
                                <td>
                                    7
                                </td>
                                <td>
                                    Inspection standard - Receiving
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Description_7" placeholder="Revision description"></textarea></td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_7" placeholder="Name"></textarea></td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_7" />


                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_7" />


                                </td>
                            </tr>
                            <tr>
                                <td>
                                    8
                                </td>
                                <td>
                                    Inspection standard - Shipping
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Description_8" placeholder="Revision description"></textarea></td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_8" placeholder="Name"></textarea></td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_8" />

                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_8" />


                                </td>

                            </tr>
                            <tr>
                                <td>
                                    9
                                </td>
                                <td>
                                    PPAP resubmission
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Description_9" placeholder="Revision description"></textarea></td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_9" placeholder="Name"></textarea></td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_9" />


                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_9" />


                                </td>

                            </tr>
                            <tr>
                                <td>
                                    10
                                </td>
                                <td>
                                    Process Change Request
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Description_10" placeholder="Revision description"></textarea></td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_10" placeholder="Name"></textarea></td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_10" />


                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_10" />

                                </td>

                            </tr>
                            <tr>
                                <td>
                                    11
                                </td>
                                <td>
                                    Engineering Change Request
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Description_11" placeholder="Revision description"></textarea></td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_11" placeholder="Name"></textarea></td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_11" />


                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_11" />


                                </td>

                            </tr>
                            <tr>
                                <td>
                                    12
                                </td>
                                <td>
                                    Change Authorization
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Description_12" placeholder="Revision description"></textarea></td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_12" placeholder="Name"></textarea></td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_12" />


                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_12" />

                                </td>

                            </tr>
                            <tr>
                                <td>
                                    13
                                </td>
                                <td>
                                    Other
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Description_13" placeholder="Revision description"></textarea></td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_13" placeholder="Name"></textarea></td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_13" />


                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_13" />


                                </td>

                            </tr>
                            <tr>
                                <td>
                                    14
                                </td>
                                <td>
                                    Relevant QMS practices
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Description_14" placeholder="Revision description"></textarea></td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_14" placeholder="Name"></textarea></td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_14" />


                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_14" />


                                </td>

                            </tr>
                            <tr>
                                <td>
                                    15
                                </td>
                                <td>
                                    Read across action taken
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Description_15" placeholder="Revision description"></textarea></td>
                                <td><textarea class="form-control form-control-sm" id="D7C_Resp_15" placeholder="Name"></textarea></td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDatePlanValue_15" />


                                </td>
                                <td>
                                    <input type="date" class="form-control form-control-sm" id="D7C_ReviewCompletionDateActualValue_15" />


                                </td>

                            </tr>
                        </tbody>
                    </table>
                </div>
                <p style="margin-bottom:5px;">Attachments</p>
                <div class="row">
                    <input type="file" multiple id="D7_Attachments" name="d7_attachments" />
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title mr-1 text-bold" style="align-self:center;">D8: </h3><h3 class="card-title">Define and plan preventive action | </h3> <small> Modify systems to Prevent Recurrence of this and similar problems. Recommend systemic improvements</small>
                <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <table class="table table-sm table-bordered table-striped table-valign-middle table-bordered">
                            <thead>
                                <tr>
                                    <th><strong>8A</strong></th>
                                    <th colspan="3">Follow-up Meeting</th>

                                </tr>
                                <tr>
                                    <th>No</th>
                                    <th>Planed Date</th>
                                    <th>Actual Date </th>
                                    <th class="text-center">Add/Edit</th>
                                </tr>
                            </thead>
                            <tbody id="actionTaskBody_D8A">
                                <tr class="actionTask_D8A" id="actionTask_D8A_1" data-id="1">
                                    <td>
                                        1
                                    </td>
                                    <td>
                                        <input type="date" class="form-control form-control-sm" id="D8_PlanDateValue_1" />

                                    </td>
                                    <td>
                                        <input type="date" class="form-control form-control-sm" id="D8_ActualDateValue_1" />


                                    </td>
                                    <td class="text-center">
                                        <a href="javascript:void(0)" id="addAction_D8A">
                                            <i class="fas fa-plus text-success"></i>
                                        </a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                @* D8_B *@
                <div class="row d-none">
                    <table class="table table-sm table-striped table-valign-middle table-bordered">
                        <thead>
                            <tr>
                                <th><strong>8B</strong></th>
                                <th colspan="4">Closure &amp; Sign-off</th>

                            </tr>
                            <tr>
                                <th>No</th>
                                <th>Verification</th>
                                <th>Title </th>
                                <th>Signature </th>
                                @*<th>Date</th>*@
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    1
                                </td>
                                <td>
                                    Vendor management
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D8_B_TitleOfVendor" rows="1" placeholder="Title"></textarea></td>
                                <td>
                                    <div class="col-sm-6">
                                        <!-- radio -->
                                        <div class="form-group clearfix D8_B_ReviewGroup">
                                            <div class="icheck-success d-inline">
                                                <input type="radio" id="D8_B_Approve" name="D8_B_Review">
                                                <label for="D8_B_Approve">
                                                    Approve
                                                </label>
                                            </div>
                                            <div class="icheck-danger d-inline">
                                                <input type="radio" id="D8_B_Disapprove" name="D8_B_Review">
                                                <label for="D8_B_Disapprove">
                                                    Disapprove
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                @*<td><span>20/01/2022</span></td>*@
                            </tr>
                            <tr>
                                <td>
                                    2
                                </td>
                                <td>
                                    Customer
                                </td>
                                <td><textarea class="form-control form-control-sm" id="D8_B_TitleOfCustomer" rows="1" placeholder="Title"></textarea></td>
                                <td><input class="form-control form-control-sm" placeholder="Signature" /></td>
                                @*<td><span>20/01/2022</span></td>*@
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="row d-none">
                    <table class="table table-sm table-striped table-valign-middle table-bordered">
                        <thead>
                            <tr>
                                <th><strong>8C</strong></th>
                                <th colspan="2">Closure &amp; Sign-off</th>

                            </tr>
                            <tr>
                                <th>When</th>
                                <th>Where</th>
                                <th>How </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <input class="form-control" placeholder="When" />
                                </td>
                                <td>
                                    <textarea class="form-control" rows="1" placeholder="Description"></textarea>
                                </td>
                                <td><textarea class="form-control" rows="1" placeholder="How"></textarea></td>

                            </tr>
                        </tbody>
                    </table>
                </div>
                <p style="margin-bottom:5px;">Attachments</p>
                <div class="row">
                    <input type="file" multiple id="D8_Attachments" name="d8_attachments" />
                </div>
            </div>
        </div>
    </div>
</div>
@section Scripts {
    <script type="text/javascript">
        //$(function () {
        $(document).ready(function () {
            $(document).on('click', '[data-toggle="lightbox"]', function (event) {
                event.preventDefault();
                $(this).ekkoLightbox({
                    alwaysShowClose: true
                });

            });

            $('[data-mask]').inputmask();
            $('.select2bs4').select2({
                theme: 'bootstrap4'
            });
            $('.select2').select2();

            $('#D2_NonConformAttachments').on('change', function () {
                const fSize = this.files[0].size / 1024 / 1024;
                var fExt = this.files[0].type;

                if ((fExt === "image/png" || fExt === "image/jpeg") && fSize <= 20) {

                } else {
                    alert("Upload file extensions .jpg and .png. File size not over: 20 MB");
                    $('#D2_NonConformAttachments').val("");
                }

            });
            $('#D2_ConformAttachments').on('change', function () {
                const fSize = this.files[0].size / 1024 / 1024;
                var fExt = this.files[0].type;

                if ((fExt === "image/png" || fExt === "image/jpeg") && fSize <= 20) {

                } else {
                    alert("Upload file extensions .jpg and .png. File size not over: 20 MB");
                    $('#D2_ConformAttachments').val("");
                }

            });

            //D0
            $("#addAction").click(function (e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask").length + 1;

                var str = `
                     <tr class="actionTask" id="actionTask_${row}" data-id="${row}">
                                        <td class="form-group">
                                            <textarea class="form-control form-control-sm" id="D0_Action_${row}" name="D0_Action_${row}" rows="1" required></textarea>
                                        </td>
                                        <td class="form-group" style="width:300px;">
                                            <select class="form-control form-control-sm select2" id="D0_TeamMember_${row}" name="D0_TeamMember_${row}" style="width: 100%;" data-id="${row}">
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var e in Model.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                 {
                                                    <text>
                                                        str += `
                                                            <option value='@e.EmpId'
                                                                data-domainid='@e.EmpDomainId'
                                                                data-name='@e.EmpFullnameEN'
                                                                data-email='@e.EmpEmail'
                                                                data-position='@e.EmpPositionName'
                                                                data-section='@e.EmpSectionName'
                                                                data-department='@e.EmpDepartmentName'>
                                                                ` + `@e.EmpFullnameEN` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                                            str += ` </select>
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm inputdate" id="D0_DateStartValue_${row}" name="D0_DateStartValue_${row}"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D0_Metric_${row}" name="D0_Metric_${row}"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D0_Eff_${row}" name="D0_Eff_${row}"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="text" class="form-control form-control-sm" id="D0_PartId_${row}" name="D0_PartId_${row}"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D0_DateFinishValue_${row}" name="D0_DateFinishValue_${row}"  />
                                                    </td>
                                                    <td class="text-center">
                                                        <a href="javascript:void(0)" class="removeAction" data-id="${row}">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>
                                                    </td>
                                                </tr>
                                            `;

                $("#actionTaskBody").append(str);

                $(`.removeAction`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_${row}`).remove();
                });
                $('.select2').select2();
            });

            //D1
            $("#addAction_D1").click(function (e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask_D1").length + 1;

                var str = `
                     <tr class="actionTask_D1" id="actionTask_D1_${row}" data-id="${row}">

                                        <td class="form-group" >
                                            <select class="form-control form-control-sm" id="D1_Function_${row}" name="D1_Function_${row}" style="width: 100%;" data-id="${row}">
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var f in Model.RefFunctions.Where(w => w.Active).OrderBy(o => o.Description))
                                                 {
                                                    <text>
                                                        str += `
                                                            <option value='@f.Id' >
                                                                ` + `@f.Description` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                                            str += ` </select>
                                          </td>
                                          <td class="form-group" style="width:400px;">
                                             <select class="form-control form-control-sm select2" id="D1_TeamMember_${row}" name="D1_TeamMember_${row}" style="width: 100%;" data-id="${row}">
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var e in Model.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                 {
                                                    <text>
                                                        str += `
                                                            <option value='@e.EmpId'
                                                                data-domainid='@e.EmpDomainId'
                                                                data-name='@e.EmpFullnameEN'
                                                                data-email='@e.EmpEmail'
                                                                data-position='@e.EmpPositionName'
                                                                data-section='@e.EmpSectionName'
                                                                data-department='@e.EmpDepartmentName'>
                                                                ` + `@e.EmpFullnameEN` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                                            str += ` </select>
                                                    </td>

                                                   <td class="form-group" style="width:400px;">
                                             <select class="form-control form-control-sm select2" id="D1_EmailTeamMember_${row}" name="D1_EmailTeamMember_${row}" style="width: 100%;" data-id="${row}">
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var e in Model.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                 {
                                                    <text>
                                                        str += `
                                                            <option value='@e.EmpId'
                                                                data-domainid='@e.EmpDomainId'
                                                                data-name='@e.EmpFullnameEN'
                                                                data-email='@e.EmpEmail'
                                                                data-position='@e.EmpPositionName'
                                                                data-section='@e.EmpSectionName'
                                                                data-department='@e.EmpDepartmentName'>
                                                                ` + `@e.EmpEmail` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                                            str += ` </select>
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D1_DateStartValue_${row}" name="D1_DateStartValue_${row}"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="text" class="form-control form-control-sm" id="D1_PhoneNo_${row}" name="D1_PhoneNo_${row}" data-inputmask="'mask': ['999-999-9999 [x99999]', '+099 99 99 9999[9]-9999']" data-mask  />
                                                    </td>
                                                    <td class="text-center">
                                                        <a href="javascript:void(0)" class="removeAction_D1" data-id="${row}">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>
                                                    </td>
                                                </tr>
                                            `;

                $("#actionTaskBody_D1").append(str);

                $(`.removeAction_D1`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_D1_${row}`).remove();
                });
                $('.select2').select2();
                $('[data-mask]').inputmask();
            });

            //D3
            $("#addAction_D3").click(function (e) {
                AddD3(e);
            });

            function AddD3(e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask_D3").length + 1;

                var str = `
                     <tr class="actionTask_D3" id="actionTask_D3_${row}" data-id="${row}">
                                        <td class="form-group">
                                            <textarea class="form-control form-control-sm" id="D3_Action_${row}" name="D3_Action_${row}" rows="1" required></textarea>
                                        </td>
                                        <td class="form-group" style="width:300px;">
                                            <select class="form-control form-control-sm select2" id="D3_TeamMember_${row}" name="D3_TeamMember_${row}" style="width: 100%;" data-id="${row}">
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var e in Model.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                 {
                                                    <text>
                                                        str += `
                                                            <option value='@e.EmpId'
                                                                data-domainid='@e.EmpDomainId'
                                                                data-name='@e.EmpFullnameEN'
                                                                data-email='@e.EmpEmail'
                                                                data-position='@e.EmpPositionName'
                                                                data-section='@e.EmpSectionName'
                                                                data-department='@e.EmpDepartmentName'>
                                                                ` + `@e.EmpFullnameEN` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                                            str += ` </select>
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D3_DateStartValue_${row}" name="D3_DateStartValue_${row}"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D3_Metric_${row}" name="D3_Metric_${row}"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D3_Eff_${row}" name="D3_Eff_${row}"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="text" class="form-control form-control-sm" id="D3_PartId_${row}" name="D0_PartId_${row}"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D3_DateFinishValue_${row}" name="D3_DateFinishValue_${row}"  />
                                                    </td>
                                                    <td class="text-center">
                                                        <a href="javascript:void(0)" class="removeAction_D3" data-id="${row}">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>
                                                    </td>
                                                </tr>
                                            `;

                $("#actionTaskBody_D3").append(str);

                $(`.removeAction_D3`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_D3_${row}`).remove();
                });
                $('.select2').select2();
            }

            //D4
            $("#addAction_D4").click(function (e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask_D4").length + 1;

                var str = `
                     <tr class="actionTask_D4" id="actionTask_D4_${row}" data-id="${row}">
                                        <td class="form-group" >
                                            <select class="form-control form-control-sm" id="D4_CauseSource_${row}" name="D4_CauseSource_${row}" style="width: 100%;" data-id="${row}">
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var c in Model.RefCauseSources.Where(w => w.Active).OrderBy(o => o.Description))
                                                 {
                                                    <text>
                                                        str += `
                                                            <option value='@c.Id' >
                                                                ` + `@c.Description` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                                            str += ` </select>
                                          </td>
                                                    <td class="form-group">
                                                        <textarea class="form-control form-control-sm" id="D4_CauseSourceDescription_${row}" name="D4_CauseSourceDescription_${row}" rows="1" required></textarea>
                                                    </td>
                                                    <td class="form-group text-center" >

                                                        <div class="icheck-success d-inline">
                                                            <input type="checkbox" id="D4_Verified_${row}" name="D4_Verified_${row}">
                                                            <label for="D4_Verified_${row}" class="font-weight-normal">

                                                            </label>
                                                        </div>
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D4_DateValue_${row}" name="D4_DateValue_${row}"  />
                                                    </td>
                                                    <td class="form-group ">
                                                        <input type="text" class="form-control form-control-sm" id="D4_VerificationMethod_${row}" name="D4_VerificationMethod_${row}"  />
                                                    </td>
                                                    <td class="text-center">
                                                        <a href="javascript:void(0)" class="removeAction_D4" data-id="${row}">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>
                                                    </td>
                                                </tr>
                                            `;

                $("#actionTaskBody_D4").append(str);

                $(`.removeAction_D4`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_D4_${row}`).remove();
                });
                $('.select2').select2();
            });

            //D5
            $("#addAction_D5").click(function (e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask_D5").length + 1;

                var str = `
                     <tr class="actionTask_D5" id="actionTask_D5_${row}" data-id="${row}">
<td class="form-group">
${row}
                                                    </td>
                                        <td class="form-group" >
                                            <select class="form-control form-control-sm" id="D5_CauseSource_${row}" name="D5_CauseSource_${row}" style="width: 100%;" data-id="${row}">
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var c in Model.RefCauseSources.Where(w => w.Active).OrderBy(o => o.Description))
                                                 {
                                                    <text>
                                                        str += `
                                                            <option value='@c.Id' >
                                                                ` + `@c.Description` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                                            str += ` </select>
                                          </td>
                                                    <td class="form-group">
                                                        <textarea class="form-control form-control-sm" id="D5_PermanentCorrectAction_${row}" name="D5_PermanentCorrectAction_${row}" rows="1" required></textarea>
                                                    </td>
                                                    <td class="form-group text-center" >
                                                        <div class="icheck-success d-inline">
                                                            <input type="checkbox" id="D5_Verified_${row}" name="D5_Verified_${row}">
                                                            <label for="D5_Verified_${row}" class="font-weight-normal">
                                                            </label>
                                                        </div>
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D5_DateValue_${row}" name="D5_DateValue_${row}"  />
                                                    </td>
                                                    <td class="form-group ">
                                                        <input type="text" class="form-control form-control-sm" id="D5_VerificationMethod_${row}" name="D5_VerificationMethod_${row}"  />
                                                    </td>
                                                    <td class="text-center">
                                                        <a href="javascript:void(0)" class="removeAction_D5" data-id="${row}">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>
                                                    </td>
                                                </tr>
                                            `;

                $("#actionTaskBody_D5").append(str);

                $(`.removeAction_D5`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_D5_${row}`).remove();
                });
                $('.select2').select2();
            });

            //D6
            $("#addAction_D6").click(function (e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask_D6").length + 1;

                var str = `
                     <tr class="actionTask_D6" id="actionTask_D6_${row}" data-id="${row}">
<td class="form-group">
${row}
                                                    </td>
                                                   <td class="form-group">
                                                        <textarea class="form-control form-control-sm" id="D6_PermenentCorrectiveAction_${row}" name="D6_PermenentCorrectiveAction_${row}" rows="1" required></textarea>
                                                    </td>
                                                    <td class="form-group" >
                                                       <textarea class="form-control form-control-sm" id="D6_ImplementationPlan_${row}" name="D6_ImplementationPlan_${row}" rows="1" required></textarea>

                                                    </td>
                                                    <td class="form-group" style="width:300px;">
                                            <select class="form-control form-control-sm select2" id="D3_TeamMember_${row}" name="D3_TeamMember_${row}" style="width: 100%;" data-id="${row}">
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var e in Model.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                 {
                                                    <text>
                                                        str += `
                                                            <option value='@e.EmpId'
                                                                data-domainid='@e.EmpDomainId'
                                                                data-name='@e.EmpFullnameEN'
                                                                data-email='@e.EmpEmail'
                                                                data-position='@e.EmpPositionName'
                                                                data-section='@e.EmpSectionName'
                                                                data-department='@e.EmpDepartmentName'>
                                                                ` + `@e.EmpFullnameEN` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                                            str += ` </select>
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D6_DateValue_${row}" name="D6_DateValue_${row}"  />
                                                    </td>
                                                    <td class="form-group ">
                                                       <div class="form-group clearfix D6_CustomerConcurrenceGroup">
                                                            <div class="icheck-danger d-inline">
                                                                <input type="radio" id="D6_CustomerConcurrence_No_${row}" class="D6_CustomerConcurrenceCheck" name="D6_CustomerConcurrence_${row}" value="false">
                                                                <label for="D6_CustomerConcurrence_No_${row}">
                                                                    No
                                                                </label>
                                                            </div>
                                                            <div class="icheck-success d-inline">
                                                                <input type="radio" id="D6_CustomerConcurrence_Yes_${row}" class="D6_CustomerConcurrenceCheck" name="D6_CustomerConcurrence_${row}" value="true">
                                                                <label for="D6_CustomerConcurrence_Yes_${row}">
                                                                    Yes
                                                                </label>
                                                            </div>
                                                        </div>
                                                    </td>
                                            <td class="form-group" >
                                            <select class="form-control form-control-sm" id="D6_PCAStatus_${row}" name="D6_PCAStatus_${row}" style="width: 100%;" data-id="${row}">
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var c in Model.RefPCAStatuses.Where(w => w.Active).OrderBy(o => o.Name))
                                                 {
                                                    <text>
                                                        str += `
                                                            <option value='@c.Id' >
                                                                ` + `@c.Name` + `
                                                            </option>
                                                                                            `;
                                                   </text>
                                                }
                                            str += ` </select>
                                          </td>
                                                    <td class="text-center">
                                                        <a href="javascript:void(0)" class="removeAction_D5" data-id="${row}">
                                                            <i class="fas fa-minus text-danger"></i>
                                                        </a>
                                                    </td>
                                                </tr>
                                            `;

                $("#actionTaskBody_D6").append(str);

                $(`.removeAction_D6`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_D6_${row}`).remove();
                });
                $('.select2').select2();
            });

             //D7A
            $("#addAction_D7A").click(function (e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask_D7A").length + 1;

                var str = `
                     <tr class="actionTask_D7A" id="actionTask_D7A_${row}" data-id="${row}">
                        <td class="form-group">
                            ${row}
                        </td>
                        <td class="form-group">
                             <textarea class="form-control form-control-sm" id="D7A_SelectedPreventiveAction_${row}" name="D7A_SelectedPreventiveAction_${row}" rows="1" required></textarea>
                         </td>
                         <td class="form-group" >
                            <textarea class="form-control form-control-sm" id="D7A_ImplementationPlan_${row}" name="D7A_ImplementationPlan_${row}" rows="1" required></textarea>

                         </td>
                         <td class="form-group" style="width:300px;">
                             <select class="form-control form-control-sm select2" id="D7A_TeamMember_${row}" name="D7A_TeamMember_${row}" style="width: 100%;" data-id="${row}">
                                   <option value="" selected disabled>--select--</option> `;
                      @foreach (var e in Model.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                      {
                         <text>
                             str += `
                                 <option value='@e.EmpId'
                                     data-domainid='@e.EmpDomainId'
                                     data-name='@e.EmpFullnameEN'
                                     data-email='@e.EmpEmail'
                                     data-position='@e.EmpPositionName'
                                     data-section='@e.EmpSectionName'
                                     data-department='@e.EmpDepartmentName'>
                                     ` + `@e.EmpFullnameEN` + `
                                 </option>
                                                                 `;
                        </text>
                     }
                 str += ` </select>
                         </td>
                         <td class="form-group">
                             <input type="date" class="form-control form-control-sm" id="D7A_TargetDateValue_${row}" name="D7A_TargetDateValue_${row}"  />
                         </td>
                         <td class="form-group ">
                            <input type="date" class="form-control form-control-sm" id="D7A_ActualDate_${row}" name="D7A_ActualDate_${row}"  />
                         </td>
                 <td class="form-group" >
                 <select class="form-control form-control-sm" id="D7A_PCAStatus_${row}" name="D7A_PCAStatus_${row}" style="width: 100%;" data-id="${row}">
                     <option value="" selected disabled>--select--</option> `;
                      @foreach (var c in Model.RefPCAStatuses.Where(w => w.Active).OrderBy(o => o.Name))
                      {
                         <text>
                             str += `
                                 <option value='@c.Id' >
                                     ` + `@c.Name` + `
                                 </option>
                                                                 `;
                        </text>
                     }
                 str += ` </select>
               </td>
                         <td class="text-center">
                             <a href="javascript:void(0)" class="removeAction_D7A" data-id="${row}">
                                 <i class="fas fa-minus text-danger"></i>
                             </a>
                         </td>
                     </tr>
                 `;

                $("#actionTaskBody_D7A").append(str);

                $(`.removeAction_D7A`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_D7A_${row}`).remove();
                });
                $('.select2').select2();
            });

             //D7B
            $("#addAction_D7B").click(function (e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask_D7B").length + 1;

                var str = `
                     <tr class="actionTask_D7B" id="actionTask_D7B_${row}" data-id="${row}">
                        <td class="form-group">
                            ${row}
                        </td>
                        <td class="form-group">
                             <textarea class="form-control form-control-sm" id="D7B_ProcessItem_${row}" name="D7B_ProcessItem_${row}" rows="1" required></textarea>
                         </td>
                         <td class="form-group" >
                            <textarea class="form-control form-control-sm" id="D7B_Responsible_${row}" name="D7B_Responsible_${row}" rows="1" required></textarea>

                         </td>
                         <td class="form-group">
                             <input type="date" class="form-control form-control-sm" id="D7B_PlanValidationDateValue_${row}" name="D7B_PlanValidationDateValue_${row}"  />
                         </td>
                         <td class="text-center">
                             <a href="javascript:void(0)" class="removeAction_D7B" data-id="${row}">
                                 <i class="fas fa-minus text-danger"></i>
                             </a>
                         </td>
                     </tr>
                 `;

                $("#actionTaskBody_D7B").append(str);

                $(`.removeAction_D7B`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_D7B_${row}`).remove();
                });
                $('.select2').select2();
            });

            //D8A
            $("#addAction_D8A").click(function (e) {
                e.stopImmediatePropagation();

                const row = $(".actionTask_D8A").length + 1;

                var str = `
                     <tr class="actionTask_D8A" id="actionTask_D8A_${row}" data-id="${row}">
                        <td class="form-group">
                            ${row}
                        </td>
                        <td class="form-group">
                            <input type="date" class="form-control form-control-sm" id="D8_PlanDateValue_${row}" name="D8_PlanDateValue_${row}"  />
                         </td>
                         <td class="form-group" >
                            <input type="date" class="form-control form-control-sm" id="D8_ActualDateValue_${row}" name="D8_ActualDateValue_${row}"  />

                         </td>
                         <td class="text-center">
                             <a href="javascript:void(0)" class="removeAction_D8A" data-id="${row}">
                                 <i class="fas fa-minus text-danger"></i>
                             </a>
                         </td>
                     </tr>
                 `;

                $("#actionTaskBody_D8A").append(str);

                $(`.removeAction_D8A`).click(function (e) {
                    e.stopImmediatePropagation();

                    $(`#actionTask_D8A_${row}`).remove();
                });
                $('.select2').select2();
            });

            const Toast = Swal.mixin({
                toast: true,
                position: "center",
                showConfirmButton: false,
                timer: 3000,
            });

            $("#btnSave").click((e) => {
                //alert("call");
                e.stopImmediatePropagation();
                var data = new FormData();
                //HeaderReport
                data.append("CreateBy", '@creator.EmpId');
                data.append("CreateByName", '@creator.EmpFullnameEN');
                data.append("CreateByEmail", '@creator.EmpEmail');
                data.append("NcrNo", $('#NcrNo').val());
                data.append("DateOpened", $('#HeaderDateOpened').val());
                data.append("DateTargetedClosure", $('#HeaderDateTargetedClosure').val());
                data.append("DateClosed", $('#HeaderDateClosed').val());
                data.append("DateClosureD0", $('#DateClosureD0').val());
                data.append("DateClosureD1", $('#DateClosureD1').val());
                data.append("DateClosureD2", $('#DateClosureD2').val());
                data.append("DateClosureD3", $('#DateClosureD3').val());
                data.append("DateClosureD4", $('#DateClosureD4').val());
                data.append("DateClosureD5", $('#DateClosureD5').val());
                data.append("DateClosureD6", $('#DateClosureD6').val());
                data.append("DateClosureD7", $('#DateClosureD7').val());
                data.append("DateClosureD8", $('#DateClosureD8').val());
                data.append("DateEffectivenessCheck", $('#DateEffectivenessCheck').val());
                data.append("WorkFlowId",2);

                //D0
                data.append(`D0s[0].D0_Comment`, $("#D0_Comment").val());
                data.append(`D0s[0].D0_PartNumber`, $("#D0_PartNumber").val());
                data.append(`D0s[0].D0_PartDescription`, $("#D0_PartNumber").val());
                data.append(`D0s[0].D0_PONum`, $("#D0_PartNumber").val());
                data.append(`D0s[0].D0_POItem`, $("#D0_POItem").val());
                data.append(`D0s[0].D0_CustomerContact`, $("#D0_CustomerContact").val());
                data.append(`D0s[0].D0_WitnessedBy`, $("#D0_WitnessedBy").val());
                data.append(`D0s[0].D0_AffectedCustomerProduct`, $("#D0_AffectedCustomerProduct").val());
                data.append(`D0s[0].D0_CustomerReference`, $("#D0_CustomerReference").val());

                $("input[name='D0_DeliveryAffected_1']:checked").each(function (index) {
                    data.append("D0s[0].D0_DeliveryAffected", $(this).val());

                });

                $("input[name='D0_SuspectRootCauseIdentified_1']:checked").each(function (index) {
                    data.append("D0s[0].D0_SuspectRootCauseIdentified", $(this).val());

                });

                $("input[name='D0_RootCauseVerified_1']:checked").each(function (index) {
                    data.append("D0s[0].D0_RootCauseVerified", $(this).val());

                });
                $("input[name='D0_EmergencyRespondAction_1']:checked").each(function (index) {
                    data.append("D0s[0].D0_EmergencyRespondAction", $(this).val());

                });
                $("input[name='D0_RecurringProblem_1']:checked").each(function (index) {
                    data.append("D0s[0].D0_RecurringProblem", $(this).val());

                });

                $(".actionTask").each(function (index)
                {
                    var thisId = $(this).data("id");
                    var member = $(`#D0_TeamMember_${thisId}`).find(":selected");

                    if ($(`#D0_Action_${thisId}`).val() != "") {
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].Action`, $(`#D0_Action_${thisId}`).val());
                    }
                    if (member.val() != "") {
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].TeamMemberId`, member.val());
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].TeamMemberEmail`, member.data("email"));
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].TeamMemberName`, member.data("name"));
                    }
                    if ($(`#D0_DateStart_${thisId}`).val() != "") {
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].DateStart`, $(`#D0_DateStartValue_${thisId}`).val());
                    }
                    if ($(`#D0_DateFinish_${thisId}`).val() != "") {
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].DateFinish`, $(`#D0_DateFinishValue_${thisId}`).val());
                    }
                    if ($(`#D0_Metric_${thisId}`).val() != "") {
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].Metric`, $(`#D0_Metric_${thisId}`).val());
                    }
                    if ($(`#D0_Eff_${thisId}`).val() != "") {
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].Eff`, $(`#D0_Eff_${thisId}`).val());
                    }
                    if ($(`#D0_PartId_${thisId}`).val() != "") {
                        data.append(`D0s[0].D0_EmergencyRespondActions[${index}].PartId`, $(`#D0_PartId_${thisId}`).val());
                    }

                });

                var input = document.getElementById("D0_Attachments");
                if (typeof input != "undefined" && input != null) {
                    var files = input.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d0_attachments", files[i]);
                    }
                }
                //D1
                $(".actionTask_D1").each(function (index) {
                    var thisId = $(this).data("id");
                    var member = $(`#D1_TeamMember_${thisId}`).find(":selected");

                    if ($(`#D1_Function_${thisId}`).val() != null) {
                        data.append(`D1s[${index}].RefFunctionId`, $(`#D1_Function_${thisId}`).val());
                    }

                    if (member.val() != "") {
                        data.append(`D1s[${index}].D1_EmployeeId`, member.val());
                        data.append(`D1s[${index}].D1_EmployeeName`, member.data("name"));
                    }
                    if ($(`#D1_DateStartValue_${thisId}`).val() != "") {
                        data.append(`D1s[${index}].D1_DateStart`, $(`#D1_DateStartValue_${thisId}`).val());
                    }
                    if ($(`#D1_PhoneNo_${thisId}`).val() != "") {
                        data.append(`D1s[${index}].D1_PhoneNo`, $(`#D1_PhoneNo_${thisId}`).val());
                    }
                    //console.log($(`#D1_EmailTeamMember_${thisId}`).val());
                    if ($(`#D1_EmailTeamMember_${thisId}`).val() != null) {
                        data.append(`D1s[${index}].D1_Email`, $(`#D1_EmailTeamMember_${thisId}`).find(":selected").data("email"));
                    }

                });

                //D2
                data.append(`D2s[0].D2_DefineCustomerExperience`, $(`#D2_DefineCustomerExperience`).val());
                data.append(`D2s[0].D2_FailureMode`, $(`#D2_FailureMode`).val());
                data.append(`D2s[0].D2_RequiredByTheSpecification`, $(`#D2_RequiredByTheSpecification`).val());
                data.append(`D2s[0].D2_TheSpecificationDocument`, $(`#D2_TheSpecificationDocument`).val());
                data.append(`D2s[0].D2_ProblemSource`, $(`#D2_ProblemSource`).val());
                data.append(`D2s[0].D2_CustomerProblemTypeDefinition`, $(`#D2_CustomerProblemTypeDefinition`).val());
                data.append(`D2s[0].D2_NumberOfPartsProducedWithinProblemBoundary`, $(`#D2_NumberOfPartsProducedWithinProblemBoundary`).val());
                data.append(`D2s[0].D2_NumberOfPartsAffected`, $(`#D2_NumberOfPartsAffected`).val());


                $("input[name='D2_RecurringProblem_1']:checked").each(function (index) {
                    data.append("D2s[0].D2_RecurringProblem", $(this).val());

                });
                $("input[name='D2_FailureModeInDPFMEA_1']:checked").each(function (index) {
                    data.append("D2s[0].D2_FailureModeInDPFMEA", $(this).val());

                });
                var inputD2Recuring = document.getElementById("D2_AttachmentRecurrings");
                if (typeof inputD2Recuring != "undefined" && inputD2Recuring != null) {
                    var files = inputD2Recuring.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d2_attachmentRecurrings", files[i]);
                    }
                }
                var inputD2FMEA = document.getElementById("D2_AttachmentFailures");
                if (typeof inputD2FMEA != "undefined" && inputD2FMEA != null) {
                    var files = inputD2FMEA.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d2_attachmentFailures", files[i]);
                    }
                }

                var chkD2SupSupplier = $("#D2_SupSupplier").is(":checked");
                if (chkD2SupSupplier) {
                    data.append(`D2s[0].D2_SupSupplier`, chkD2SupSupplier);
                    data.append(`D2s[0].D2_SupSupplierDetail`, $("#D2_OrganizationDetail").val());
                }
                else {
                    data.append(`D2s[0].D2_SupSupplier`, false);
                }

                var chkD2Organization = $("#D2_Organization").is(":checked");
                if (chkD2Organization) {
                    data.append(`D2s[0].D2_Organization`, chkD2Organization);
                    data.append(`D2s[0].D2_OrganizationDetail`, $("#D2_OrganizationDetail").val());
                }
                else {
                    data.append(`D2s[0].D2_Organization`, false);
                }

                var chkD2Customer = $("#D2_Customer").is(":checked");
                if (chkD2Customer) {
                    data.append(`D2s[0].D2_Customer`, chkD2Customer);
                    data.append(`D2s[0].D2_CustomerDetail`, $("#D2_CustomerDetail").val());
                }
                else {
                    data.append(`D2s[0].D2_Customer`, false);
                }

                var chkD2Other1 = $("#D2_Other1").is(":checked");
                if (chkD2Other1) {
                    data.append(`D2s[0].D2_Other1`,chkD2Other1);
                    data.append(`D2s[0].D2_Other1Detail`, $("#D2_Other1Detail").val());
                }
                else {
                    data.append(`D2s[0].D2_Other1`, false);
                }

                var chkD2CustomerOfCustomer = $("#D2_CustomerOfCustomer").is(":checked");
                if (chkD2CustomerOfCustomer) {
                    data.append(`D2s[0].D2_CustomerOfCustomer`, chkD2CustomerOfCustomer);
                    data.append(`D2s[0].D2_CustomerOfCustomerDetail`, $("#D2_CustomerOfCustomerDetail").val());}
                else {
                    data.append(`D2s[0].D2_CustomerOfCustomer`, false);
                }

                var chkD2AircraftOperators = $("#D2_AircraftOperators").is(":checked");
                if (chkD2AircraftOperators) {
                    data.append(`D2s[0].D2_AircraftOperators`, chkD2AircraftOperators);
                    data.append(`D2s[0].D2_AircraftOperatorsDetail`, $("#D2_AircraftOperatorsDetail").val());
                } else {
                    data.append(`D2s[0].D2_AircraftOperators`, false);

                }

                var chkD2SpareParts = $("#D2_SpareParts").is(":checked");
                if (chkD2SpareParts) {
                    data.append(`D2s[0].D2_SpareParts`, chkD2SpareParts);
                    data.append(`D2s[0].D2_SparePartsDetail`, $("#D2_SparePartsDetail").val());
                } else {
                    data.append(`D2s[0].D2_SpareParts`, false);

                }

                var chkD2Other2 = $("#D2_Other2").is(":checked");
                if (chkD2Other2) {
                    data.append(`D2s[0].D2_Other2`, chkD2Other2);
                    data.append(`D2s[0].D2_Other2Detail`, $("#D2_Other2Detail").val());
                } else {
                    data.append(`D2s[0].D2_Other2`, false);

                }

                data.append(`D2s[0].D2_ProblemPartEarliestKnownOccurrenceDate`, $("#D2_ProblemPartEarliestKnownOccurrenceDateValue").val());
                data.append(`D2s[0].D2_ProblemPartEarliestKnownAwarenessDate`, $("#D2_ProblemPartEarliestKnownAwarenessDateValue").val());
                data.append(`D2s[0].D2_ProblemPartEarliestKnownShipmentDate`, $("#D2_ProblemPartEarliestKnownShipmentDateValue").val());
                var inputD2attach = document.getElementById("D2_Attachments");
                if (typeof inputD2attach != "undefined" && inputD2attach != null) {
                    var files = inputD2attach.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d2_attachments", files[i]);
                    }
                }

                var inputD2ConformAttachments = document.getElementById("D2_ConformAttachments");
                if (typeof inputD2ConformAttachments != "undefined" && inputD2ConformAttachments != null) {
                    var files = inputD2ConformAttachments.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d2_ConformAttachments", files[i]);
                    }
                }
                var inputD2NonConformAttachments = document.getElementById("D2_NonConformAttachments");
                if (typeof inputD2NonConformAttachments != "undefined" && inputD2NonConformAttachments != null) {
                    var files = inputD2NonConformAttachments.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d2_NonConformAttachments", files[i]);
                    }
                }

                //D3
                var chkD3 = $("#D3_CopyFromD0").is(":checked");
                data.append(`D3s[0].CopyFromD0`, chkD3);
                $(".actionTask_D3").each(function (index) {
                    var thisId = $(this).data("id");
                    var member = $(`#D3_TeamMember_${thisId}`).find(":selected");

                    if ($(`#D3_Action_${thisId}`).val() != "") {
                        data.append(`D3s[0].D3_Actions[${index}].D3_Detail`, $(`#D3_Action_${thisId}`).val());
                    }
                    if (member.val() != "") {
                        data.append(`D3s[0].D3_Actions[${index}].D3_TeamMember`, member.val());
                        data.append(`D3s[0].D3_Actions[${index}].D3_TeamMemberName`, member.data("email"));
                        data.append(`D3s[0].D3_Actions[${index}].D3_TeamMemberEmail`, member.data("name"));
                    }
                    if ($(`#D3_DateStartValue_${thisId}`).val() != "") {
                        data.append(`D3s[0].D3_Actions[${index}].D3_DateStart`, $(`#D3_DateStartValue_${thisId}`).val());
                    }
                    if ($(`#D3_Metric_${thisId}`).val() != "") {
                        data.append(`D3s[0].D3_Actions[${index}].D3_Metric`, $(`#D3_Metric_${thisId}`).val());
                    }
                    if ($(`#D3_Eff_${thisId}`).val() != "") {
                        data.append(`D3s[0].D3_Actions[${index}].D3_Eff`, $(`#D3_Eff_${thisId}`).val());
                    }
                    if ($(`#D3_PartId_${thisId}`).val() != "") {
                        data.append(`D3s[0].D3_Actions[${index}].D3_PartId`, $(`#D3_PartId_${thisId}`).val());
                    }
                    if ($(`#D3_DateStartValue_${thisId}`).val() != "") {
                        data.append(`D3s[0].D3_Actions[${index}].D3_DateFinish`, $(`#D3_DateFinishValue_${thisId}`).val());
                    }


                });
                var inputD3attach = document.getElementById("D3_Attachments");
                if (typeof inputD3attach != "undefined" && inputD3attach != null) {
                    var files = inputD3attach.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d3_attachments", files[i]);
                    }
                }
                //D4
                $(".actionTask_D4").each(function (index) {
                    var thisId = $(this).data("id");
                    var member = $(`#D4_CauseSource_${thisId}`).find(":selected");
                    var chkVerifyD4 = $(`#D4_Verified_${thisId}`).is(":checked");
                    if (member.val() != "") {
                        data.append(`D4s[0].D4_CauseSources[${index}].RefCauseSourceId`, member.val());
                    }
                    if ($(`#D4_CauseSourceDescription_${thisId}`).val() != "") {
                        data.append(`D4s[0].D4_CauseSources[${index}].CauseDescription`, $(`#D4_CauseSourceDescription_${thisId}`).val());
                    }
                    data.append(`D4s[0].D4_CauseSources[${index}].Verified`, chkVerifyD4);


                    if ($(`#D4_DateValue_${thisId}`).val() != "") {
                        data.append(`D4s[0].D4_CauseSources[${index}].Date`, $(`#D4_DateValue_${thisId}`).val());
                    }
                    if ($(`#D4_VerificationMethod_${thisId}`).val() != "") {
                        data.append(`D4s[0].D4_CauseSources[${index}].VerificationMethod`, $(`#D4_VerificationMethod_${thisId}`).val());
                    }
                });
                $("input[name='D4_HasEscapePointCausesBeenaddressed_1']:checked").each(function (index) {
                    data.append("D4s[0].D4_HasEscapePointCausesBeenAddressed", $(this).val());
                });


                $("input[name='D4_CanCausesExplainDifferences_1']:checked").each(function (index) {
                    data.append("D4s[0].D4_CanCausesExplainDifferences", $(this).val());
                });
                $("input[name='D4_IdentifyCausesInProcessFMEA_1']:checked").each(function (index) {
                    data.append("D4s[0].D4_IdentifyCausesInProcessFMEA", $(this).val());
                });
                var chkFishboneD4 = $("#D4_FishboneCheck").is(":checked");
                data.append("D4s[0].D4_FishBone", chkFishboneD4);
                if ($(`#FishBone_Main`).val() != "") {
                    data.append(`D4s[0].FishBone_Main`, $(`#FishBone_Main`).val());
                }
                if ($(`#FishBone_Machine`).val() != "") {
                    data.append(`D4s[0].FishBone_Machine`, $(`#FishBone_Machine`).val());
                }
                if ($(`#FishBone_Manufacturing`).val() != "") {
                    data.append(`D4s[0].FishBone_Manufacturing`, $(`#FishBone_Manufacturing`).val());
                }
                if ($(`#FishBone_Measurement`).val() != "") {
                    data.append(`D4s[0].FishBone_Measurement`, $(`#FishBone_Measurement`).val());
                }
                if ($(`#FishBone_Material`).val() != "") {
                    data.append(`D4s[0].FishBone_Material`, $(`#FishBone_Material`).val());
                }
                if ($(`#FishBone_Environment`).val() != "") {
                    data.append(`D4s[0].FishBone_Environment`, $(`#FishBone_Environment`).val());
                }

                var chkFiveWhyD4 = $("#FiveWhy").is(":checked");
                data.append("D4s[0].D4_FiveWhy", chkFiveWhyD4);
                if ($(`#FiveWhy_DefineTheProblem`).val() != "") {
                    data.append(`D4s[0].DefineTheProblem`, $(`#FiveWhy_DefineTheProblem`).val());
                }
                if ($(`#FiveWhy_Why1`).val() != "") {
                    data.append(`D4s[0].Why1`, $(`#FiveWhy_Why1`).val());
                }
                if ($(`#FiveWhy_How1`).val() != "") {
                    data.append(`D4s[0].How1`, $(`#FiveWhy_How1`).val());
                }
                if ($(`#FiveWhy_Why2`).val() != "") {
                    data.append(`D4s[0].Why2`, $(`#FiveWhy_Why2`).val());
                }
                if ($(`#FiveWhy_How2`).val() != "") {
                    data.append(`D4s[0].How2`, $(`#FiveWhy_How2`).val());
                }
                if ($(`#FiveWhy_Why3`).val() != "") {
                    data.append(`D4s[0].Why3`, $(`#FiveWhy_Why3`).val());
                }
                if ($(`#FiveWhy_How3`).val() != "") {
                    data.append(`D4s[0].How3`, $(`#FiveWhy_How3`).val());
                }
                if ($(`#FiveWhy_Why4`).val() != "") {
                    data.append(`D4s[0].Why4`, $(`#FiveWhy_Why4`).val());
                }
                if ($(`#FiveWhy_How4`).val() != "") {
                    data.append(`D4s[0].How4`, $(`#FiveWhy_How4`).val());
                }
                var inputD4attach = document.getElementById("D4_Attachments");
                if (typeof inputD4attach != "undefined" && inputD4attach != null) {
                    var files = inputD4attach.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d4_attachments", files[i]);
                    }
                }

                //D5
                data.append(`D5s[0].Detail`,"-");
                $(".actionTask_D5").each(function (index) {
                    var thisId = $(this).data("id");
                    var causeSource = $(`#D5_CauseSource_${thisId}`).find(":selected");
                    var chkVerifyD5 = $(`#D5_Verified_${thisId}`).is(":checked");
                    if (causeSource.val() != "") {
                        data.append(`D5s[0].D5_Actions[${index}].RefCauseSourceId`, causeSource.val());
                    }
                    if ($(`#D5_PermanentCorrectAction_${thisId}`).val() != "") {
                        data.append(`D5s[0].D5_Actions[${index}].Detail`, $(`#D5_PermanentCorrectAction_${thisId}`).val());

                    }
                    data.append(`D5s[0].D5_Actions[${index}].Verify`, chkVerifyD5);


                    if ($(`#D5_DateValue_${thisId}`).val() != "") {
                        data.append(`D5s[0].D5_Actions[${index}].Date`, $(`#D5_DateValue_${thisId}`).val());
                    }
                    if ($(`#D5_VerificationMethod_${thisId}`).val() != "") {
                        data.append(`D5s[0].D5_Actions[${index}].VerificationMethod`, $(`#D5_VerificationMethod_${thisId}`).val());
                    }
                });
                var inputD5attach = document.getElementById("D5_Attachments");
                if (typeof inputD5attach != "undefined" && inputD5attach != null) {
                    var files = inputD5attach.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d5_attachments", files[i]);
                    }
                }

                //D6
                data.append(`D6s[0].Detail`,"-");
                $(".actionTask_D6").each(function (index) {
                    var thisId = $(this).data("id");
                    var member = $(`#D6_TeamMember_${thisId}`).find(":selected");
                    if (member.val() != "") {
                        data.append(`D6s[0].D6_Actions[${index}].TeamMemberId`, member.val());
                        data.append(`D6s[0].D6_Actions[${index}].TeamMemberName`, member.data("name"));
                        data.append(`D6s[0].D6_Actions[${index}].TeamMemberEmail`, member.data("email"));
                    }
                    if ($(`#D6_PermenentCorrectiveAction_${thisId}`).val() != "") {
                        data.append(`D6s[0].D6_Actions[${index}].Detail`, $(`#D6_PermenentCorrectiveAction_${thisId}`).val());

                    }
                    if ($(`#D6_ImplementationPlan_${thisId}`).val() != "") {
                        data.append(`D6s[0].D6_Actions[${index}].ImplementationPlan`, $(`#D6_ImplementationPlan_${thisId}`).val());

                    }
                    $(`input[name='D6_CustomerConcurrence_${thisId}']:checked`).each(function (i) {
                        //alert($(this).val());
                        data.append(`D6s[0].D6_Actions[${index}].CustomerConcurrence`, $(this).val());
                    });
                    if ($(`#D6_DateValue_${thisId}`).val() != null) {
                        data.append(`D6s[0].D6_Actions[${index}].ImplementActionDate`, $(`#D6_DateValue_${thisId}`).val());

                    }

                    data.append(`D6s[0].D6_Actions[${index}].RefPCAStatusId`, $(`#D6_PCAStatus_${thisId}`).val());
                });
                var inputD6attach = document.getElementById("D6_Attachments");
                if (typeof inputD6attach != "undefined" && inputD6attach != null) {
                    var files = inputD6attach.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d6_attachments", files[i]);
                    }
                }

                //D7A
                data.append(`D7s[0].Detail`, "-");
                $(".actionTask_D7A").each(function (index) {
                    var thisId = $(this).data("id");
                    var member = $(`#D7A_TeamMember_${thisId}`).find(":selected");
                    if (member.val() != "") {
                        data.append(`D7s[0].D7_As[${index}].TeamMemberId`, member.val());
                        data.append(`D7s[0].D7_As[${index}].TeamMemberName`, member.data("name"));
                        data.append(`D7s[0].D7_As[${index}].TeamMemberEmail`, member.data("email"));
                    }
                    if ($(`#D7A_SelectedPreventiveAction_${thisId}`).val() != "") {
                        data.append(`D7s[0].D7_As[${index}].PreventiveAction`, $(`#D7A_SelectedPreventiveAction_${thisId}`).val());
                    }
                    if ($(`#D7A_ImplementationPlan_${thisId}`).val() != "") {
                        data.append(`D7s[0].D7_As[${index}].PAImplementationPlan`, $(`#D7A_ImplementationPlan_${thisId}`).val());
                    }
                    data.append(`D7s[0].D7_As[${index}].TargetDate`, $(`#D7A_TargetDateValue_${thisId}`).val());
                    data.append(`D7s[0].D7_As[${index}].ActualDate`, $(`#D7A_ActualDate_${thisId}`).val());
                    data.append(`D7s[0].D7_As[${index}].RefPCAStatusId`, $(`#D7A_PCAStatus_${thisId}`).val());

                });
                $(".actionTask_D7B").each(function (index) {
                    var thisId = $(this).data("id");

                    if ($(`#D7B_Responsible_${thisId}`).val() != "") {
                        data.append(`D7s[0].D7_Bs[${index}].Responsible`, $(`#D7B_Responsible_${thisId}`).val());
                    }
                    if ($(`#D7B_ProcessItem_${thisId}`).val() != "") {
                        data.append(`D7s[0].D7_Bs[${index}].Process`, $(`#D7B_ProcessItem_${thisId}`).val());
                    }
                    if ($(`#D7B_PlanValidationDateValue_${thisId}`).val() != null) {
                        data.append(`D7s[0].D7_Bs[${index}].PlanValidationDate`, $(`#D7B_PlanValidationDateValue_${thisId}`).val());
                    }

                });
                var inputD7attach = document.getElementById("D7_Attachments");
                if (typeof inputD7attach != "undefined" && inputD7attach != null) {
                    var files = inputD7attach.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d7_attachments", files[i]);
                    }
                }

                if ($(`#D7C_Description_1`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo1`, $(`#D7C_Description_1`).val());
                }
                if ($(`#D7C_Description_2`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo2`, $(`#D7C_Description_2`).val());
                }
                if ($(`#D7C_Description_3`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo3`, $(`#D7C_Description_3`).val());
                }
                if ($(`#D7C_Description_4`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo4`, $(`#D7C_Description_4`).val());
                }
                if ($(`#D7C_Description_5`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo5`, $(`#D7C_Description_5`).val());
                }
                if ($(`#D7C_Description_6`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo6`, $(`#D7C_Description_6`).val());
                }
                if ($(`#D7C_Description_7`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo7`, $(`#D7C_Description_7`).val());
                }
                if ($(`#D7C_Description_8`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo8`, $(`#D7C_Description_8`).val());
                }
                if ($(`#D7C_Description_9`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo9`, $(`#D7C_Description_9`).val());
                }
                if ($(`#D7C_Description_10`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo10`, $(`#D7C_Description_10`).val());
                }
                if ($(`#D7C_Description_11`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo11`, $(`#D7C_Description_11`).val());
                }
                if ($(`#D7C_Description_12`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo12`, $(`#D7C_Description_12`).val());
                }
                if ($(`#D7C_Description_13`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo13`, $(`#D7C_Description_13`).val());
                }
                if ($(`#D7C_Description_14`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo14`, $(`#D7C_Description_14`).val());
                }
                if ($(`#D7C_Description_15`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].NatureOfRevisionNo15`, $(`#D7C_Description_15`).val());
                }

                if ($(`#D7C_Resp_1`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp1`, $(`#D7C_Resp_1`).val());
                }
                if ($(`#D7C_Resp_2`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp2`, $(`#D7C_Resp_2`).val());
                }
                if ($(`#D7C_Resp_3`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp3`, $(`#D7C_Resp_3`).val());
                }
                if ($(`#D7C_Resp_4`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp4`, $(`#D7C_Resp_4`).val());
                }
                if ($(`#D7C_Resp_5`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp5`, $(`#D7C_Resp_5`).val());
                }
                if ($(`#D7C_Resp_6`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp6`, $(`#D7C_Resp_6`).val());
                }
                if ($(`#D7C_Resp_7`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp7`, $(`#D7C_Resp_7`).val());
                }
                if ($(`#D7C_Resp_8`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp8`, $(`#D7C_Resp_8`).val());
                }
                if ($(`#D7C_Resp_9`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp9`, $(`#D7C_Resp_9`).val());
                }
                if ($(`#D7C_Resp_10`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp10`, $(`#D7C_Resp_10`).val());
                }
                if ($(`#D7C_Resp_11`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp11`, $(`#D7C_Resp_11`).val());
                }
                if ($(`#D7C_Resp_12`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp12`, $(`#D7C_Resp_12`).val());
                }
                if ($(`#D7C_Resp_13`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp13`, $(`#D7C_Resp_13`).val());
                }
                if ($(`#D7C_Resp_14`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp14`, $(`#D7C_Resp_14`).val());
                }
                if ($(`#D7C_Resp_15`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].Resp15`, $(`#D7C_Resp_15`).val());
                }

                if ($(`#D7C_ReviewCompletionDatePlanValue_1`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate1`, $(`#D7C_ReviewCompletionDatePlanValue_1`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_2`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate2`, $(`#D7C_ReviewCompletionDatePlanValue_2`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_3`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate3`, $(`#D7C_ReviewCompletionDatePlanValue_3`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_4`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate4`, $(`#D7C_ReviewCompletionDatePlanValue_4`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_5`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate5`, $(`#D7C_ReviewCompletionDatePlanValue_5`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_6`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate6`, $(`#D7C_ReviewCompletionDatePlanValue_6`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_7`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate7`, $(`#D7C_ReviewCompletionDatePlanValue_7`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_8`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate8`, $(`#D7C_ReviewCompletionDatePlanValue_8`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_9`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate9`, $(`#D7C_ReviewCompletionDatePlanValue_9`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_10`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate10`, $(`#D7C_ReviewCompletionDatePlanValue_10`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_11`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate11`, $(`#D7C_ReviewCompletionDatePlanValue_11`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_12`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate12`, $(`#D7C_ReviewCompletionDatePlanValue_12`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_13`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate13`, $(`#D7C_ReviewCompletionDatePlanValue_13`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_14`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate14`, $(`#D7C_ReviewCompletionDatePlanValue_14`).val());
                }
                if ($(`#D7C_ReviewCompletionDatePlanValue_15`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].PlanDate15`, $(`#D7C_ReviewCompletionDatePlanValue_15`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_1`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate1`, $(`#D7C_ReviewCompletionDateActualValue_1`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_2`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate2`, $(`#D7C_ReviewCompletionDateActualValue_2`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_3`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate3`, $(`#D7C_ReviewCompletionDateActualValue_3`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_4`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate4`, $(`#D7C_ReviewCompletionDateActualValue_4`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_5`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate5`, $(`#D7C_ReviewCompletionDateActualValue_5`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_6`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate6`, $(`#D7C_ReviewCompletionDateActualValue_6`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_7`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate7`, $(`#D7C_ReviewCompletionDateActualValue_7`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_8`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate8`, $(`#D7C_ReviewCompletionDateActualValue_8`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_9`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate9`, $(`#D7C_ReviewCompletionDateActualValue_9`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_10`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate10`, $(`#D7C_ReviewCompletionDateActualValue_10`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_11`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate11`, $(`#D7C_ReviewCompletionDateActualValue_11`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_12`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate12`, $(`#D7C_ReviewCompletionDateActualValue_12`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_13`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate13`, $(`#D7C_ReviewCompletionDateActualValue_13`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_14`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate14`, $(`#D7C_ReviewCompletionDateActualValue_14`).val());
                }
                if ($(`#D7C_ReviewCompletionDateActualValue_15`).val() != "") {
                    data.append(`D7s[0].D7_Cs[0].ActualDate15`, $(`#D7C_ReviewCompletionDateActualValue_15`).val());
                }

                //D8A
                data.append(`D8s[0].Detail`, "-");
                $(".actionTask_D8A").each(function (index) {
                    var thisId = $(this).data("id");

                    if ($(`#D8_PlanDateValue_${thisId}`).val() != "") {
                        data.append(`D8s[0].D8_As[${index}].PlanDate`, $(`#D8_PlanDateValue_${thisId}`).val());
                    }
                    if ($(`#D8_ActualDateValue_${thisId}`).val() != "") {
                        data.append(`D8s[0].D8_As[${index}].ActualDate`, $(`#D8_ActualDateValue_${thisId}`).val());
                    }

                });

                var inputD8attach = document.getElementById("D8_Attachments");
                if (typeof inputD8attach != "undefined" && inputD8attach != null) {
                    var files = inputD8attach.files;
                    for (var i = 0; i != files.length; i++) {
                        data.append("d8_attachments", files[i]);
                    }
                }

                $("#SubmitFormSpinn").removeClass("d-none");
                $("button[name=btnSave]").prop("disabled", true);
                $.ajax({
                            contentType: false,
                            processData: false,
                            type: "POST",
                            url: '@Url.Action("Create", "Home")',
                            data: data,
                            success: function (data) {
                                Toast.fire({
                                    icon: 'success',
                                    title: ' Your work has been saved'
                                });

                                setTimeout(function() {
                                    window.location.href = '@Url.Action("Edit", "Home")/' + data;
                                }, 1000);
                            },
                            error: function (err) {
                                $("#SubmitFormSpinn").addClass("d-none");
                                $("button[name=btnSave]").prop("disabled", false);

                                console.log(err)
                            }
                        });

            });

            $("#D2_SupSupplier").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $("#D2_SupSupplierDetail").removeAttr("disabled");
                } else {
                    $("#D2_SupSupplierDetail").attr("disabled", "disabled");
                }
            });
            $("#D2_Organization").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $("#D2_OrganizationDetail").removeAttr("disabled");
                } else {
                    $("#D2_OrganizationDetail").attr("disabled", "disabled");
                }
            });
            $("#D2_Customer").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $("#D2_CustomerDetail").removeAttr("disabled");
                } else {
                    $("#D2_CustomerDetail").attr("disabled", "disabled");
                }
            });
            $("#D2_Other1").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $("#D2_Other1Detail").removeAttr("disabled");
                } else {
                    $("#D2_Other1Detail").attr("disabled", "disabled");
                }
            });
            $("#D2_CustomerOfCustomer").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $("#D2_CustomerOfCustomerDetail").removeAttr("disabled");
                } else {
                    $("#D2_CustomerOfCustomerDetail").attr("disabled", "disabled");
                }
            });
            $("#D2_AircraftOperators").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $("#D2_AircraftOperatorsDetail").removeAttr("disabled");
                } else {
                    $("#D2_AircraftOperatorsDetail").attr("disabled", "disabled");
                }
            });
            $("#D2_SpareParts").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $("#D2_SparePartsDetail").removeAttr("disabled");
                } else {
                    $("#D2_SparePartsDetail").attr("disabled", "disabled");
                }
            });
            $("#D2_Other2").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $("#D2_Other2Detail").removeAttr("disabled");
                } else {
                    $("#D2_Other2Detail").attr("disabled", "disabled");
                }
            });
            $("#D4_FishboneCheck").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $(".fishbone").removeClass("d-none");

                } else {
                    $(".fishbone").addClass("d-none");
                }
            });
            $("#FiveWhy").change(function () {
                var obj = $(this);
                //alert(obj.is(":checked"));
                if (obj.is(":checked")) {
                    $(".fivewhy").removeClass("d-none");

                } else {
                    $(".fivewhy").addClass("d-none");
                }
            });
            $("#D3_CopyFromD0").change(function () {
                var obj = $(this);
                if (obj.is(":checked")) {
                    $(".actionTask_D3").each(function (index) {
                        const row = index + 1;
                        $(`#actionTask_D3_${row}`).remove();

                    });
                    $(".actionTask").each(function (index) {
                        const row = index + 1;
                        var member2 = $(`#D0_TeamMember_${row}`).find(":selected");
                       // $(`#actionTask_D3_${row}`).remove();
                        var str = `
                     <tr class="actionTask_D3" id="actionTask_D3_${row}" data-id="${row}">
                                        <td class="form-group" style="width:300px;">
                                            <textarea class="form-control form-control-sm" id="D3_Action_${row}" name="D3_Action_${row}" rows="1" required>` + $(`#D0_Action_${row}`).val() + `</textarea>
                                        </td>
                                        <td class="form-group" style="width:300px;">
                                            <select class="form-control form-control-sm select2" id="D3_TeamMember_${row}" name="D3_TeamMember_${row}" style="width: 100%;" data-id="${row}">
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var e in Model.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                 {
                                                    <text>
                        str += `
                                                            <option value='@e.EmpId'
                                                                           data-domainid='@e.EmpDomainId'
                                                                           data-name='@e.EmpFullnameEN'
                                                                           data-email='@e.EmpEmail'
                                                                           data-position='@e.EmpPositionName'
                                                                           data-section='@e.EmpSectionName'
                                                                           data-department='@e.EmpDepartmentName'

                                                               >
                                                                           ` + `@e.EmpFullnameEN` + `
                                                            </option>
                                                            `;

                                                   </text>
                                                   }
                        str += ` </select>

                                                                     </td>

                                                                     <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm inputdate" id="D3_DateStartValue_${row}" name="D3_DateStartValue_${row}" value="` + $(`#D0_DateStartValue_${row}`).val() + `"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D3_Metric_${row}" name="D3_Metric_${row}" value="` + $(`#D0_Metric_${row}`).val() + `" />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D3_Eff_${row}" name="D3_Eff_${row}" value="` + $(`#D0_Eff_${row}`).val() + `" />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="text" class="form-control form-control-sm" id="D3_PartId_${row}" name="D3_PartId_${row}" value="` + $(`#D0_PartId_${row}`).val() + `"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D3_DateFinishValue_${row}" name="D3_DateFinishValue_${row}" value="` + $(`#D0_DateFinishValue_${row}`).val() + `" />
                                                    </td>
                                                    <td class="text-center">`;
                        if (index == 0) {

                            str += `
                            <a href="javascript:void(0)" id="addAction_D3">
                                <i class="fas fa-plus text-success"></i>
                            </a> `;

                        } else {
                            str += `
                            <a href="javascript:void(0)" class="removeAction_D3" data-id="${row}">
                                <i class="fas fa-minus text-danger"></i>
                            </a> `;
                        }
                        str += ` </td>
                                                </tr>
                                            `;

                        $("#actionTaskBody_D3").append(str);

                        $(`.removeAction_D3`).click(function (e) {
                            e.stopImmediatePropagation();

                            $(`#actionTask_D3_${row}`).remove();
                        });
                        $('.select2').select2();
                        $("#addAction_D3").click(function (e) {
                            AddD3(e);
                        });
                    });
                }
                else {
                      $(".actionTask_D3").each(function (index) {
                        const row = index + 1;
                        $(`#actionTask_D3_${row}`).remove();

                      });
                           var str = `
                     <tr class="actionTask_D3" id="actionTask_D3_1" data-id="1">
                                        <td class="form-group" style="width:300px;">
                                            <textarea class="form-control form-control-sm" id="D3_Action_1" name="D3_Action_1" rows="1" required></textarea>
                                        </td>
                                        <td class="form-group" style="width:300px;">
                                            <select class="form-control form-control-sm select2" id="D3_TeamMember_1" name="D3_TeamMember_1" style="width: 100%;" data-id="1">
                                                <option value="" selected disabled>--select--</option> `;
                                                 @foreach (var e in Model.EmpInfos.OrderBy(o => o.EmpFullnameEN))
                                                 {
                                                    <text>
                        str += `
                                                            <option value='@e.EmpId'
                                                                           data-domainid='@e.EmpDomainId'
                                                                           data-name='@e.EmpFullnameEN'
                                                                           data-email='@e.EmpEmail'
                                                                           data-position='@e.EmpPositionName'
                                                                           data-section='@e.EmpSectionName'
                                                                           data-department='@e.EmpDepartmentName'

                                                               >
                                                                           ` + `@e.EmpFullnameEN` + `
                                                            </option>
                                                            `;

                                                   </text>
                                                   }
                        str += ` </select>

                                                                     </td>

                                                                     <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm inputdate" id="D3_DateStartValue_1" name="D3_DateStartValue_1"  />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D3_Metric_1" name="D3_Metric_1" />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="number" class="form-control form-control-sm" id="D3_Eff_1" name="D3_Eff_1" />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="text" class="form-control form-control-sm" id="D3_PartId_1" name="D3_PartId_1" />
                                                    </td>
                                                    <td class="form-group">
                                                        <input type="date" class="form-control form-control-sm" id="D3_DateFinishValue_1" name="D3_DateFinishValue_1" />
                                                    </td>
                                                    <td class="text-center">`;
                        str += `
                            <a href="javascript:void(0)" id="addAction_D3">
                                <i class="fas fa-plus text-success"></i>
                            </a> `;
                        str += `
                                                    </td>
                                                </tr>
                                            `;

                        $("#actionTaskBody_D3").append(str);

                        $(`.removeAction_D3`).click(function (e) {
                            e.stopImmediatePropagation();

                            $(`#actionTask_D3_1`).remove();
                        });
                    $('.select2').select2();
                    $("#addAction_D3").click(function (e) {
                        AddD3(e);
                    });
                }

            });
        });
    </script>

}

